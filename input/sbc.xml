<?xml version="1.0" encoding="utf-8"?>
<?xsl-stylesheet type="text/xsl" href="../transforms/xsl/module/module2html.xsl"?>

<?xml-model href="../transforms/schemas/CCModule.rng" type="application/xml" schematypens="http://relaxng.org/ns/structure/1.0"?>



<Module boilerplate="yes" target-product="Session Border Controller" 
  name="Session Border Controller"
  xmlns="https://niap-ccevs.org/cc/v1"
  xmlns:sec="https://niap-ccevs.org/cc/v1/section"
  xmlns:h="http://www.w3.org/1999/xhtml">
 
  <PPReference>
    <ReferenceTable>
      <PPVersion>1.0</PPVersion>
      <PPAuthor>National Information Assurance Partnership</PPAuthor>
      <PPPubDate>2022-09-09</PPPubDate>
      <Keywords>Session Border Controller</Keywords>
    </ReferenceTable>
  </PPReference>
  <RevisionHistory>
    <entry>
      <version>1.0</version>
      <date>2022-08-12</date>
      <subject>Initial Release</subject>
    </entry>
  </RevisionHistory>
  
  
  <!-- TODO: see Issues for open items -->
  
  <sec:Introduction>
    <sec:Overview>
      The scope of this Protection Profile Module (PP-Module) is to describe the security functionality of a Session Border Controller (SBC) in terms of [CC] and to define functional and assurance requirements for such products. 
      This PP-Module is intended for use with the following Base-PPs:
      <h:ul>
        <h:li>collaborative Protection Profile for
          Network Devices, Version 2.2e (NDcPP)</h:li>
      </h:ul>
      This Base-PP is valid because a device that implements an SBC is a specific type of network device, 
      and there is nothing about the implementation of an SBC that would prevent any of the security capabilities defined by the Base-PP from being satisfied.
      <h:p/>
      Note that the NDcPP defines an optional architecture for a “distributed TOE” that allows for security functionality to be spread across multiple distinct components. 
      This PP-Module does not require or prohibit the TOE from being a distributed system when the TOE conforms to the NDcPP; the TOE may be standalone or distributed in this case.
      
    </sec:Overview>
    <tech-terms>
      <suppress>Functional Package,Extended Package</suppress>
      <term abbr="ACL"  full="Access Control List"/>
      <term abbr="B2BUA"  full="Back-To-Back User Agent"/>
      <term abbr="CDR"  full="Call Detail Record"/>
      <term abbr="DPI"  full="Deep Packet Inspection"/>
      <term abbr="ESC" full="Enterprise Session Controller">
        A voice/video over IP (VVoIP) infrastructure device that is used to set up and tear down calls between VVoIP endpoints.
      </term>
      <term full="H.323">
        A communications protocol defined by ITU-T that is used for creating, modifying, and terminating multimedia sessions with multiple participants.
      </term>
      <term abbr="IETF"  full="Internet Engineering Task Force"/>
      <term abbr="IP-PBX"  full="Internet Protocol Public Branch Exchange"/>
      <term abbr="ITU-T"  full="ITU Telecommunication Standardization Sector"/>
      <term abbr="MGCP" full="Media Gateway Control Protocol">
        A means of communication between a media gateway and a media gateway controller.
      </term>
      <term abbr="NAT"  full="Network Address Translation"/>
      <term abbr="RTCP"  full="RTP Control Protocol"/>
      <term abbr="RTP"  full="Real-Time Transport Protocol"/>
      <term abbr="PSTN"  full="Public Switched Telephone Network"/>
      <term abbr="SDES"  full="Security Descriptions for Media Streams"/>
      <term abbr="SIP" full="Session Initiation Protocol">
        A communications protocol defined by IETF that is used for creating, modifying, and terminating multimedia sessions with multiple participants.
      </term>
      <term abbr="SRTP" full="Secure Real-Time Transport Protocol">
        A protocol that is used to provide multimedia (voice/video) streaming services with added security of encryption, message authentication and integrity, and replay protection.
      </term>
      <term abbr="VVoIP"  full="Voice/Video Over IP"/>
      
      

    </tech-terms>
    <sec:Compliant_Targets_of_Evaluation>
      This PP-Module specifically addresses SBCs that provide firewalling, interoperability, and security functions for VVoIP networks. 
      The SBC also provides protected communication between trusted components of the network infrastructure.
      <h:p/>
      The physical boundary of the SBC is defined by the operating system components storing or providing security functions and 
      all software supplied by the vendor, including vendor modified components to the operating system. 
      All of the security functionality is contained and executed within the physical boundary of the device.
      <h:p/>
      While the functionality that the TOE is obligated to implement in response to the described threat environment is detailed in later sections, 
      a brief description is provided here. A compliant TOE will provide security functionality that addresses threats to itself. 
      It must also protect communications between itself and an Internet Protocol Public Branch Exchange (IP-PBX) 
      or another SBC by using a trusted channel. Some protocols required by this PP-Module make use of certificates; therefore, the SBC must securely store certificates and private keys. 
      <h:p/>
      Since this PP-Module builds on the NDcPP, conformant TOEs must implement the functionality required in the NDcPP along 
      with the additional functionality defined in this PP-Module in response to the threat environment discussed later in this document.
      
    </sec:Compliant_Targets_of_Evaluation>
      <sec:TOE_Boundary>
        An SBC is a security device composed of hardware and software connected to two or more distinct voice networks that provides security and interoperability functions. 
        SBCs are deployed between peering service provider networks, service provider networks and enterprise networks, 
        service provider networks and residential customers, or in some cases as a back-to-back user agent (B2BUA) that allows mobile users the ability to connect to their internal VVoIP network.
        <h:p/>
        The following diagram represents a typical deployment of the TOE and its operational environment (OE). 
        Note that the TOE boundary is limited to the physical boundary of the SBC device itself and the trusted channels/paths that are established by the SBC.
        <h:p/> <comment>[JF] Note figure has known issues (blurry, figure title in actual image, duplicate trusted channel entry in key). Will need to re-make if editable version doesn't exist</comment>
	     <h:p/>
        <figure entity="images/figure1.png" title="SBC Deployment Model" id="OperEnv"/>
        <h:p/>
      </sec:TOE_Boundary>
    
    
    <sec:Use_Cases>
      This PP-Module defines a single potential use case for the SBC TOE:
      <usecases>
        <usecase id="usecase-dedicated" title="Border Protection">
          <description>The TOE is a specialized network device that provides firewall services for VVoIP networks. 
            The TOE is intended to provide protection against well-known threats that target these networks. 
            The SBC examines headers and data values of packets and compares them to an Access Control List (ACL) to either permit or deny them to the SBC or through the SBC. 
            The SBC is typically deployed between service providers for security, interoperability, translation, and transcoding purposes; 
            between service providers and residential customers for security and interoperability purposes; or between service providers and enterprise networks for translation, transcoding, and security purposes. 
            The SBC, as a border element, should also be able to establish a secure communication channel with external devices it communicates with. .</description>
        </usecase>

      </usecases> 
    </sec:Use_Cases> 
  </sec:Introduction>
  <sec:Conformance_Claims boilerplate="no">
    <cclaims>
      <cclaim name="Conformance Statement">
        <description>
	  <h:p>
	    This PP-Module inherits exact conformance as required from the specified
            Base-PP and as defined in the CC and CEM addenda for Exact Conformance, Selection-Based
          SFRs, and Optional SFRs (dated May 2017).</h:p>
	  <h:p>
            No PPs or PP-Modules may be specified in a PP-Configuration with this PP-Module other than the Base-PP specified
	    in <xref to="Overview"/>.
	  </h:p>
        </description>
      </cclaim>
      <cclaim name="CC Conformance Claims">
        <description>This PP-Module is conformant to Parts 2 (extended) and 3 (conformant) of Common
          Criteria Version 3.1, Release 5 [CC]. </description>
      </cclaim>
      <cclaim name="Package Claims">
        <description>This PP-Module does not
          claim conformance to any packages.</description>
      </cclaim>
    </cclaims>
  </sec:Conformance_Claims>
  <sec:Security_Problem_Description>
    The security problem is described in terms of the threats that the TOE is expected to address, assumptions about its Operational Environment, and any organizational security policies that the TOE is expected to enforce.
    <sec:Threats>
      The following threats that are defined in this PP-Module extend the threats that are defined by the Base-PP.
      <threats>
        <threat name="T.MALICIOUS_TRAFFIC">
          <description>An attacker may attempt to send malformed packets to the SBC in order to cause the network stack or services listening on TCP/UDP ports on the SBC or protected network to crash.</description>
          <consistency-rationale>TBD</consistency-rationale>
          <objective-refer ref="O.SYSTEM_MONITORING">
            <rationale>The TOE mitigates the threat of malformed traffic causing a system crash by ensuring that any such instances are logged so that their cause can be diagnosed and prevented in the future.</rationale>
          </objective-refer>
          <objective-refer ref="O.TRAFFIC_FILTERING">
            <rationale>The TOE mitigates the threat of malformed traffic causing a failure of the TOE by providing a mechanism to prevent the TSF from processing it.</rationale>
          </objective-refer>
        </threat>
        
        <threat name="T.NETWORK_ACCESS">
          <description>An attacker may send traffic through the TOE that enables them to access devices in the TOE’s OE without authorization.</description>
          <consistency-rationale>TBD</consistency-rationale>
          <objective-refer ref="O.AUTHORIZED_ADMINISTRATION">
            <rationale>The TOE mitigates the threat of unauthorized network access by giving the administrator the ability to configure traffic filtering rules to block unauthorized traffic.</rationale>
          </objective-refer>
          <objective-refer ref="O.PROTECTED_COMMUNICATIONS">
            <rationale>The TOE mitigates the threat of unauthorized network access by enforcing the use of protected communications channels that prevent impersonation of legitimate subjects.</rationale>
          </objective-refer>
          <objective-refer ref="O.SYSTEM_MONITORING">
            <rationale>The TOE mitigates the threat of unauthorized network access by ensuring that any such instances are logged so that their cause can be diagnosed and prevented in the future.</rationale>
          </objective-refer>
          <objective-refer ref="O.TOPOLOGY_HIDING">
            <rationale>The TOE mitigates the threat of unauthorized network access by hiding its topology so that an attacker on an external network cannot discover or enumerate devices on the TOE’s internal network.</rationale>
          </objective-refer>
          <objective-refer ref="O.TRAFFIC_FILTERING">
            <rationale>The TOE mitigates the threat of unauthorized network access by enforcing traffic filtering rules that prevent devices on the internal network from being accessed.</rationale>
          </objective-refer>
        </threat>
        
        
        <threat name="T.RESOURCE_EXHAUSTION">
          <description>An attacker may transmit network traffic to the TOE that causes it to be unable to perform its functions on legitimate network traffic.</description>
          <consistency-rationale>TBD</consistency-rationale>
          <objective-refer ref="O.AUTHORIZED_ADMINISTRATION">
            <rationale>The TOE mitigates the threat of resource exhaustion by giving administrators the ability to configure traffic rules so that traffic flooding attempts can be discarded.</rationale>
          </objective-refer>
          <objective-refer ref="O.RESOURCE_AVAILABILITY">
            <rationale>The TOE mitigates the threat of the transmission of network traffic that causes the inability of the TOE to perform its functions, by protecting against disruptive traffic.</rationale>
          </objective-refer>
          <objective-refer ref="O.SYSTEM_MONITORING">
            <rationale>The TOE mitigates the threat of unauthorized network access by ensuring that any such instances are logged so that their cause can be diagnosed and prevented in the future.</rationale>
          </objective-refer>
          <objective-refer ref="O.TRAFFIC_FILTERING">
            <rationale>The TOE mitigates the threat of resource exhaustion by providing the ability to filter network traffic that could cause a denial of service.</rationale>
          </objective-refer>
        </threat>
        
        
        <threat name="T.UNTRUSTED_COMMUNICATION_CHANNELS">
          <description>An attacker may acquire sensitive TOE or user data that is transmitted to or from the TOE because an untrusted communication channel causes a disclosure of data in transit.</description>
          <consistency-rationale>TBD</consistency-rationale>
          <objective-refer ref="O.PROTECTED_COMMUNICATIONS">
            <rationale>The TOE mitigates the threat of disclosure of data in transit by enforcing the use of protected communications channels that prevent transmitted data from unauthorized disclosure.</rationale>
          </objective-refer>
        </threat>
        
        
        <threat name="T.USER_DATA_REUSE">
          <description>User data may be inadvertently sent to a destination not intended by the original sender, causing an unauthorized disclosure of the data.</description>
          <consistency-rationale>TBD</consistency-rationale>
          <objective-refer ref="O.USER_DATA_DELIVERY">
            <rationale>The TOE mitigates the threat of inadvertently sending user data to an unintended destination by implementing measures that ensure that data is only sent to the intended recipient.</rationale>
          </objective-refer>
        </threat>
        
      </threats>
    </sec:Threats>
    <sec:Assumptions>
      All assumptions for the OE of the Base-PP also apply to this PP-Module. A.NO_THRU_TRAFFIC_PROTECTION is still operative, but only for the interfaces in the TOE that are defined by the Base-PP and not the PP-Module.
      <assumptions/>
    </sec:Assumptions>
    
    <sec:Organizational_Security_Policies>
      <!-- This PP-Module defines no additional organizational security policies beyond those specified in the NDcPP. -->
      <OSPs/>
    </sec:Organizational_Security_Policies>
  </sec:Security_Problem_Description>
  <sec:Security_Objectives>
    <sec:Security_Objectives_for_the_TOE>

      <SOs>
        
        <SO name="O.AUTHORIZED_ADMINISTRATION">
          <description>All network devices are expected to provide services that allow the security functionality of the device to be managed. 
            The SBC, as a specific type of network device, has a refined set of management functions to address its specialized behavior.
            <h:p/>
            <h:b>Addressed by:</h:b> FMT_SMF.1/SBC
          </description>
          <consistency-rationale>
            TBD
          </consistency-rationale>
          <addressed-by>FMT_SMF.1/SBC</addressed-by>
          <rationale>
            TBD
          </rationale>
        </SO>
        
        
        <SO name="O.PROTECTED_COMMUNICATIONS">
          <description>To mitigate the threat of data-in-transit disclosure, the SBC must ensure that remote communications are secured using appropriate means. 
            This includes the security of VVoIP signaling and media channels and Session Initiation Protocol (SIP) trunking, 
            in addition to any secure communications channels that are prescribed by the Base-PP such as communication with audit or authentication servers.
            <h:p/>
            <h:b>Addressed by:</h:b> FCS_TLSC_EXT.1 (refined from Base-PP), FCS_TLSC_EXT.2 (refined from Base-PP), FCS_TLSS_EXT.1 (refined from Base-PP), 
            FCS_TLSS_EXT.2 (refined from Base-PP), FIA_X509_EXT.1/Rev (refined from Base-PP), FIA_X509_EXT.2 (refined from Base-PP), 
            FIA_X509_EXT.3 (refined from Base-PP), FTP_ITC.1 (refined from Base-PP), FCS_SRTP_EXT.1, FIA_SIPT_EXT.1, FTP_ITC.1/ESC, FTP_ITC.1/VVoIP, FTP_ITC.1/H323 (selection-based)
          </description>
          <consistency-rationale>
            TBD
          </consistency-rationale>
          <addressed-by>FCS_TLSC_EXT.1 (refined from Base-PP)</addressed-by>
          <rationale>
            TBD
          </rationale>
          <addressed-by>FCS_TLSC_EXT.2 (refined from Base-PP)</addressed-by>
          <rationale>
            TBD
          </rationale>
          <addressed-by>FCS_TLSS_EXT.1 (refined from Base-PP)</addressed-by>
          <rationale>
            TBD
          </rationale>
          <addressed-by>FCS_TLSS_EXT.2 (refined from Base-PP)</addressed-by>
          <rationale>
            TBD
          </rationale>
          <addressed-by>FIA_X509_EXT.1/Rev (refined from Base-PP)</addressed-by>
          <rationale>
            TBD
          </rationale>
          <addressed-by>FIA_X509_EXT.2 (refined from Base-PP)</addressed-by>
          <rationale>
            TBD
          </rationale>
          <addressed-by>FIA_X509_EXT.3 (refined from Base-PP)</addressed-by>
          <rationale>
            TBD
          </rationale>
          <addressed-by>FTP_ITC.1 (refined from Base-PP)</addressed-by>
          <rationale>
            TBD
          </rationale>
          <addressed-by>FCS_SRTP_EXT.1</addressed-by>
          <rationale>
            TBD
          </rationale>
          <addressed-by>FIA_SIPT_EXT.1</addressed-by>
          <rationale>
            TBD
          </rationale>
          <addressed-by>FTP_ITC.1/ESC</addressed-by>
          <rationale>
            TBD
          </rationale>
          <addressed-by>FTP_ITC.1/VVoIP</addressed-by>
          <rationale>
            TBD
          </rationale>
          <addressed-by>FTP_ITC.1/H323 (selection-based)</addressed-by>
          <rationale>
            TBD
          </rationale>
        </SO>
        
      
        <SO name="O.RESOURCE_AVAILABILITY">
          <description>The SBC is not capable of performing its primary functionality if an attacker is able to prevent it from handling user data through a denial-of-service attack. 
            Therefore, the SBC is expected to provide security functions that allow it to prioritize its resources and protect against traffic that is designed only to disrupt availability of the device.
            <h:p/>
            <h:b>Addressed by:</h:b> FRU_PRS_EXT.1, FRU_RSA.1
          </description>
          <consistency-rationale>
            TBD
          </consistency-rationale>
          <addressed-by>FRU_PRS_EXT.1</addressed-by>
          <rationale>
            TBD
          </rationale>
          <addressed-by>FRU_RSA.1</addressed-by>
          <rationale>
            TBD
          </rationale>
        </SO>
        
        
        <SO name="O.SYSTEM_MONITORING">
          <description>In order to ensure that potentially malicious activity is detected, the NDcPP requires security-relevant events to be audited. 
            The SBC also provides security functions to support system monitoring, defines additional security-relevant events for specific SBC functions, 
            and requires the use of a Network Time Protocol (NTP) server to provide accurate system time. 
            The SBC is also expected to support real-time system monitoring by providing the ability to automatically generate alerts when certain types of events occur.
            <h:p/>
            <h:b>Addressed by:</h:b> FAU_ARP_EXT.1, FAU_GEN.1/SBC, FAU_SAA.1, FAU_SEL.1
            <h:p/> <comment>[JF] This is saying that NTP is required by that's not currently backed up by SFRs. Should it be? e.g. mandate the NTP selection in Base-PP FPT_STM_EXT.1 and mandate FCS_NTP_EXT.1</comment>
          </description>
          <consistency-rationale>
            TBD
          </consistency-rationale>
          <addressed-by>FAU_ARP_EXT.1</addressed-by>
          <rationale>
            TBD
          </rationale>
          <addressed-by>FAU_GEN.1/SBC</addressed-by>
          <rationale>
            TBD
          </rationale>
          <addressed-by>FAU_SAA.1</addressed-by>
          <rationale>
            TBD
          </rationale>
          <addressed-by>FAU_SEL.1</addressed-by>
          <rationale>
            TBD
          </rationale>
        </SO>
        
        
        <SO name="O.TOPOLOGY_HIDING">
          <description>In order to ensure that there is no unauthorized disclosure of network information, 
            the SBC is expected to hide the topology of the protected network. 
            The SBC ensures no unauthorized disclosure by functioning as a B2BUA and by providing support for network address translation (NAT). 
            These mechanisms ensure that the intended recipient of data being transmitted through the TOE is not revealed and that devices inside the protected network are not directly accessible.
            <h:p/>
            <h:b>Addressed by:</h:b> FDP_IFC.1, FDP_IFF.1, FFW_NAT_EXT.1
          </description>
          <consistency-rationale>
            TBD
          </consistency-rationale>
          <addressed-by>FDP_IFC.1</addressed-by>
          <rationale>
            TBD
          </rationale>
          <addressed-by>FDP_IFF.1</addressed-by>
          <rationale>
            TBD
          </rationale>
          <addressed-by>FFW_NAT_EXT.1</addressed-by>
          <rationale>
            TBD
          </rationale>
        </SO>
        
        
        <SO name="O.TRAFFIC_FILTERING">
          <description>In order to ensure that malicious traffic cannot compromise the SBC or devices on its protected network, 
            the SBC is expected to provide rudimentary traffic filtering capabilities. 
            This ensures that unauthorized TCP/UDP traffic is blocked and that all signaling and media traffic is first checked to be well-formed prior to performing any action on it.
            <h:p/>
            <h:b>Addressed by:</h:b> FFW_ACL_EXT.1, FFW_ACL_EXT.2, FFW_DPI_EXT.1
          </description>
          <consistency-rationale>
            TBD
          </consistency-rationale>
          <addressed-by>FFW_ACL_EXT.1</addressed-by>
          <rationale>
            TBD
          </rationale>
          <addressed-by>FFW_ACL_EXT.2</addressed-by>
          <rationale>
            TBD
          </rationale>
          <addressed-by>FFW_DPI_EXT.1</addressed-by>
          <rationale>
            TBD
          </rationale>
        </SO>
        
        
        <SO name="O.USER_DATA_DELIVERY">
          <description>When user data is transmitted between calling parties, the calling parties expect that this data is only transmitted to the intended recipients. 
            The SBC is expected to provide this assurance through correctly functioning as a B2BUA and through correct implementation of SIP.
            <h:p/>
            <h:b>Addressed by:</h:b> FDP_IFC.1, FDP_IFF.1, FFW_NAT_EXT.1, FIA_SIPT_EXT.1, FIA_SIPS_EXT.1 (optional)
          </description>
          <consistency-rationale>
            TBD
          </consistency-rationale>
          <addressed-by>FDP_IFC.1</addressed-by>
          <rationale>
            TBD
          </rationale>
          <addressed-by>FDP_IFF.1</addressed-by>
          <rationale>
            TBD
          </rationale>
          <addressed-by>FFW_NAT_EXT.1</addressed-by>
          <rationale>
            TBD
          </rationale>
          <addressed-by>FIA_SIPT_EXT.1</addressed-by>
          <rationale>
            TBD
          </rationale>
          <addressed-by>FIA_SIPS_EXT.1 (optional)</addressed-by>
          <rationale>
            TBD
          </rationale>
        </SO>
        
        
      </SOs>
      </sec:Security_Objectives_for_the_TOE>
      
    <sec:Security_Objectives_for_the_Operational_Environment>
      All objectives for the OE of the Base-PP also apply to this PP-Module. OE.NO_THRU_TRAFFIC_PROTECTION is still operative, but only for the interfaces in the TOE that are defined by the Base-PP and not the PP-Module.
    </sec:Security_Objectives_for_the_Operational_Environment>
    <sec:Security_Objectives_Rationale>
      <!-- NOTE: This section should remain empty and is populated from the rationale tags in the previous sections.  -->
    </sec:Security_Objectives_Rationale>
  </sec:Security_Objectives>
  <sec:Security_Requirements>
    <base-pp id="ND" version="2.2e" name="Network Device" product="Network Device" short="ND" plural="Network Devices">
      <url><![CDATA[https://www.niap-ccevs.org/profile/Info.cfm?PPID=447&id=447]]></url>
  	  <cPP/>
      <modified-sfrs>
        <!-- per open comment, it's unclear whether we need to treat any other NDcPP SFRs as 'modified' (most notably FIA_X509_EXT.1/Rev and FTP_ITC.1, or are those completely separate from what is needed for auth server) -->

        <sec:from_nd_fia title="Cryptographic Support (FCS)">
          <f-component cc-id="fcs_tlsc_ext.1" name="TLS Client Protocol without Mutual Authentication"> 
            <consistency-rationale>TBD</consistency-rationale>
            <f-element>
              <title>
                This SFR is selection-based in the NDcPP but is mandated by this PP-Module because Transport Layer Security (TLS) is used for SIP trunking. An SBC implements TLS as both a client and a server.
              </title>
              <aactivity>
                <TSS>TBD
                <h:p/></TSS>
                <Guidance>TBD
                  <h:p/></Guidance>
                <Tests>
                  TBD
                </Tests>
              </aactivity>
            </f-element>
          </f-component>
      
            <f-component cc-id="fcs_tlsc_ext.2" name="TLS Client Support for Mutual Authentication"> 
              <consistency-rationale>TBD</consistency-rationale>
              <f-element>
                <title>
                  This SFR is optional in the NDcPP but is mandated by this PP-Module because SIP trunking requires mutually-authenticated TLS.
                </title>
                <aactivity>
                  <TSS>TBD
                    <h:p/></TSS>
                  <Guidance>TBD
                    <h:p/></Guidance>
                  <Tests>
                    TBD
                  </Tests>
                </aactivity>
              </f-element>
            </f-component>
      
          <f-component cc-id="fcs_tlss_ext.1" name="TLS Server Protocol without Mutual Authentication"> 
            <consistency-rationale>TBD</consistency-rationale>
            <f-element>
              <title>
                This SFR is selection-based in the NDcPP but is mandated by this PP-Module because TLS is used for SIP trunking. An SBC implements TLS as both a client and a server.
              </title>
              <aactivity>
                <TSS>TBD
                  <h:p/></TSS>
                <Guidance>TBD
                  <h:p/></Guidance>
                <Tests>
                  TBD
                </Tests>
              </aactivity>
            </f-element>
          </f-component>
          
          <f-component cc-id="fcs_tlss_ext.2" name="TLS Server Support for Mutual Authentication"> 
            <consistency-rationale>TBD</consistency-rationale>
            <f-element>
              <title>
                This SFR is optional in the NDcPP but is mandated by this PP-Module because SIP trunking requires mutually-authenticated TLS.
              </title>
              <aactivity>
                <TSS>TBD
                  <h:p/></TSS>
                <Guidance>TBD
                  <h:p/></Guidance>
                <Tests>
                  TBD
                </Tests>
              </aactivity>
            </f-element>
          </f-component>
      
        </sec:from_nd_fia>

        <sec:from_nd_fia title="Identification and Authentication (FIA)">
          <f-component cc-id="fia_x509_ext.1" iteration="Rev" name="X.509 Certificate Validation"> 
            <consistency-rationale>TBD</consistency-rationale>
            <f-element>
              <title>
                This SFR is selection-based in the Base-PP but mandatory in this PP-Module because the TOE’s TLS implementation requires appropriate X.509 functionality.
              </title>
              <aactivity>
                <TSS>TBD
                  <h:p/></TSS>
                <Guidance>TBD
                  <h:p/></Guidance>
                <Tests>
                  TBD
                </Tests>
              </aactivity>
            </f-element>
          </f-component>
          
          <f-component cc-id="fia_x509_ext.2" name="X.509 Certificate Authentication"> 
            <consistency-rationale>TBD</consistency-rationale>
            <f-element>
              <title>
                This SFR is selection-based in the Base-PP but mandatory in this PP-Module because the TOE’s TLS implementation requires appropriate X.509 functionality.
              </title>
              <aactivity>
                <TSS>TBD
                  <h:p/></TSS>
                <Guidance>TBD
                  <h:p/></Guidance>
                <Tests>
                  TBD
                </Tests>
              </aactivity>
            </f-element>
          </f-component>
          
          
          <f-component cc-id="fia_x509_ext.3" name="X.509 Certificate Requests"> 
            <consistency-rationale>TBD</consistency-rationale>
            <f-element>
              <title>
                This SFR is selection-based in the Base-PP but mandatory in this PP-Module because the TOE’s TLS implementation requires appropriate X.509 functionality.
              </title>
              <aactivity>
                <TSS>TBD
                  <h:p/></TSS>
                <Guidance>TBD
                  <h:p/></Guidance>
                <Tests>
                  TBD
                </Tests>
              </aactivity>
            </f-element>
          </f-component>
          
        </sec:from_nd_fia>
        <sec:from_nd_ftp>
          <f-component cc-id="ftp_itc.1" name="Inter-TSF Trusted Channel"> 
            <consistency-rationale>TBD</consistency-rationale>
            <f-element>
              <title>
                The TSF shall be capable of using <h:b>TLS and</h:b> 
                <selectables>
                  <selectable>IPsec</selectable>
                  <selectable>SSH</selectable>
                  <selectable>DTLS</selectable>
                  <selectable>HTTPS</selectable>
                  <selectable><h:b>SNMPv3</h:b></selectable>
                  <selectable><h:b>no other protocol</h:b></selectable></selectables>
                to provide a trusted communication channel between itself and authorized IT entities supporting the following capabilities: audit server, 
                <selectables>
                  <selectable>authentication server</selectable>
                  <selectable><assignable>other capabilities</assignable></selectable>
                </selectables> that is logically distinct from other communication channels and provides assured identification of its end points and protection of the channel data from disclosure and detection of modification of the channel data.
              </title>
            </f-element>
            <f-element>
              <title>
                The TSF shall permit the TSF or the authorized IT entities to initiate communication via the trusted channel.
              </title>
            </f-element>
            <f-element>
              <title>
                The TSF shall initiate communication via the trusted channel for <assignable>list of services for which the TSF is able to initiate communications</assignable>.
              </title>
            <note role="application">
              TLS is mandated for SIP trunking as required by FIA_SIPT_EXT.1. SNMPv3 added as a selection to support FAU_ARP_EXT.1.
            </note>
              <aactivity>
                <TSS>TBD
                  <h:p/></TSS>
                <Guidance>TBD
                  <h:p/></Guidance>
                <Tests>
                  TBD
                </Tests>
              </aactivity>
            </f-element>
          </f-component>
        </sec:from_nd_ftp>
        

      </modified-sfrs>
      <additional-sfrs/>
      <con-toe> 
        When this PP-Module is used to extend the NDcPP, the TOE type for the overall TOE is still a network device.
        The TOE boundary is simply extended to include authentication server functionality that is provided by the network device. </con-toe>
      <con-sec-prob/>
      <con-obj/>
      <con-op-en/>

      

    </base-pp>
    <man-sfrs>
      
      <sec:man_fau title="Security Audit (FAU)">
        <ext-comp-def title="Security Audit Automatic Response" fam-id="FAU_ARP_EXT">
          <fam-behavior>TBD</fam-behavior> 
        </ext-comp-def>
        <f-component cc-id="fau_arp_ext.1" name="Inter-TSF Trusted Channel"> 
          <consistency-rationale>TBD</consistency-rationale>
          
          <comp-lev>TBD
          </comp-lev>
          <management>TBD
          </management>
          <audit>TBD
          </audit>
          <dependencies>TBD
          </dependencies>
          
          <f-element>
            <title>
              The TSF shall be capable of using 
              <selectables>
                <selectable>TLS</selectable>
                <selectable>IPsec</selectable>
                <selectable>SSH</selectable>
                <selectable>HTTPS</selectable>
                <selectable>SNMPv3</selectable>
              </selectables> to transmit potential security violations to an external IT entity in the OE upon detection.
            </title>
            <note role="application">
              The selected protocols must be reflected in FTP_ITC.1.
            </note>
            <aactivity>
              <TSS>TBD
                <h:p/></TSS>
              <Guidance>TBD
                <h:p/></Guidance>
              <Tests>
                TBD
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        
        <f-component cc-id="fau_gen.1" name="Audit Data Generation (Session Border Controller)" iteration="SBC">
          <consistency-rationale>TBD</consistency-rationale>
<f-element>
            <title> The TSF shall be able to generate an audit record of the following auditable
              events: <h:ol type="a">
                <h:li>Start-up and shutdown of the audit functions;</h:li>
                <h:li>All auditable events for the [<h:i>not specified</h:i>] level of audit;</h:li>
                <h:li><h:b>All adminsitrative actions;</h:b></h:li>
                <h:li><h:b>[<h:i>Specifically defined auditable events listed in the Auditable Events table (<xref to="auditSBC"/>)</h:i></h:b></h:li>
              </h:ol>
            <h:table>
              <h:tr>
                <h:th>Requirement</h:th>
                <h:th>Auditable Events</h:th>
                <h:th>Additional Audit Record Contents</h:th>
              </h:tr>
              <h:tr>
                <h:td>FAU_ARP_EXT.1</h:td>
                <h:td colspan="2">None</h:td>
              </h:tr>
              <h:tr>
                <h:td>FAU_SAA.1</h:td>
                <h:td colspan="2">None</h:td>
              </h:tr>
              <h:tr>
                <h:td>FAU_SEL.1</h:td>
                <h:td colspan="2">None</h:td>
              </h:tr>
              <h:tr>
                <h:td>FCS_SRTP_EXT.1</h:td>
                <h:td colspan="2">None</h:td>
              </h:tr>
              <h:tr>
                <h:td>FDP_IFC.1</h:td>
                <h:td colspan="2">None</h:td>
              </h:tr>
              <h:tr>
                <h:td>FDP_IFF.1</h:td>
                <h:td>Any modifications to the B2BUA policy</h:td>
                <h:td>None</h:td>
              </h:tr>
              <h:tr>
                <h:td>FFW_ACL_EXT.1</h:td>
                <h:td>Configuraiton of VVoIP traffic filtering rules</h:td>
                <h:td>Information uniquely identifying the rules that were modified</h:td>
              </h:tr>
              <h:tr>
                <h:td rowspan="3">FFW_ACL_EXT.2</h:td>
                <h:td rowspan="3">Application of traffic filtering rules</h:td>
                <h:td>Source and destination of observed traffic</h:td>
              </h:tr>
              <h:tr>
                <h:td>Rule relevant to observed traffic</h:td>
              </h:tr>
              <h:tr>
                <h:td>Result of rule evaluation</h:td>
              </h:tr>
              <h:tr>
                <h:td rowspan="3">FFW_DPI_EXT.1</h:td>
                <h:td rowspan="3">Application of deep packet inspection (DPI) rules</h:td>
                <h:td>Source and destination of observed traffic</h:td>
              </h:tr>
              <h:tr>
                <h:td>Rule relevant to observed traffic</h:td>
              </h:tr>
              <h:tr>
                <h:td>Result of rule evaluation</h:td>
              </h:tr>
              <h:tr>
                <h:td>FFW_NAT_EXT.1</h:td>
                <h:td colspan="2">None</h:td>
              </h:tr>
              <h:tr>
                <h:td rowspan="5">FIA_SIPS_EXT.1</h:td>
                <h:td rowspan="5">Call Detail Record (CDR)</h:td>
                <h:td>Calling party</h:td>
              </h:tr>
              <h:tr>
                <h:td>Called party</h:td>
              </h:tr>
              <h:tr>
                <h:td>Start time of the call</h:td>
              </h:tr>
              <h:tr>
                <h:td>Call duration</h:td>
              </h:tr>
              <h:tr>
                <h:td>Call type</h:td>
              </h:tr>
              <h:tr>
                <h:td>FIA_SIPT_EXT.1</h:td>
                <h:td>All SIP trunk authentication attempts</h:td>
                <h:td>Username and IP address of the servie provider</h:td>
              </h:tr>
              <h:tr>
                <h:td>FMT_SMF.1/SBC</h:td>
                <h:td>All management actions</h:td>
                <h:td>Identifier of initiator</h:td>
              </h:tr>
              <h:tr>
                <h:td>FRU_PRS_EXT.1</h:td>
                <h:td colspan="2">None</h:td>
              </h:tr>
              <h:tr>
                <h:td>FRU_RSA.1</h:td>
                <h:td colspan="2">None</h:td>
              </h:tr>
              <h:tr>
                <h:td rowspan="3">FTP_ITC.1/ESC</h:td>
                <h:td>Initiation of the trusted channel</h:td>
                <h:td rowspan="3">Identification of the initiator and target of the trusted channel</h:td>
              </h:tr>
              <h:tr>
                <h:td>Termination of the trusted channel</h:td>
              </h:tr>
              <h:tr>
                <h:td>Failure of the trusted channel functions</h:td>
              </h:tr>
              <h:tr>
                <h:td rowspan="3">FTP_ITC.1/H323 (selection-based)</h:td>
                <h:td>Initiation of the trusted channel</h:td>
                <h:td rowspan="3">Identification of the initiator and target of the trusted channel</h:td>
              </h:tr>
              <h:tr>
                <h:td>Termination of the trusted channel</h:td>
              </h:tr>
              <h:tr>
                <h:td>Failure of the trusted channel functions</h:td>
              </h:tr>
              <h:tr>
                <h:td rowspan="3">FTP_ITC.1/VVoIP</h:td>
                <h:td>Initiation of the trusted channel</h:td>
                <h:td rowspan="3">Identification of the initiator and target of the trusted channel</h:td>
              </h:tr>
              <h:tr>
                <h:td>Termination of the trusted channel</h:td>
              </h:tr>
              <h:tr>
                <h:td>Failure of the trusted channel functions</h:td>
              </h:tr>
         
            </h:table>
              <ctr ctr-type="Table" id="SBC">: Auditable Events</ctr>
            </title>
	    <note role="application">
	        The auditable events defined in the Auditable Events table are for the SFRs that are explicitly defined in this PP-Module. 
	        For any SFRs that are included as part of the TOE based on the claimed Base-PP, it is expected that any applicable auditable events defined for those SFRs in the Base-PP are also claimed as part of the TSF.
	        <h:p/>
	        The Base-PP iteration of the SFR also requires “all administrative actions” to be audited. When the TOE includes this PP-Module, 
	        it is expected that this will also include the administrative actions that support the PP-Module defined in FMT_SMF.1/SBC.
	        <h:p/>
	        For SFRs labeled as optional or selection-based, the auditable event is required only if the corresponding SFR is claimed.
	        <h:p/>
	        A CDR is expected to be generated at the start of a session, at the end of a session, and during a session at an interval or time period specified by the ST author.
	    </note>
</f-element>
  <f-element>
    <title>
      The TSF shall record within each audit record at least the following information: <h:ol type="a">
        <h:li>Date and time of the event, type of event, subject identity, and the outcome (success or failure) of the event; and</h:li>
        <h:li>For each audit event type, based on the auditable event definitions of the functional components included in the 
          PP<h:b>-Module</h:b>/ST, [<h:i>information specified in column three of the Auditable Events table (<xref to="auditSBC"/>)</h:i>].</h:li>
      </h:ol>
    </title>
  <aactivity>
    <TSS>TBD
      <h:p/></TSS>
    <Guidance>TBD
      <h:p/></Guidance>
    <Tests>
      TBD
    </Tests>
  </aactivity>
</f-element> 
        </f-component>
        
        
        <f-component cc-id="fau_saa.1" name="Potential Violation Analysis"> 
          <consistency-rationale>TBD</consistency-rationale>
          
          <f-element>
            <title>
              The TSF shall be able to apply a set of rules in monitoring the audited events and based upon these rules indicate a potential violation of the enforcement of the SFRs.
            </title>
          </f-element>
          <f-element>
            <title>
              The TSF shall enforce the following rules for monitoring audited events: <h:ol type="a">
                <h:li>Accumulation or combination of <assignable>subset of defined auditable events</assignable> known to indicate a potential security violation; </h:li>
                <h:li><assignable>any other rules</assignable></h:li>
              </h:ol>
            </title>
          
          <note role="application">
            Examples of monitored audited events include authentication failures, self-test failures, or environmental failures (e.g. temperature violation).
            </note>
            <aactivity>
              <TSS>TBD
                <h:p/></TSS>
              <Guidance>TBD
                <h:p/></Guidance>
              <Tests>
                TBD
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        
        <f-component cc-id="fau_sel.1" name="Selective Audit"> 
          <consistency-rationale>TBD</consistency-rationale>
          
          <f-element>
            <title>
              The TSF shall be able to select the set of events to be audited from the set of all auditable events based on the following attributes: <h:ol type="a">
              <h:li>[<h:i>event type</h:i></h:li>
              <h:li><assignable>list of additional attributes that audit selectivity is based upon</assignable></h:li>
              </h:ol>
            </title>
         
            <note role="application">
              The auditable events associated with traffic filtering rules (see the FFW_ACL_EXT.2 and FFW_DPI_EXT.1 rows in the Auditable Events table above) 
              may generate a significant volume of traffic that make them impractical to generate on a persistent basis. 
              The TOE must have the ability to generate these records when necessary but this SFR exists to allow for the generation of those events to be suppressed when the TOE is in its evaluated configuration.
            </note>
            <aactivity>
              <TSS>TBD
                <h:p/></TSS>
              <Guidance>TBD
                <h:p/></Guidance>
              <Tests>
                TBD
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
      </sec:man_fau>
     
     
      <sec:man_fcs title="Cryptographic Support (FCS)">
        
        <ext-comp-def title="Secure Real-Time Transport Protocol" fam-id="FCS_SRTP_EXT">
          <fam-behavior>TBD</fam-behavior> 
        </ext-comp-def>
        <f-component cc-id="fcs_srtp_ext.1" name="Secure Real-Time Transport Protocol"> 
          <consistency-rationale>TBD</consistency-rationale>
          
          <comp-lev>TBD
          </comp-lev>
          <management>TBD
          </management>
          <audit>TBD
          </audit>
          <dependencies>TBD
          </dependencies>
          
          <f-element>
            <title>
              The TSF shall implement the Secure Real-Time Transport Protocol (SRTP) that complies with RFC 3711, 
              and use Security Descriptions for Media Streams (SDES) in compliance with RFC 4568 to provide key information for the SRTP connection. 
            </title>
          </f-element>
          <f-element>
            <title>The TSF shall implement SDES-SRTP supporting the following cipher suites: <selectables linebreak="yes">
              <selectable>AES_CM_128_HMAC_SHA1_80, in accordance with RFC 4568</selectable>
              <selectable>AES_CM_128_HMAC_SHA1_32, in accordance with RFC 4568</selectable>
              <selectable>AES_256_CM_HMAC_SHA1_80, in accordance with RFC 6188</selectable>
              <selectable>AES_256_CM_HMAC_SHA1_32, in accordance with RFC 6188</selectable>
              <selectable>AEAD_AES_128_GCM, in accordance with RFC 7714</selectable>
              <selectable>AEAD_AES_256_GCM, in accordance with RFC 7714</selectable>
            </selectables>
            </title>
          
          <note role="application">
            This requirement specifies that the SRTP session that will be used to carry the VoIP traffic will be keyed according to an SDES dialog using one of the identified cipher suites. 
            The ST author should select all cipher suites that are supported.
            </note>
          </f-element>
          <f-element>
            <title>
              The TSF shall ensure the SRTP NULL algorithm <selectables>
                <selectable>is disabled</selectable>
                <selectable>can be disabled by a [<h:i>Security Administrator</h:i>]</selectable></selectables>.
            </title>
          </f-element>
          <f-element>
            <title>
              The TSF shall allow the SRTP ports to be used for SRTP communications to be specified by a [<h:i>Security Administrator</h:i>].
            </title>
          <aactivity>
              <TSS>TBD
                <h:p/></TSS>
              <Guidance>TBD
                <h:p/></Guidance>
              <Tests>
                TBD
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
     
      </sec:man_fcs>
      <sec:man_fdp title="User Data Protection (FDP)">
        
        <f-component cc-id="fdp_ifc.1" name="Subset Information Flow Control"> 
          <consistency-rationale>TBD</consistency-rationale>
          
          <f-element>
            <title>
              The TSF shall enforce the [<h:i>B2BUA policy</h:i>] on [<h:i>caller-callee pairs attempting to communicate through the TOE</h:i>].
            </title>

            <aactivity>
              <TSS>TBD
                <h:p/></TSS>
              <Guidance>TBD
                <h:p/></Guidance>
              <Tests>
                TBD
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        <f-component cc-id="fdp_iff.1" name="Simple Security Attributes"> 
          <consistency-rationale>TBD</consistency-rationale>
          
          <f-element>
            <title>
              The TSF shall enforce the [<h:i>B2BUA policy</h:i>] based on the following types of subject and information security attributes: 
              <assignable>method by which the TSF identifies each endpoint for a call</assignable>. 
            </title>
          </f-element>
          <f-element>
            <title>
              The TSF shall permit an information flow between a controlled subject and controlled information via a controlled operation if the following rules hold: 
              [<h:i>when valid communication through the TOE is attempted, the TSF will establish a connection between itself and the caller; 
               the TSF will establish a second connection between itself and the callee; and the TSF will redirect all communications that it receives between the two endpoints out through the proper connection</h:i>]. 
            </title>
          </f-element>
          <f-element>
            <title>
              The TSF shall enforce the [<h:i>following configurable behavioral rules: 
              <selectables linebreak="yes"> 
                <selectable>Default-deny (allowlist) posture: If configured, the TSF will implicitly deny all information flows except for those explicitly authorized by the TSF</selectable> 
                <selectable>Default-allow (denylist) posture: If configured, the TSF will implicitly allow all information flows except for those explicitly denied by the TSF</selectable></selectables></h:i>]. 
            </title>
          </f-element>
          <f-element>
            <title>
              The TSF shall explicitly authorize an information flow based on the following rules: 
              [<h:i>if the TSF is operating in an allowlist posture, any calling parties that are present on the allowlist 
              (identifiable by calling number, source IP address, or communications protocols) are explicitly authorized</h:i>]. 
            </title>
          </f-element>
          <f-element>
            <title>
              The TSF shall explicitly deny an information flow based on the following rules: 
              [<h:i>if the TSF is operating in a denylist posture, 
                any calling parties that are present on the denylist (identifiable by calling number or source IP address, or communications protocols) are explicitly denied</h:i>].
            </title>
            <aactivity>
              <TSS>TBD
                <h:p/></TSS>
              <Guidance>TBD
                <h:p/></Guidance>
              <Tests>
                TBD
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
      </sec:man_fdp>
      <sec:man_ffw title="Firewall">
        
        <ext-comp-def title="Network Access Control" fam-id="FFW_ACL_EXT">
          <fam-behavior>TBD</fam-behavior> 
        </ext-comp-def>
        <f-component cc-id="ffw_acl_ext.1" name="Real-Time Communications Traffic Filtering"> 
          <consistency-rationale>TBD</consistency-rationale>
          
          <comp-lev>TBD
          </comp-lev>
          <management>TBD
          </management>
          <audit>TBD
          </audit>
          <dependencies>TBD
          </dependencies>
          
          <f-element>
            <title>
              The TSF shall perform traffic filtering on network packets processed by the TOE. 
            </title>
          </f-element>
          <f-element>
            <title>
              The TSF shall allow the definition of traffic filtering for real-time communications traffic using the following network protocol fields: 
              <h:ul>
                <h:li>IPv4 <h:ul>
                  <h:li>source address</h:li>
                  <h:li>destination address</h:li>
                  <h:li>transport layer protocol</h:li>
                </h:ul></h:li>
                
                <h:li>IPv6<h:ul>
                  <h:li>source address</h:li>
                  <h:li>destination address</h:li>
                  <h:li>transport layer protocol</h:li>
                </h:ul></h:li>
                
                <h:li>TCP <h:b>(for signaling channel)</h:b><h:ul>
                  <h:li>source port</h:li>
                  <h:li>destination port</h:li>
                </h:ul>
                </h:li>
                
                <h:li>UDP <h:b>(for signaling channel)</h:b><h:ul>
                  <h:li>source port</h:li>
                  <h:li>destination port</h:li>
                </h:ul>
                </h:li>
                
                <h:li>Distinct Interface <h:b>(physical vs virtual or trust zone, e.g., trusted vs untrusted)</h:b></h:li>
                
                <h:li><h:i>Application (Real-Time Communications Protocol) <h:ul>
                  <h:li>signaling protocols: <selectables><selectable>SIP</selectable><selectable id="filters_H323">H.323</selectable></selectables></h:li>
                </h:ul></h:i></h:li>
              </h:ul>
            </title>
          
          
            <note role="application">
              Real-time communications traffic can use multiple transport protocols and ports. 
              Therefore, traffic filtering rules should be defined using the network protocol fields above, and one type of traffic may require multiple rules to be applied.
              <h:p/>
              If “H.323” is selected in this requirement, the ST must include the selection-based SFR FTP_ITC.1/H323.
            </note>
          </f-element>
          <f-element>
            <title>
              The TSF shall allow the following operations to be associated with traffic filtering rules: permit or drop with the capability to log the operation <h:b>for each specific rule defined</h:b>.
            </title>
            <note role="application">
              Whether or not logging is performed may be applied to individual rules or groups of rules on an independent basis. 
              For example, if there are six rules defined, the TOE should allow for any subset of these rules to be logged, independent of one another.  
            </note>
          </f-element>
          <f-element>
            <title>
              The TSF shall allow the traffic filtering rules to be assigned to each distinct network interface.
            </title>
          </f-element>
          <f-element>
            <title>
              The TSF shall: <h:ul>
              <h:li>Accept a network packet without further processing of traffic filtering rules if it matches an allowed established session for the following protocols: TCP, UDP, based on the following network packet attributes: <h:ul> 
                <h:li>TCP: source and destination addresses, source and destination ports, sequence number, flags;</h:li> 
                <h:li>UDP: source and destination addresses, source and destination ports; </h:li>
              </h:ul>
              </h:li>
              <h:li>Remove existing traffic flows from the set of established traffic flows based on the following: <selectables>
                <selectable>session inactivity timeout</selectable>
                <selectable>completion of the expected information flow</selectable>
              </selectables>.</h:li>
              </h:ul>
            </title>
          </f-element>
          <f-element>
            <title>
              The TSF shall process the applicable traffic filtering rules in an administratively defined order.
            </title>
          </f-element>
          <f-element>
            <title>
              The TSF shall deny packet flow if a matching rule is not identified.
            </title>
          
            <aactivity>
              <TSS>TBD
                <h:p/></TSS>
              <Guidance>TBD
                <h:p/></Guidance>
              <Tests>
                TBD
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        
        
        <f-component cc-id="ffw_acl_ext.2" name="Stateful VVoIP Traffic Filtering"> 
          <consistency-rationale>TBD</consistency-rationale>
          
          <comp-lev>TBD
          </comp-lev>
          <management>TBD
          </management>
          <audit>TBD
          </audit>
          <dependencies>TBD
          </dependencies>
          
          <f-element>
            <title>
              The TSF shall perform stateful traffic filtering on the following VVoIP protocols: <selectables>
                <selectable>SIP</selectable>
                <selectable>H.323 (H.225, H.245)</selectable>
                <selectable>MGCP</selectable></selectables>.
            </title>
            <note role="application">
              If “H.323” is selected in this requirement, the ST must include the selection-based SFR FTP_ITC.1/H323.
            </note>
          </f-element>

          <f-element>
            <title>The TSF shall enforce the following default stateful traffic filtering rules on all network traffic matching protocol types identified in FFW_ACL_EXT.2.1:<selectables linebreak="yes">
              <selectable>SIP traffic where a BYE message precedes an INVITE message</selectable>
              <selectable>H.225 traffic where an RCF reply precedes any other traffic</selectable>
              <selectable>H.245 traffic where a ResponseMessage precedes a RequestMessage</selectable>
              <selectable>MGCP traffic where a DLCX message precedes a CRCX message</selectable></selectables>.
            </title>
            <note role="application">
              The stateful traffic filtering rules selected in FFW_ACL_EXT.2.2 must match the selections made for VVoIP protocols in FFW_ACL_EXT.2.1.
            </note>
          </f-element>
          <f-element>
            <title>
              The TSF shall terminate any connection found to be in violation of the default stateful traffic filtering rules and provide the ability to generate an audit record of the event.
            </title>
            <note role="application">
              Due to the potential for an SBC to receive large amounts of traffic that gets filtered by the default stateful traffic filtering rules, 
              this PP-Module only requires that the TSF have the ability to generate audit records for all events. 
              “Configure traffic filtering rules” in FMT_SMF.1/SBC provides an expectation that the administrator can determine which rules cause 
              audit records to be generated so that the environment is not producing an excessively large volume of audit data.
            </note>
          </f-element>
          <f-element>
            <title>
              The TSF shall dynamically open media ports to VVoIP protocol traffic upon negotiation of a session and close these ports upon termination of a session.
            </title>
          </f-element>
          <f-element>
            <title>The TSF shall not define a static range of ports to remain open indefinitely for the purpose of allowing VVoIP protocol traffic.</title>
          <aactivity>
              <TSS>TBD
                <h:p/></TSS>
              <Guidance>TBD
                <h:p/></Guidance>
              <Tests>
                TBD
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        
        
        <ext-comp-def title="Deep Packet Inspection" fam-id="FFW_DPI_EXT">
          <fam-behavior>TBD</fam-behavior> 
        </ext-comp-def>
        <f-component cc-id="ffw_dpi_ext.1" name="Deep Packet Inspection"> 
          <consistency-rationale>TBD</consistency-rationale>
          
          <comp-lev>TBD
          </comp-lev>
          <management>TBD
          </management>
          <audit>TBD
          </audit>
          <dependencies>TBD
          </dependencies>
          
          <f-element>
            <title>
              The TSF shall implement DPI for the following protocols: <selectables>
                <selectable>H.323 (H.225, H.245)</selectable>
                <selectable>SIP</selectable>
                <selectable>RTP</selectable>
                <selectable>RTCP</selectable></selectables>. 
            </title>
            <note role="application">If “H.323” is selected in this requirement, the ST must include the selection-based SFR FTP_ITC.1/H323.</note>
          </f-element>
          <f-element>
            <title>
              The TSF shall enforce the following rules for DPI: <assignable>for each protocol listed in FFW_DPI_EXT.1.1, 
              list elements of the packet data that are examined for potentially malicious content or compatibility with the protocol definition</assignable>. 
            </title>
          </f-element>
          <f-element>
            <title>
              When traffic is found to be in violation of a DPI rule, the TSF shall take the following action:
              <selectables>
                <selectable>drop the traffic</selectable>
                <selectable>generate an audit record</selectable>
                <selectable>generate an alarm</selectable></selectables>.
            </title>
            <aactivity>
              <TSS>TBD
                <h:p/></TSS>
              <Guidance>TBD
                <h:p/></Guidance>
              <Tests>
                TBD
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        
        <ext-comp-def title="Network Address Translation" fam-id="FFW_NAT_EXT">
          <fam-behavior>TBD</fam-behavior> 
        </ext-comp-def>
        <f-component cc-id="ffw_nat_ext.1" name="Topology Hiding/NAT Traversal"> 
          <consistency-rationale>TBD</consistency-rationale>
          
          <comp-lev>TBD
          </comp-lev>
          <management>TBD
          </management>
          <audit>TBD
          </audit>
          <dependencies>TBD
          </dependencies>
          
          <f-element>
            <title>
              The TSF shall support NAT of signaling and media channel traffic through the TOE that is mediated by the [<h:i>B2BUA policy</h:i>] defined by FDP_IFC.1.
            </title>
          </f-element>
          <f-element>
            <title>
              The TSF shall support NAT for the following protocols <selectables>
                <selectable>SIP</selectable>
                <selectable>SIP-TLS</selectable>
                <selectable>H.225</selectable>
                <selectable>H.245</selectable></selectables>. 
            </title>
          </f-element>
          <f-element>
            <title>
              The TSF shall use NAT to replace the IP address header value of traffic originating from the internal network with 
              <selectables>
                <selectable>the IP address of the TOE</selectable>
                <selectable>a [<h:i>Security Administrator</h:i>]-defined value</selectable></selectables>.
            </title>
          </f-element>
          <f-element>
            <title>
              The TSF shall maintain a NAT table to ensure that traffic bound for the internal network is directed to only the intended recipient.
            </title>
            <aactivity>
              <TSS>TBD
                <h:p/></TSS>
              <Guidance>TBD
                <h:p/></Guidance>
              <Tests>
                TBD
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        
        
      </sec:man_ffw>
      
      <sec:man_fia title="Identification and Authentication (FIA)">
        
        <f-component name="Authentication Failure Handling (Claimant)" cc-id="fia_afl.1" iteration="AuthSvr">
          
          <consistency-rationale>This SFR defines functional behavior enforced on external users being authenticated by the TOE, which is functionality that is not covered by the Base-PP.</consistency-rationale>

          <f-element>
            <title>The TSF shall detect when [<h:i>an administrator configurable positive integer <h:b>of successive</h:b></h:i>] unsuccessful authentication attempts occur related to [<h:i>claimants attempting to authenticate</h:i>]. 
            </title>
          </f-element>
          <f-element><title>When the defined number of unsuccessful authentication attempts has been [<h:i>met</h:i>], 
            the TSF shall <selectables onlyone="yes">
              <selectable>prevent the offending remote entity from successfully authenticating until 
                <assignable>action</assignable> is taken by a local Administrator</selectable>
              <selectable>prevent the offending claimant from successfully authenticating until an administrator-defined time period has elapsed</selectable></selectables>. 
            </title>
            <note role="application">
              This requirement applies to claimant authentication attempts in support of an authentication service provided for a federated relying party. 
              This requirement does not apply to login to the TOE by privileged users for administrative accesses; these cases are addressed by the Base-PP iteration of this SFR. 
              Responses to authentication queries to aid the claimant in providing acceptable authenticators is not considered a preventative action and are allowed prior to reaching the lockout threshold. 
              The “action” taken by a local administrator is implementation specific and is defined in the operational guidance (for example, lockout reset or password reset). 
              The ST author chooses one of the selections for handling of authentication failures depending on how the TOE has implemented this handler. 
          </note>
            <aactivity>
              <TSS>
                The evaluator shall examine the TSS to verify that it contains a description of how successive unsuccessful authentication attempts by claimants are detected and tracked. 
                The evaluator shall verify that the TSS describes the method by which the offending claimant is prevented from successfully being authenticated by the TOE, and the actions necessary to restore this ability. 
                <h:p/>
              </TSS>
              <Guidance>The evaluator shall examine the operational guidance to verify that it describes how to configure the threshold for unsuccessful claimant authentication attempts and how to perform 
                any actions that affect claimants that are limited in this manner (e.g., instructions for configuring the lockout period or for manually unlocking the offending claimant).<h:p/>
              </Guidance>
              <Tests>
                The evaluator shall perform the following tests in conjunction with testing for FCS_EAPTLS_EXT.1 test 2a, and if applicable, test 2c for each claimant authentication method:
                <testlist>
                  <test>
                    The evaluator shall follow the operational guidance to configure a number of failed attempts that will cause lockout behavior to be enforced against a claimant. 
                    The evaluator shall establish a registered user and provide invalid input for the authentication method repeatedly to reach the configured limit. 
                    The evaluator shall then observe the configured penalty is imposed.
                  </test>
                  <test>
                    If the administrator action selection is claimed in FIA_AFL.1.2/AuthSvr, the evaluator shall ensure that following the operational guidance for restoring access to a locked-out claimant will subsequently allow that claimant to be
                    authenticated.
                    <h:p/>
                    If the time period selection is claimed in FIA_AFL.1.2/AuthSvr, the evaluator shall follow the operational guidance to configure a certain lockout time for claimants that are locked out due to excessive authentication failures.
                    The evaluator shall cause a claimant to be locked out in this manner, wait for a time period that is just less than the configured value, and verify that an authentication attempt using valid credentials still does not result in
                    successful access.
                    The evaluator shall then repeat this behavior but wait for just after the configured time period has elapsed to show that an authentication attempt using valid credentials results in successful access.
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
      
        <f-component name="Re-Authenticating" cc-id="fia_uau.6">
          <consistency-rationale>This SFR defines support for re-authentication of administrators, which expands on the authentication functionality defined in the Base-PP.</consistency-rationale>
          <f-element>
            <title>The TSF shall re-authenticate the <h:b>administrative</h:b> user under the conditions [<h:i>when the user
              changes their password, <selectables>
                <selectable>following TSF-initiated session locking</selectable>
                <selectable><assignable>other conditions</assignable></selectable>
                <selectable exclusive="yes">no other conditions</selectable></selectables></h:i>]. 
            </title>
            <aactivity>
              <TSS>There are no TSS evaluation activities for this component.<h:p/></TSS>
              <Guidance>The evaluator shall ensure that the operational guidance includes instructions on how an administrator of the TOE can change their own password.<h:p/></Guidance>
              <Tests>
                The evaluator will access the TOE using a particular administrative account and then attempt to change the password of that account as directed by the operational guidance.
                While making this attempt, the evaluator will verify that re-authentication is required.
                <h:p>
                  If other re-authentication conditions are specified, the evaluator shall cause those conditions to
                  occur and verify that the TSF re-authenticates the authenticated user.
                </h:p>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
      
        <f-component name="X.509 Certificate Validation (Claimant)" cc-id="fia_x509_ext.1" iteration="AuthSvr">
          <consistency-rationale>The Base-PP defines X.509 validation requirements for external entities presenting certificates to the TOE. This PP-Module
          defines a separate iteration of this function to define the certificate validation behavior that is enforced against claimants requesting to be authenticated by the TOE. It is substantially refined
          from its original definition to address issues specific to the handling of claimant certificates.</consistency-rationale>
          <f-element>
            <title>
              The TSF shall validate certificates in accordance with the following rules: 
              <h:ul>
                <h:li>RFC 5280 <h:b>version 3</h:b> certificate validation and certification path validation <h:b>supporting <selectables>
                  <selectable>a minimum path length of <assignable>value greater than or equal to three</assignable></selectable>
                  <selectable>no prior constraints on path length</selectable></selectables></h:b></h:li>
                <h:li>The certification path must terminate with a CA certificate <h:b>trusted by the TSF specifically for claimant authentication.</h:b></h:li>
                <h:li>The TSF shall validate a certification path by ensuring that all CA certificates in the certification path contain the basicConstraints extension with the CA flag set to TRUE.</h:li>
                <h:li>The TSF shall validate the revocation status of <h:b>each certificate in the certificate path <selectables linebreak="yes">
                  <selectable>containing an OCSP provider in the AIA extension using the Online Certificate Status Protocol (OCSP) as specified in RFC 6960</selectable>
                  <selectable>containing a certificate revocation list (CRL) distribution point in the 
                    CRLDP extension or AIA extension using <selectables>
                      <selectable>a CRL as specified in RFC 5280 Section 6.3</selectable>
                      <selectable>a CRL as specified in RFC 5759 Section 5</selectable></selectables></selectable></selectables></h:b>.
                </h:li>
                <h:li>
                  The TSF shall validate the extendedKeyUsage field <h:b>is present and contains key usage values</h:b> according to the following rules: <h:b>
                  <selectables linebreak="yes">
                    <selectable>Certificates do not assert anyExtendedKeyUsage (OID 2.5.29.37.0)</selectable>
                    <selectable>Client certificates associated with authenticated entities presented for <selectables>
                      <selectable>TLS</selectable>
                      <selectable>DTLS</selectable></selectables> shall have the Client Authentication purpose (id-kp 2 with OID 1.3.6.1.5.5.7.3.2) in the extendedKeyUsage field.</selectable>
                    <selectable>
                      <selectables linebreak="yes">
                        <selectable>Server certificates presented for <selectables><selectable>TLS</selectable><selectable>DTLS</selectable></selectables> shall 
                          have the Server Authentication purpose (id-kp 1 with OID 1.3.6.1.5.5.7.3.1) in the extendedKeyUsage field.</selectable>
                        <selectable>Certificates presented for IPsec shall have the ipsec-IKE purpose (id-kp 17 with OID 1.3.6.1.5.5.7.3.17)</selectable>
                        <selectable>OCSP certificates presented for OCSP responses shall have the OCSP Signing purpose (id-kp 9 with OID 1.3.6.1.5.5.7.3.9) in the extendedKeyUsage field.</selectable></selectables></selectable></selectables></h:b>.
                </h:li><h:b>
                <h:li>
                  The TSF shall validate that each CA certificate in the certification path indicating a path length constraint in the basicConstraints 
                  extension does not have more than the specified number of subordinate CA certificates in the certification path from the end-entity certificate 
                  to the CA certificate indicating the constraint, not counting the CA certificate itself or any self-issued certificates in the certification path.
                </h:li>
                <h:li>
                  The TSF shall process name constraints of type Directory Name and <selectables>
                    <selectable>rfc822Name</selectable>
                    <selectable>dnsName</selectable>
                    <selectable>UPN Name (Other Name = id-ms-san-sc-logon-upn)</selectable>
                    <selectable><assignable>other name type</assignable></selectable>
                    <selectable>no other name type</selectable></selectables> 
                  by verifying that each name of a supported name type present in the end-entity certificate subject field or subjectAlternateName extension, 
                  is allowed in each CA certificate in the certification path, is not disallowed by any of the CA certificates in the certification path, 
                  and that each name type included in the end-entity certificate and constrained by a CA certificate in the certification path is processed.
                </h:li>
                <h:li>
                  The TSF shall process the following certificate extensions: <selectables>
                    <selectable>Certificate Policy extension in accordance with RFC 5280 and <selectables linebreak="yes">
                      <selectable>Policy mapping extension in accordance with RFC 5280</selectable>
                      <selectable>Policy constraints extension in accordance with RFC 5280</selectable>
                      <selectable>Inhibit anyPolicy extension in accordance with RFC 5280</selectable>
                      <selectable>No other policy related extension</selectable></selectables> in support of claimant authentication and <assignable>
                        other intended purposes and limitations of policy related extension processing</assignable></selectable>
                    <selectable><assignable>other standard extensions</assignable></selectable>
                    <selectable>no other extensions</selectable></selectables>.
                </h:li></h:b>
              </h:ul>
            </title>
            <note role="Application">
              The ST author claims supported certificate validity checking options for each rule. For name constraints, all supported name types used to match names presented in a certificate to registered users 
              and the associated standard matching method are described.
              <h:p/>
              The ST author claims supported certificate policies. ‘Policy Constraints…’ is claimed if the TOE’s authentication policy depends on the certificate policies for claimant certificates. 
              Other policy related extensions within the selection are claimed if supported. 
              The extension inhibitPolicyMapping is not claimed if the TSF does not support certificate chains of length four or more. 
              The policy related extensions, if supported, are primarily used in this PP-Module for claimant authentication, but are allowed for other certificate authentications. 
              The ST author specifies the intended use and any limits of support for these extensions or specifies ‘no other policy related extension’ in the assignment of this selection.
              <h:p/>
              The ST author specifies any additional supported X509 extensions, and the associated extension processing rules used to determine claimant identity attributes or conditions that can be used in the TOE’s authentication policy. 
            </note>
          </f-element>
          <f-element>
            <title>The TSF shall only treat a certificate as a CA certificate if the basicConstraints extension is present and the CA flag is set to TRUE.</title>
            <aactivity>
              <TSS>
                The evaluator shall ensure the TSS describes where the check of validity of the certificates takes place. 
                The evaluator ensures the TSS also provides a description of the certificate path validation algorithm. 
              </TSS>
              <Guidance>
                The evaluator shall ensure that instructions for any configurable features of the validation process are included. 
                If the ST includes provisions for exception processing of certificate revocation status information,
                the evaluator shall ensure the operational guidance contains instructions on how the indicated options are configured. 
                <h:p/>
                If the TOE supports processing of the policy constraints extension and the TOE requires configuration to validate the policy of a claimant certificate, the evaluator shall verify that the operational guidance includes instructions for 
                configuring this behavior.
              </Guidance>
              <Tests>
                The evaluator shall perform the following tests. The tests for the extendedKeyUsage rules, name constraints and policy constraints, if supported, are performed in conjunction with the uses that require those rules.
                <testlist>
                  <test>
                    The evaluator shall demonstrate that validating a certificate without a valid certification path results in the function failing, for each of the following reasons, in turn: 
                    <h:ul>
                      <h:li>by establishing a certificate path in which one of the issuing certificates is not a CA certificate</h:li>
                      <h:li>by omitting the basicConstraints field in one of the issuing certificates</h:li>
                      <h:li>by setting the basicConstraints field in an issuing certificate to have CA=False</h:li>
                      <h:li>by omitting the CA signing bit of the key usage field in an issuing certificate</h:li>
                      <h:li>by setting the path length field of a valid CA field to a value strictly less than the certificate path</h:li>
                    </h:ul> <h:p/>
                    The evaluator shall then establish a valid certificate path consisting of valid CA certificates and demonstrate that the function succeeds. 
                    The evaluator shall then remove trust in one of the CA certificates and show that the function fails. 
                  </test>
                  <test>
                    The evaluator shall demonstrate that validating an expired certificate results in the function failing. 
                  </test>
                  <test>
                    The evaluator shall test that the TOE can properly handle revoked certificates – conditional on the revocation method that is selected; if multiple methods are selected, then the test is repeated for each method. 
                    The evaluator tests revocation for each certificate in the trust chain which advertises certificate status information. 
                    The evaluator shall ensure that a valid certificate is used, and that the validation function succeeds. 
                    The evaluator shall then attempt the test with a certificate that will be revoked (for each method chosen in the selection) and verify that the validation function fails. 
                  </test>
                  <test>
                    [conditional] If any OCSP option is selected, the evaluator shall present a delegated OCSP certificate that does not have the OCSP signing purpose and verify that validation of the OCSP response fails. 
                    If CRL is selected, the evaluator shall configure the CA to sign a CRL with a certificate that does not have the cRLsign key usage bit set and verify that validation of the CRL fails.
                  </test>
                  <test>
                    [conditional] If the TOE supports EC certificates, then the evaluator shall establish a valid, trusted certificate chain consisting of an EC leaf certificate, 
                    an EC Intermediate CA certificate not designated as a trust anchor, and an EC certificate designated as a trusted anchor, 
                    where the elliptic curve parameters are specified as a named curve. The evaluator shall confirm that the TOE validates the certificate chain. 
                  </test>
                  <test>
                    [conditional] If the TOE supports EC certificates, then the evaluator shall replace the intermediate certificate in the certificate chain for Test 5 with a modified certificate.
                    This certificate is modified to have the public key information field where the EC parameters use an explicit format version of the Elliptic Curve parameters 
                    in the corresponding field of intermediate CA certificate from Test 5. This certificate is also modified to be signed by the trusted EC root CA, but with no other changes. 
                    The evaluator shall confirm the TOE treats the certificate as invalid.
                  </test>
                  <test>
                    The evaluator shall test the following name constraints: <h:ul>
                      <h:li>Test 7a: For each name type supported, the evaluator shall establish a valid certificate for a registered entity. 
                        The evaluator shall ensure the certificate has a valid path length of at least three, consisting of a trusted root, 
                        an issuing CA that is not a trust anchor, and the leaf certificate representing the entity. 
                        The evaluator shall ensure that the leaf certificate includes a single name of the supported name type and no other DN or SAN entries. 
                        The evaluator shall initiate an application requiring authentication of that entity using the certificate and verify the TSF successfully authenticates the entity. </h:li>
                      <h:li>Test 7b: For each leaf certificate used in test 7a, the evaluator shall establish a new leaf certificate that includes the same name and name type, 
                        but which is issued by a different subordinate CA asserting an allowed-list that does not include the name for the name-type. 
                        The evaluator shall ensure the subordinate CA is included in a valid chain to the same trusted root. 
                        The evaluator shall initiate the same application attempt as in test 7a for the new certificate and observe that the TSF indicates the certificate is invalid.</h:li>
                      <h:li>Test 7c: For each leaf certificate used in test 7a, 
                        the evaluator shall establish a new leaf certificate that includes the same name and name type, 
                        but which is issued by a different subordinate CA asserting a denylist matching the name for the name type. 
                        The evaluator shall ensure the subordinate CA is included in a valid certificate path to the same trusted root. 
                        The evaluator shall initiate the same application attempt as in test 7a using the new certificate and observe that the TSF indicates the certificate is invalid. </h:li>
                    </h:ul> 
                  </test>
                  <test>
                    [conditional] If the TOE supports processing of the policy constraints extension, then for each distinct purpose and within the constraints indicated in the ST 
                    (claimant authentication and any other supported subject types), the evaluator shall follow the operational guidance as necessary to configure the TOE to require the subject’s certificate to assert a specific certificate policy. 
                    The evaluator shall perform the following sub-tests: <h:ul>
                      <h:li>Test 8a: The evaluator shall establish a certificate for the subject asserting the certificate policy OID required, issued by a Certification Authority also specifying the required certificate policy. 
                        The evaluator shall present the established certificate for authentication and verify that the TSF successfully validates the certificate. </h:li>
                      <h:li>Test 8b: [conditional] If the ST selects 'Inhibit anyPolicy extension...," the evaluator shall repeat test 8a using a certificate asserting the required policy but issued by a Certification Authority only asserting the ‘anyPolicy’ OID (value {2 5 29 32 0}) in its policy constraints extension. The evaluator shall observe that the TSF successfully validates the certificate.</h:li>
                      <h:li>Test 8c: [conditional] If the ST indicates support for the policy mapping extension, 
                        the evaluator shall repeat test 8a using a certificate asserting a new policy OID that does not match the required policy OID. This certificate  
                        is issued by a CA asserting the new policy OID in the policy constraints extension, and the CA certificate is issued by a second CA. This second
                        CA asserts the required OID in its certificate constraints extension and contains a policy mapping extension 
                        including the mapping of the asserted policy to the required policy. 
                        The evaluator shall observe that the TSF successfully validates the certificate.<h:p/> 
                        Note that installing a root CA trusted by the TOE with the required policy constraints and policy mapping extensions may be required if the TSF limits the path length of certificate chains.</h:li>
                      <h:li>Test 8d: [conditional] If the ST indicates support for both policy mapping and policy constraints extensions and also supports certificate chains of length four or more, 
                        the evaluator shall establish a certificate for the subject asserting a new policy OID that does not match the required policy OID. This certificate 
                        is issued by a CA asserting the new policy OID, which in turn is issued by a second CA which includes the policy mapping extension that maps the required policy OID to the new policy OID.  
                        The second CA is in turn issued by a third CA that has the extension policy constraints with the inhibitPolicyMapping field having value 0. 
                        The evaluator shall present the certificate to the TSF for authentication and observe that the TSF indicates the certificate is invalid.</h:li>
                      <h:li>Test 8e: [conditional] If the ST indicates support for both policy mapping and policy constraints extensions, 
                        the evaluator shall select a policy OID not required for authentication in the TOE’s current configuration. 
                        The evaluator shall establish a certificate for the subject that does not assert the non-required policy, 
                        which is issued by a CA also asserting the new policy OID, which in turn, is issued by a CA asserting the ‘anyPolicy’ OID and having a critical policy constraints extension 
                        with the explicitPolicy field with value 0. The evaluator shall present the certificate to the TSF for authentication and observe that the TSF indicates the certificate is invalid.</h:li>
                      <h:li>Test 8f: The evaluator shall establish a certificate for the subject asserting the required policy but issued by a Certification Authority that does not include any certificate policy related extensions. 
                        The evaluator shall present the certificate for authentication and observe that the TSF indicates the certificate is invalid.</h:li>
                      <h:li>Test 8g: The evaluator shall establish a certificate for the subject asserting the required certificate policy issued by a Certification Authority that only asserts a single, 
                        non-matching policy OID in its policy related extensions (i.e., the CA certificate does not include the matching OID, ‘anyPolicy’ assertions or assert an OID that is mapped to the required OID 
                        via policy matching extensions by previous Certification Authorities in the certificate chain, if supported). 
                        The evaluator shall present the certificate to the TSF for authentication and observe the TSF indicates the certificate is invalid.</h:li>
                      <h:li>Test 8h: [conditional] If the ST indicates the inhibitAnyPolicy extension is supported, the evaluator shall establish a certificate for the subject asserting the required policy issued by a CA 
                        asserting the ‘anyPolicy’ OID, which is in turn issued by a CA with an inhibitAny extension with value 0. 
                        The evaluator shall present the certificate to the TSF for authentication and observe the TSF indicates the certificate is invalid. <h:p/>
                        Note that installing a root CA trusted by the TOE with the inhibitAny extension may be required if the TSF limits the path length of certificate chains.</h:li>
                    </h:ul>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
          
    
  
      </sec:man_fia>
      
      <sec:man_fmt title="Security Management (FMT)">
        <f-component name="Specification of Management Functions (Authentication Server)" id="fel-managementfun-as" cc-id="fmt_smf.1" iteration="AuthSvr">
			<consistency-rationale>This SFR defines additional management functionality that is specific to the PP-Module’s product type and would therefore not be expected to be present in the Base-PP.</consistency-rationale>
			<f-element>
			<title>The TSF shall be capable of performing the following management functions: [<h:i>
			  <h:ul>
			    <h:li>Ability to configure claimant verification data</h:li>
			    <h:li>Ability to manage trust store data</h:li>
			    <h:li>Ability to configure administrator authentication credential</h:li>
			    <h:li>Ability to configure trusted channel to relying party</h:li>
			    <h:li><selectables linebreak="yes">
			      <selectable>Ability to configure IPsec functionality</selectable>
			      <selectable>Ability to configure DTLS functionality</selectable>
			      <selectable>Ability to configure TLS functionality</selectable>
			      <selectable>Ability to manage claimant authentication policy</selectable>
			      <selectable>Ability to configure RADIUS shared secret</selectable>
			      <selectable>Ability to define authorized NAS</selectable>
			      <selectable>Ability to configure cryptographic key storage</selectable>
			      <selectable>Ability to configure lockout policy for failed claimant authentication</selectable>
			      <selectable>Ability to unlock a claimant account</selectable>
			      <selectable>Ability to configure certificate validation checking mechanisms</selectable>
			      <selectable>Ability to define conditions in which claimant authentication attempts are rejected</selectable>
			      <selectable>Ability to associate pre-shared keys with claimants or external entities</selectable>
			      <selectable>Ability to configure restrictions on the composition of pre-shared keys</selectable>
			      <selectable>Ability to configure restrictions on the validation of pre-shared keys</selectable>
			      <selectable>Ability to generate pre-shared keys</selectable>
			      <selectable>Ability to accept pre-shared keys</selectable>
			      <selectable>No other functions</selectable>
			    </selectables></h:li>
			  </h:ul></h:i>].
			</title>
			  <note role="Application">
			    This SFR defines additional management functions for the TOE beyond what is defined in the Base-PP as FMT_SMF.1. 
			  </note>
			<aactivity>
			  <TSS>
			    The evaluator shall verify that the TSS identifies all of the security-relevant management functions that apply to the security functions the TOE claims from this PP-Module.<h:p/>
			  </TSS>
			  <Guidance> 
			    For each claimed management function, the evaluator shall ensure that the operational guidance contains instructions for how to configure the function.<h:p/>
			  </Guidance>
			  <Tests>
			  For each claimed management function, the evaluator shall follow the operational guidance to configure the behavior of that function and ensure that applying the configuration settings have the intended effect. 
			  Note that some or all of these functions may be tested in the course of performing the test activities for other claimed SFRs. 
			  </Tests>
			</aactivity>
		</f-element>
		</f-component>
        </sec:man_fmt>
      
      
      <sec:man_fta title="TOE Access (FTA)">
        
        <f-component name="TOE Session Establishment" cc-id="fta_tse.1">
          <consistency-rationale>This SFR relates to the handling of claimants being authenticated by the TOE, which is functionality that is beyond the original scope of the Base-PP.</consistency-rationale>
          <f-element>
            <title>The TSF shall be able to deny <h:b>claimant</h:b> session establishment based on [<h:i>invalid certificate, 
              <selectables>
                <selectable><assignable>other identity attributes</assignable></selectable>
                <selectable>no other attributes</selectable></selectables></h:i>].</title>
            <note role="application">
              The intent of this SFR is to describe any circumstances that would cause a claimant’s authentication request to be rejected. 
              All compliant TOEs will reject authentication requests based on invalid credentials. 
              A compliant TOE may also impose additional limitations such as suspended accounts or time of day restrictions, depending on the capabilities of the TSF’s authentication mechanism.
            </note>
            <aactivity>
              <TSS>The evaluator shall examine the TSS to determine that all of the attributes on which a claimant session can be denied are specifically defined.<h:p/>
              </TSS>
              <Guidance>The evaluator shall examine the operational guidance to verify that it contains instructions for configuring each of the attributes identified in the TSS.<h:p/> </Guidance>
              <Tests>The evaluator shall successfully have a claimant be authenticated by the TOE. 
                For each attribute claimed in the SFR, the evaluator shall configure the TOE to deny user access based on a specific value of that attribute.
                The evaluator shall then attempt to establish a new session in contravention to the attribute setting while still providing valid authentication data. The evaluator shall observe that the access attempt fails.  
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
      </sec:man_fta>
      
	  <sec:man_ftp title="Trusted Path/Channels (FTP)">
		  <f-component cc-id="ftp_itc.1" name="Inter-TSF Trusted Channel (Relying Party Communications)" iteration="NAS">
		  <consistency-rationale>
			  This SFR iterates the FTP_ITC.1 SFR defined in the Base-PP to define trusted communication channels for the functionality that is specific to this PP-Module.
			  </consistency-rationale>
			  <f-element>
			  <title>
			    The TSF shall provide <h:b><selectables>
			      <selectable>an IPsec</selectable>
			      <selectable id="uses-radsec">a RadSec</selectable>
			      <selectable>a mutually authenticated TLS</selectable>
			      <selectable>a mutually authenticated DTLS</selectable></selectables></h:b>
			    communication channel between itself and <h:b>a relying party</h:b> that is logically distinct from other communication channels and provides assured 
			    identification of its end points and protection of the channel data from modification or disclosure.
				  </title>
			    <note role="Application">If "a RadSec" is selected, the selection-based SFR FCS_RADSEC_EXT.1 must be claimed.</note>
				</f-element>
			    <f-element>
		<title>
		  The TSF shall permit [<h:i>the TSF, <h:b>or the relying party</h:b></h:i>] to initiate communication via the trusted channel.
		</title>
	</f-element>
			  <f-element>
			    <title>The TSF shall initiate communication via the trusted channel for [<h:i>responses to authentication request messages received from the relying party</h:i>].</title>
				  <aactivity>
				    <TSS>
				      The evaluator shall examine the TSS to determine that, for all communications with authorized IT entities identified in the requirement, 
				      each communications mechanism is identified in terms of the allowed protocols for that IT entity. 
				      The evaluator shall also confirm that all protocols listed in the TSS are specified and included in the requirements in the ST. 
				    </TSS>
				    <Guidance>
				      The evaluator shall confirm that the guidance documentation contains instructions for establishing and reestablishing the allowed protocols with each authorized IT entity. 
				    </Guidance>
				    <Tests>For each claimed trusted channel mechanism, the evaluator shall configure the TOE to interact with a relying party using that channel and verify using packet captures that the claimed mechanism
				    is used.</Tests>
				  </aactivity>	  
			  </f-element>
		  </f-component>
      </sec:man_ftp>
        
    </man-sfrs>
   <opt-sfrs/>
    <sel-sfrs>
      
      <sec:sel_fcs title="Cryptographic Support (FCS)">
        
        <ext-comp-def title="RadSec" fam-id="FCS_RADSEC_EXT">
          <fam-behavior>Components in this family define requirements for the TSF to use RadSec to secure RADIUS data in transit.</fam-behavior> 
        </ext-comp-def>
        
        <f-component name="RadSec" cc-id="fcs_radsec_ext.1">
		  <depends on-sel="uses-radsec"/>
          <consistency-rationale>This SFR defines the implementation of RadSec and the peer authentication method that it uses. 
            This relies on the TLS requirements defined by the Base-PP and may also use the X.509v3 certificate validation methods
            specified in the Base-PP, depending on the selected peer authentication method.</consistency-rationale>
          
          <comp-lev>defines implementation requirements for RadSec.</comp-lev>
          <management>The following actions could be considered for the management functions in FMT:
            <h:ul>
              <h:li>Configuration of trusted channel to relying party</h:li>
            </h:ul></management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>
            <no-link>FCS_RADIUS_EXT.1</no-link> Authentication Protocol<h:p/>
            FCS_RBG_EXT.1 Random Bit Generation<h:p/>
            [<no-link>FIA_PSK_EXT.1</no-link> Pre-Shared Key Composition, or<h:p/>
            FIA_X509_EXT.1 X.509 Certificate Validation]
            
	  </dependencies>
          <f-element>
            <title>
              The TSF shall implement RadSec as specified in RFC 6614, as updated by RFC 8996, to communicate securely with a relying party.
            </title>
          </f-element>
          <f-element>
            <title>
              The TSF shall perform relying party authentication using <selectables>
              <selectable id="s-x509-certs">X.509v3 certificates</selectable>
              <selectable id="radsec-uses-psk">pre-shared keys</selectable></selectables>.
            </title>
            <note role="application">
              It is recommended that both X.509v3 certificates and pre-shared keys be supported for resiliency purposes.
            </note>
          </f-element>
          <f-element>
            <title>
              The TSF shall implement RadSec using 
              <selectables>
                <selectable>TLS</selectable>
                <selectable>DTLS</selectable></selectables> with mutual authentication.
            </title>
            <note role="Application">This SFR is claimed if "a RadSec" is selected in FTP_ITC.1.1/NAS.
            <h:p/>
            If "pre-shared keys" is selected in FCS_RADSEC_EXT.1.2, the selection-based SFR FIA_PSK_EXT.1/AuthSvr must be claimed.</note>
          <aactivity>
              <TSS>
                TBD<h:p/>
	      </TSS>
              <Guidance>
                TBD<h:p/>
	      </Guidance>
              <Tests>
                TBD
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
      
        
      </sec:sel_fcs> 
      
      <sec:sel_fia title="Identification and Authentication (FIA)">
        
        
        
        <ext-comp-def title="HMAC-Based One-Time Password Pre-Shared Keys" fam-id="FIA_HOTP_EXT">
          <fam-behavior>Components in this family define requirements for the use of HMAC-based One-Time Password authentication, including generation methods and usage restrictions.</fam-behavior>
        </ext-comp-def>
        <f-component cc-id="fia_hotp_ext.1" id="fia-hotp-ext-1" name="HMAC-Based One-Time Password Pre-Shared Keys">
          <depends on-sel="eaptls-uses-hotp" and="psk-uses-hotp"/>
          <consistency-rationale>This SFR extends the functionality of the Base-PP by defining the use of pre-shared keys as an authenticator.</consistency-rationale>
          <comp-lev> defines the implementation of HOTP.</comp-lev>
          <management>The following actions could be considered for the management functions in FMT:
            <h:ul>
              <h:li>Ability to configure restrictions on the composition of pre-shared keys</h:li>
              <h:li>Ability to configure restrictions on the validation of pre-shared keys</h:li>
            </h:ul></management>
          <audit>The following actions should be auditable if FAU_GEN Security audit data generation is included in the PP/ST:
            <h:ul>
              <h:li>Generation of a HOTP seed key</h:li>
              <h:li>Entity HOTP value comparison</h:li>
            </h:ul>
          </audit>
          <dependencies>FCS_COP.1 Cryptographic Operation<h:p/>
            FCS_RBG_EXT.1 Random Bit Generation</dependencies>
          <f-element id="fia-hotp-ext-1e1">
            <title>
              The TSF shall support HMAC-Based One-Time Password authentication (HOTP) in accordance with RFC 4226. 
            </title>
          </f-element>
          <f-element id="fia-hotp-ext-1e2">
            <title>
              The TSF shall generate a HOTP seed key according to FCS_RBG_EXT.1 of 
              <selectables>
                <selectable>128</selectable>
                <selectable>256</selectable></selectables> bits.
            </title>
          </f-element>
          <f-element id="fia-hotp-ext-1e3">
            <title>The TSF shall generate a new HOTP seed key for each claimant to be authenticated.
            </title>
          </f-element>
          <f-element id="fia-hotp-ext-1e4">
            <title>
              The TSF shall use
              <selectables>
                <selectable>SHA-1</selectable>
                <selectable>SHA-256</selectable>
                <selectable>SHA-384</selectable>
                <selectable>SHA-512</selectable></selectables> with key sizes 
              <assignable>key size (in bits) used in HMAC</assignable> and message digest sizes 
              <selectables>
                <selectable>160</selectable>
                <selectable>256</selectable>
                <selectable>384</selectable>
                <selectable>512</selectable></selectables> to derive a HOTP hash from the HOTP seed and counter.
            </title>
          </f-element>
          <f-element id="fia-hotp-ext-1e5">
            <title>
              The TSF shall truncate the HOTP hash per FIA_HOTP_EXT.1.4 to create a HOTP of  
              <selectables linebreak="yes">
                <selectable>administrator configurable character length of at least 6</selectable>
                <selectable>preset character length of
                  <selectables>
                    <selectable>6</selectable>
                    <selectable>7</selectable>
                    <selectable>8</selectable>
                    <selectable>9</selectable>
                    <selectable>10</selectable></selectables></selectable></selectables>.
            </title>
          </f-element>
          <f-element id="fia-hotp-ext-1e6">
            <title>
              The TSF shall 
              <selectables>
                <selectable>throttle invalid requests to 
                  <selectables linebreak="yes">
                    <selectable>administrator configurable value</selectable>
                    <selectable><assignable>value less than 10</assignable></selectable></selectables> per minute</selectable>
                <selectable>lock the associated account after 
                  <selectables>
                    <selectable>administrator configurable value</selectable>
                    <selectable><assignable>value less than 10</assignable></selectable></selectables> failed attempts until 
                  <selectables>
                    <selectable>an administrator unlocks the account</selectable>
                    <selectable>a configurable time period has elapsed</selectable></selectables></selectable></selectables>.
            </title>
          </f-element>
          <f-element id="fia-hotp-ext-1e7">
            <title>
              The TSF shall not verify HOTP attempts outside of the counter look-ahead window of 
              <assignable>a value less than or equal to three</assignable> 
              <selectables>
                <selectable>except for rescynchronization</selectable>
                <selectable>where a look-ahead window of <selectables>
                  <selectable>a configurable value</selectable>
                  <selectable><assignable>fixed value</assignable></selectable></selectables> is used to reset the counter but which is not considered a valid HOTP value</selectable>
                <selectable>with no exception</selectable></selectables>.
            </title>
          </f-element>
          <f-element id="fia-hotp-ext-1e8">
            <title>
              The TSF shall increment the counter after each successful authentication.
            </title>
            
            <note role="application">
              This SFR is claimed if "HOTP" is selected in FCS_EAPTLS_EXT.1.3 or if "HMAC-based one-time password" is selected in FIA_PSK_EXT.1.2/AuthSvr.
              <h:p/>
              The selection in FIA_HOTP_EXT.1.4 must be consistent with the key size specified for the size of the keys used in conjunction with the keyed-hash message authentication.
              <h:p/>In FIA_HOTP_EXT.1.5, the ST author may either provide a configurable character length of at least 6 or a preset size between 6 and 10.
              <h:p/>In FIA_HOTP_EXT.1.6, the ST may select throttle requests, account lockout, or both.
              <h:p/>The selections in FIA_HOTP_EXT.1.7 indicate an optional resynchronization process that allows an arbitrary look-ahead to determine a new counter value by the verifier. 
              This can be used for out-of-sync claimants or for initial use of a HOTP mechanism.  
              The HOTP value presented for resynchronization does not serve to authenticate a user. 
              A second verification using a small look-ahead window (at most three) is required after resynchronization to ensure the claimant and the TOE counter values are indeed synchronized 
              so that arbitrary values are not considered valid. If such a resynchronization function is not supported, ‘with no exception’ is claimed. 
              <h:p/>The HOTP seed and all derived values are considered secret keys for purposes of protection.
            </note>
            <aactivity>
              <TSS>
                The evaluator shall confirm the TSS describes how the TOE complies with the RFC.<h:p/>The evaluator shall confirm the TSS describes how the HOTP seed is generated and ensure it aligns with FCS_RBG_EXT.1.
                <h:p/>
                The evaluator shall confirm the TSS describes how the HOTP seed is protected and ensure it aligns with the key storage requirements in FCS_STG_EXT.1.
                <h:p/>
                The evaluator shall confirm that the TSS describes HOTP seed keys and HOTP security parameters and indicates controlled access in accordance with FCS_CKM.3, 
                and that it includes a description of encrypted export for seed keys that require transfer to claimant devices.
                <h:p/>
                The evaluator shall confirm the TSS describes how a new HOTP seed is assigned for each claimant and how each claimant is uniquely identified.
                <h:p/>
                The evaluator shall confirm the TSS describes how the HOTP seed is conditioned into a HOTP hash and verify it matches the selection in FIA_HOTP_EXT.1.4.
                <h:p/>
                The evaluator shall confirm the TSS describes how the HOTP hash is truncated and verify it matches the selection in FIA_HOTP_EXT.1.5.
                <h:p/>
                The evaluator shall confirm the TSS describes how the TOE handles multiple incoming invalid requests and verify it provides an anti-hammer mechanism that matches the selections made in FIA_HOTP_EXT.1.6.
                <h:p/>
                The evaluator shall confirm the TSS describes how the TOE handles resynchronization and how it rejects values outside of the look-ahead window selected in FIA_TOTP_EXT.1.7 for claimant authentication.
                <h:p/>
              </TSS>
              <Guidance>The evaluator shall verify the operational guidance contains all configuration guidance for setting any administrative value that is configurable in the FIA_HOTP_EXT.1 requirements.<h:p/>
              </Guidance>
              <Tests>
                The following tests may be performed in conjunction with those in FCS_EAPTLS_EXT.1. 
                The evaluator shall follow any instructions in the operational guidance to establish a HOTP seed key for a registered claimant, 
                initialize a claimant HOTP token, synchronize the counter between the token and the TSF if necessary, and perform the tests listed below.
                <h:p/>
                Note that response of the TSF for an invalid HOTP value may be a request for the claimant to submit a new value, 
                an indication that resynchronization is required, or an indication that the claimant’s authentication request is rejected. 
                Any of these responses is acceptable; a response that the authentication request is successful in Test 2 or Test 3 represents a failed test.
                <testlist>
                  <test>The evaluator shall attempt to authenticate the claimant using a valid HOTP token and confirm that the TSF determines the value to be valid.</test>
                  <test>The evaluator shall advance a registered claimant’s HOTP token counter beyond the look-ahead window and attempt to validate the claimant using the next HOTP token value. 
                    The evaluator shall observe that the TSF does not indicate the claimant is authenticated. </test>
                  <test>The evaluator shall replay a previous HOTP value from a registered claimant (e.g., the value used in Test 1) and confirm that the TSF does not indicate the claimant is authenticated.</test>
                  <test>[conditional on support for resynchronization] The evaluator shall repeat Test 2 and then follow the operational guidance to resynchronize the counter. 
                    The evaluator shall observe that after resynchronization, the TSF does not indicate successful authentication, but instead requests an additional HOTP value from the claimant.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
	  
        <ext-comp-def title="Pre-Shared Keys" fam-id="FIA_PSK_EXT">
          <fam-behavior>Components in this family describe the requirements for pre-shared keys used for authentication.</fam-behavior>
        </ext-comp-def>
		
		<!-- FIA_PSK_EXT.1 Pre-Shared Key Composition -->
        <f-component cc-id="fia_psk_ext.1" name="Pre-Shared Key Usage" status="invisible">
          <consistency-rationale/>
          <comp-lev>defines the use and composition of pre-shared keys used for authentication.</comp-lev>
          <management>The following actions could be considered for the management functions in FMT:
            <h:ul>
              <h:li>Ability to associate pre-shared keys with claimants or external entities</h:li>
            </h:ul></management>
          <audit>There are no auditable events foreseen.
          </audit>
          <dependencies>[<no-link>FCS_EAPTLS_EXT.1</no-link> EAP-TLS Protocol, or <h:p/>
            FCS_IPSEC_EXT.1 IPsec]</dependencies>
          <f-element>
            <title>
              The TSF shall be able to use pre-shared keys for <assignable>protocols or authentication schemes that use pre-shared keys</assignable>. 
            </title>
          </f-element>
          <f-element>
            <title>
              The TSF shall be able to accept the following as pre-shared keys: <assignable>types of supported pre-shared keys (e.g., randomly generated, password-based, OTP)</assignable>.
            </title>
            <aactivity>
              <no-tests></no-tests>
            </aactivity>
          </f-element>            
          <audit-event/>
        </f-component>
        
        
        
        <f-component cc-id="fia_psk_ext.1" name="Pre-Shared Key Usage (Claimant Authentication)" iteration="AuthSvr">
          <depends on-sel="eaptls-uses-psk" and="radsec-uses-psk"/>
          <consistency-rationale>This SFR extends the functionality of the Base-PP by defining the use of pre-shared keys as an authenticator.</consistency-rationale>
          
          <f-element id="fia-psk-ext-1e1">
            <title>
              The TSF shall be able to use pre-shared keys for <selectables>
                <selectable>IPsec</selectable>
                <selectable>RadSec</selectable>
                <selectable>EAP-TTLS</selectable>
                <selectable>TLS</selectable>
                <selectable>DTLS</selectable>
                <selectable>RADIUS</selectable>
                <selectable>HOTP</selectable>
                <selectable>TOTP</selectable></selectables>.
            </title>
          </f-element>
          <f-element id="fia-psk-ext-1e2">
            <title>
              The TSF shall be able to accept the following as pre-shared keys: 
              <selectables>
                <selectable id="psk-generated">generated bit-based</selectable>
                <selectable id="psk-password">password-based</selectable>
                <selectable id="psk-uses-hotp">HMAC-based one-time password</selectable>
                <selectable id="psk-uses-totp">time-based one-time password</selectable></selectables>.
            </title>
            <note role="application">
              This SFR is claimed if any other TOE functions require the use of pre-shared keys. Within the scope of this PP-Module, this includes the following:
              <h:ul>
                <h:li>Any of "static PSK," "HOTP," or "TOTP" is selected in FCS_EAPTLS_EXT.1.3.</h:li>
                <h:li>"pre-shared keys" is selected in FCS_RADSEC_EXT.1.2.</h:li>
                <h:li>"pre-shared keys" is selected in FCS_IPSEC_EXT.1.13 (from the Base-PP).</h:li>
              </h:ul>
              <h:p/>
              IPsec is claimed in FIA_PSK_EXT.1.1/AuthSvr, if IPsec is claimed in FTP_ITC.1/NAS and the selection for FCS_IPSEC_EXT.1.13 in the Base-PP includes ‘pre-shared keys.’  
              PSK in IPsec may use any supported type of PSK – those supported are claimed in FIA_PSK_EXT.1.2/AuthSvr. Use of certificates in IPsec is preferred.
              <h:p/>
              RadSec is claimed in FIA_PSK_EXT.1.1/AuthSvr, if RadSec is selected in FTP_ITC.1/NAS and the (D)TLS implementation in RadSec allows server-only authentication or supports a PSK ciphersuite. 
              RadSec can use any type of PSK – those supported should be claimed in FIA_PSK_EXT.1.2/AuthSvr. Use of a mutually authenticated (D)TLS channel using certificate-based authentication is preferred.
              <h:p/>
              If a pre-shared key used for RADIUS is validated directly using legacy methods, RADIUS is claimed. 
              It should not be claimed when RADIUS is used exclusively with RadSec since in that case, the legacy PSK used in RADIUS is replaced with a fixed value not used in authenticating the relying party.  
              Use of a mutually authenticated channel using certificates to authenticate the relying party is preferred.
              <h:p/>
              EAP-TTLS is claimed in FIA_PSK_EXT.1.1/AuthSvr if it is claimed in FCS_EAPTLS_EXT.1.1 and support for static PSK (alone or in combination) is indicated in FCS_EAPTLS_EXT.1.3. 
              When EAP-TTLS is claimed in FIA_PSK_EXT.1.1/AuthSvr, at least one of ‘password-based,’ ‘HMAC-based one-time password,’ or ‘time-based one-time password’ is claimed in FIA_PSK_EXT.1.2/AuthSvr. 
              Multiple password types are claimed if the TSF supports validation of combinations of password types, even if presented in a single payload.
              <h:p/>
              Note that even if presented by a claimant, PSK are ignored in EAP-TLS implementations.
              <h:p/>
              TLS or DTLS, respsectively, are claimed if a PSK-based ciphersuite is claimed in FCS_TLSS_EXT.1 or FCS_DTLSS_EXT.1 of the Base-PP.
              <h:p/>
              HOTP or TOTP, respectively, are claimed if the respective entry is claimed in FCS_EAPTLS_EXT.1.3 and the TSF validates the HOTP or TOTP values presented in an authentication request. 
              If claimed, the PSK represents the seed key value generated by the TOE and shared via out-of-band mechanisms with the claimant as well as 
              the HOTP or TOTP values presented by a claimant to be validated; the ‘generated as bit-based PSK’ as well as the respective HOTP or TOTP entries are claimed in FIA_PSK_EXT.1.2/AuthSvr. The selection-based SFRs
              FIA_HOTP_EXT.1 and FIA_TOTP_EXT.1 must also be claimed if HOTP or TOTP are claimed, respectively.
              <h:p/>
              Note that if HOTP or TOTP mechanisms are supported, but the values are only validated by an external entity, the HOTP or TOTP entries are not claimed in FIA_PSK_EXT.1/AuthSvr.
              <h:p/>
              If "generated bit-based" is selected in FIA_PSK_EXT.1.2/AuthSvr, FIA_PSK_EXT.2 must be claimed.
              <h:p/>
              If "password-based" is selected in FIA_PSK_EXT.1.2/AuthSvr, FIA_PSK_EXT.3 must be claimed.
            </note>
            <aactivity>
              <TSS>The evaluator shall examine the TSS to ensure that it identifies all protocols that allow  pre-shared keys. 
                For each protocol identified by the requirement, the evaluator shall confirm that the TSS states which pre-shared key 
                selections are supported.<h:p/></TSS>
              
              <Guidance>The evaluator shall examine the operational guidance to determine that it provides guidance to 
                administrators on how to configure all selected pre-shared key options if any configuration is required.<h:p/>
              </Guidance>
              
              <Tests>
                The evaluator shall also perform the following tests for each protocol (or instantiation of a protocol, 
                if performed by a different implementation on the TOE). 
                <testlist>
                  <test>For each mechanism selected in FIA_PSK_EXT.1.2/AuthSvr, the evaluator shall attempt to establish a connection 
                    and confirm that the connection requires the selected factors in the PSK to establish the connection. </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>            
		 <audit-event/>
        </f-component>
        
        
        <f-component cc-id="fia_psk_ext.2" id="fia-psk-ext-2" name="Generated Pre-Shared Keys">
          
          <depends on-sel="psk-generated"/>
          
          <consistency-rationale>This SFR extends the functionality of the Base-PP by defining the use of pre-shared keys as an authenticator.</consistency-rationale>
          <comp-lev>defines the use and composition of generated pre-shared keys used for authentication.</comp-lev>
          <management>The following actions could be considered for the management functions in FMT:
            <h:ul>
              <h:li>Ability to generate pre-shared keys</h:li>
              <h:li>Ability to accept pre-shared keys</h:li>
            </h:ul></management>
          <audit>There are no auditable events foreseen.
          </audit>
          <dependencies><no-link>FIA_PSK_EXT.1</no-link> Pre-Shared Key Usage</dependencies>
          <f-element id="fia-psk-ext-2e1">
            <title>
              The TSF shall be able to 
              <selectables>
                <selectable>accept externally generated pre-shared keys</selectable>
                <selectable>
                  generate 
                  <selectables>
                    <selectable>128</selectable>
                    <selectable>256</selectable></selectables> bit-based pre-shared keys via FCS_RBG_EXT.1. 
                  </selectable></selectables>.
            </title>
            <note role="application">
              This SFR is claimed if "generated bit-based" is selected in FIA_PSK_EXT.1.2/AuthSvr.
              <h:p/>
              Generated PSKs are expected to be shared between components via an out-of-band mechanism. 
                            <h:p/>
              
            </note>
            <aactivity>
              <TSS>If "generate" is selected, the evaluator shall confirm that this process uses the RBG specified in FCS_RBG_EXT.1 
                and the output matches the size selected in FIA_PSK_EXT.2.1.<h:p/> 
              </TSS>
              <Guidance>The evaluator shall confirm the operational guidance contains instructions for generating or entering pre-shared keys (based on the selection made in FIA_PSK_EXT.2.1)
                for each protocol identified in the FIA_PSK_EXT.1.1/AuthSvr. <h:p/>
              </Guidance>
              <Tests>
                <testlist>
                  <test>For each selection made in FIA_PSK_EXT.2.1, the evaluator shall input and register the PSK (whether this involves generating the key or inputting it). 
                    The evaluator shall attempt to use the PSK (e.g., by making a claimant authentication attempt using the registered key) and confirm that the TSF indicates the PSK matches.
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        
        <f-component cc-id="fia_psk_ext.3" id="fia-psk-ext-3" name="Password-Based Pre-Shared Keys">
          <depends on-sel="psk-password"/>
          <consistency-rationale>This SFR extends the functionality of the Base-PP by defining the use of pre-shared keys as an authenticator.</consistency-rationale>
          <comp-lev>defines the use and composition of password-based pre-shared keys used for authentication.</comp-lev>
          <management>The following actions could be considered for the management functions in FMT:
            <h:ul>
              <h:li>Ability to configure restrictions on the composition of pre-shared keys</h:li>
              <h:li>Ability to configure restrictions on the validation of pre-shared keys</h:li>
            </h:ul></management>
          <audit>No auditable events are foreseen.</audit>
          <dependencies>FCS_COP.1 Cryptographic Operation <h:p/>
            FCS_RBG_EXT.1 Random Bit Generation <h:p/>
            <no-link>FIA_PSK_EXT.1</no-link> Pre-Shared Key Usage</dependencies>
          <f-element id="fia-psk-ext-3e1">
            <title>
              The TSF shall support a PSK of up to <assignable>positive integer of 64 or more</assignable> characters. 
            </title>
          </f-element>
          <f-element id="fia-psk-ext-3e2">
            <title>The TSF shall allow PSKs to be composed of any combination of uppercase characters, 
              lowercase characters, numbers, the following special characters: "!", "@", "#", "$", "%", "^", "&amp;", "*", "(", and ")", and 
              <selectables>
                <selectable><assignable>other supported special characters</assignable></selectable>
                <selectable exclusive="yes">no other characters</selectable></selectables>.
            </title>
          </f-element>
          <f-element id="fia-psk-ext-3e3">
            <title>
              The TSF shall perform Password-based Key Derivation Functions in accordance with a specified cryptographic algorithm HMAC-<selectables>
                <selectable>SHA-256</selectable>
                <selectable>SHA-384</selectable>
                <selectable>SHA-512</selectable></selectables>, with 
              <assignable>positive integer of 4096 or more</assignable> iterations, and output cryptographic key sizes 
              <selectables>
                <selectable>128</selectable>
                <selectable>256</selectable></selectables> bits that meet the following: [<h:i>NIST SP 800-132</h:i>].
            </title>
          </f-element>
          <f-element id="fia-psk-ext-3e4">
            <title>
              The TSF shall not accept PSKs failing to meet <selectables>
                <selectable>an administrator-defined</selectable>
                <selectable>a fixed</selectable></selectables>
              password policy indicating the maximum PSK length consistent with FIA_PSK_EXT.3.1 and <selectables>
                <selectable><assignable>password policy indicating minimum length and types of characters required</assignable></selectable>
                <selectable>no additional password constraints</selectable></selectables>.
            </title>
          </f-element>
          <f-element id="fia-psk-ext-3e5">
            <title>
              The TSF shall generate all salts using an RBG that meets FCS_RBG_EXT.1 and with entropy corresponding 
              to the key size selected for PBKDF in FIA_PSK_EXT.3.3.
            </title>
          </f-element>
          <f-element id="fia-psk-ext-3e6">
            <title>
              The TSF shall require the PSK to be entered in accordance with the 
              <selectables>
                <selectable>user authentication policy</selectable>
                <selectable>protocol authentication requirement</selectable>
              </selectables>.
            </title>
          </f-element>
          
            <f-element id="fia-psk-ext-3e7">
              <title>
                The TSF shall 
                <selectables>
                  <selectable>provide a password strength meter</selectable>
                  <selectable>check the password against a denylist</selectable>
                  <selectable>perform no action to assist the user in choosing a strong password</selectable></selectables>. 
              </title>
            <note role="application">
              This SFR is claimed if "password-based" is selected in FIA_PSK_EXT.1.2/AuthSvr.
              <h:p/>
              For FIA_PSK_EXT.3.1, the ST author assigns the maximum size of the PSK it supports; it must support at least 64 characters. 
              <h:p/>
              For FIA_PSK_EXT.3.2, the ST author assigns any other supported characters; if there are no other supported characters, they should select "no other characters." 
              <h:p/>
              For FIA_PSK_EXT.3.3, the ST author selects the parameters based on the PBKDF used by the TSF. 
              <h:p/>
              For FIA_PSK_EXT.3.4, if the minimum length is settable, then the ST author chooses "a value settable by the administrator." If the minimum length is not settable, 
              the ST author fills in the assignment with the minimum length the PSK must be. This requirement is to ensure bounds work properly.
              <h:p/>
              For FIA_PSK_EXT.3.7, the ST author may select one, both, or neither of the functions in alignment with NIST SP800-63b.
              </note>
            <aactivity>
              <TSS>The evaluator shall examine the TSS to ensure it describes the process by which the bit-based pre-shared keys are used.  
                <h:p/>
                Support for length: The evaluator shall check to ensure that the TSS describes the allowable ranges for PSK lengths, and that at least 64 characters or a length defined by the platform may be specified by the user.
                <h:p/>
                Support for character set: The evaluator shall check to ensure that the TSS describes the allowable character set and that it contains the characters listed in the SFR.
                <h:p/>
                Support for PBKDF: The evaluator shall examine the TSS to ensure that the use of PBKDF2 is described and that the key sizes match that described by the ST author.
                <h:p/>
                The evaluator shall check that the TSS describes the method by which the PSK is first encoded and then fed to the hash algorithm. 
                The settings for the algorithm (padding, blocking, etc.) shall be described, and the evaluator shall verify that these are supported by the selections in this component as well as the selections concerning the hash function itself. 
                <h:p/>
                For the NIST SP 800-132-based conditioning of the PSK, the required evaluation activities will be performed when doing the evaluation activities for the appropriate requirements (FCS_COP.1/KeyedHash). 
                <h:p/>
                The evaluator shall confirm that the minimum length is described.
                <h:p/>
                The ST author shall provide a description in the TSS regarding the salt generation. The evaluator shall confirm that the salt is generated using an RBG described in FCS_RBG_EXT.1.
                <h:p/>
                [conditional] If password strength meter or password denylist is selected, the evaluator shall examine the TSS to ensure 
                any password checking functionality provided by the TSF is described and contains details on how the function operates.
                <h:p/>
              </TSS>
              <Guidance>
                The evaluator shall examine the operational guidance to determine that it provides guidance to administrators on the composition of strong text-based pre-shared keys and 
                (if the selection indicates keys of various lengths can be entered) that it provides information on the range of lengths supported.
                The guidance must specify the allowable characters for pre-shared keys in accordance with FIA_PSK_EXT.3.2.
                <h:p/>
              </Guidance>
              <Tests>
                If the TSF supports a configurable password policy, the evaluator shall follow the operational guidance to configure the password policy based on the selections made in FIA_PSK_EXT.3.4. 
                If the password policy is not configurable, the evaluator will determine the password policy used by the TSF.
                <h:p/>
                The evaluator shall perform the following tests:
                <testlist>
                  <test>The evaluator shall compose a representative set of PSK meeting the TSF’s password policy, 
                    to include one having the maximum length, one having the minimum length, and which, 
                    in aggregate, contain each of the supported special characters and each type of character supported. 
                    For each of the PSK, the evaluator shall demonstrate successful registration and use of the PSK.  </test>
                  <test>For each of the password policy constraints indicated in FCS_PSK_EXT.3.4, 
                    the evaluator shall compose a password violating the constraint and demonstrate that the TSF rejects the PSK.</test>
                  <test>[conditional] If a password strength meter is supported, when performing Tests 1 and 2, the evaluator shall confirm that the TSF reflects the indicated strength of the PSK.</test>
                  <test>[conditional] If the TOE supports a password denylist, the evaluator shall enter a denylisted password and verify that the password is rejected or flagged as such.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
     
        
        <ext-comp-def title="Time-Based One-Time Password Pre-Shared Keys" fam-id="FIA_TOTP_EXT">
          <fam-behavior>Components in this family define requirements for the use of Time-Based One-Time password authentication, including generation methods and usage restrictions.</fam-behavior>
        </ext-comp-def>
        <f-component cc-id="fia_totp_ext.1" id="fia-totp-ext-1" name="Time-Based One-Time Password Pre-Shared Keys">
          <depends on-sel="eaptls-uses-totp" and="psk-uses-totp"/>
          <consistency-rationale>This SFR extends the functionality of the Base-PP by defining the use of pre-shared keys as an authenticator.</consistency-rationale>
          <comp-lev> defines the implementation of TOTP.</comp-lev>
          <management>The following actions could be considered for the management functions in FMT:
            <h:ul>
              <h:li>Ability to configure restrictions on the composition of pre-shared keys</h:li>
              <h:li>Ability to configure restrictions on the validation of pre-shared keys</h:li>
            </h:ul></management>
          <audit>The following actions should be auditable if FAU_GEN Security audit data generation is included in the PP/ST:
            <h:ul>
              <h:li>Generation of a TOTP seed key</h:li>
              <h:li>Entity TOTP value comparison</h:li>
            </h:ul>
          </audit>
          <dependencies>FCS_COP.1 Cryptographic Operation<h:p/>
            FCS_RBG_EXT.1 Random Bit Generation</dependencies>
          <f-element id="fia-totp-ext-1e1">
            <title>
              The TSF shall support Time-Based One-Time Password (TOTP) authentication in accordance with RFC 6238. 
            </title>
          </f-element>
          <f-element id="fia-totp-ext-1e2">
            <title>
              The TSF shall generate a TOTP seed according to FCS_RBG_EXT.1 of 
              <selectables>
                <selectable>128</selectable>
                <selectable>256</selectable></selectables> bits.
            </title>
          </f-element>
          <f-element id="fia-totp-ext-1e3">
            <title>The TSF shall generate a new TOTP seed for each claimant.
            </title>
          </f-element>
          <f-element id="fia-totp-ext-1e4">
            <title>
              The TSF shall use 
              <selectables>
                <selectable>SHA-1</selectable>
                <selectable>SHA-256</selectable>
                <selectable>SHA-384</selectable>
                <selectable>SHA-512</selectable></selectables> with key sizes 
              <assignable>key size (in bits) used in HMAC</assignable> and message digest sizes 
              <selectables>
                <selectable>160</selectable>
                <selectable>256</selectable>
                <selectable>384</selectable>
                <selectable>512</selectable></selectables> bits to derive a TOTP hash from the TOTP seed and current time provided by NTP.
            </title>
          </f-element>
          <f-element id="fia-totp-ext-1e5">
            <title>
              The TSF shall truncate the TOTP hash per FIA_TOTP_EXT.1.4 to create a TOTP of  
              <selectables linebreak="yes">
                <selectable>administrator configurable character length of at least 6</selectable>
                <selectable>preset character length of
                  <selectables> 
                    <selectable>6</selectable>
                    <selectable>7</selectable>
                    <selectable>8</selectable>
                    <selectable>9</selectable>
                    <selectable>10</selectable></selectables></selectable></selectables>.
            </title>
          </f-element>
          <f-element id="fia-totp-ext-1e6">
            <title>
              The TSF shall
              <selectables linebreak="yes">
                <selectable>throttle invalid requests to 
                  <selectables>
                    <selectable>administrator configurable value</selectable>
                    <selectable><assignable>value less than 10</assignable></selectable></selectables> per minute</selectable>
                <selectable>lock the associated account after 
                  <selectables>
                    <selectable>administrator configurable value</selectable>
                    <selectable><assignable>value less than 10</assignable></selectable></selectables> failed attempts until 
                  <selectables>
                    <selectable>an administrator unlocks the account</selectable>
                    <selectable>a configurable time period has elapsed</selectable></selectables></selectable></selectables>.
            </title>
          </f-element>
          <f-element id="fia-totp-ext-1e7">
            <title>
              The TSF shall set a time-step size of 
              <selectables onlyone="yes">
                <selectable>a configurable number of</selectable>
                <selectable><assignable>a value less than or equal to 30</assignable></selectable></selectables> seconds.
            </title>
          </f-element>
          <f-element id="fia-totp-ext-1e8">
            <title>
              The TSF shall not validate a TOTP value calculated using a time drift of more than 
              <selectables onlyone="yes">
                <selectable>a configurable value</selectable>
                <selectable><assignable>a value less than or equal to 3</assignable></selectable></selectables> time-steps.            
            </title>
          </f-element>
          <f-element id="fia-totp-ext-1e9">
            <title>
              The TSF shall 
              <selectables onlyone="yes">
                <selectable>allow resynchronization by recording time drift within the limit of FIA_TOTP_EXT.1.8</selectable>
                <selectable>not permit resynchronization</selectable></selectables>.           
            </title>
         
            <note role="application">
              This SFR is claimed if "TOTP" is selected in FCS_EAPTLS_EXT.1.3 or if "time-based one-time password" is selected in FIA_PSK_EXT.1.2/AuthSvr.
              <h:p/>
              The selection FIA_TOTP_EXT.1.4 must be consistent with the key size specified for the size of the keys used in conjunction with the keyed-hash message authentication.
              <h:p/>
              In FIA_TOTP_EXT.1.5, the ST author may either provide a configurable character length of at least 6 or a preset size between 6 and 10.
              <h:p/>
              In FIA_TOTP_EXT.1.6, the ST author may select throttle requests, account lockout, or both.
              <h:p/>
              The TOTP seed and all derived values are considered secret keys for purposes of protection.
              </note>
            <aactivity>
              <TSS>
                The evaluator shall confirm the TSS describes how the TOE complies with the RFC.
                <h:p/>
                The evaluator shall confirm the TSS describes how the TOTP seed is generated and ensure it aligns with FCS_RBG_EXT.1.
                <h:p/>
                The evaluator shall confirm the TSS describes how the TOTP seed is protected and ensure it aligns with FCS_STG_EXT.1. 
                <h:p/>
                The evaluator shall confirm that the TSS describes TOTP seed keys and TOTP security parameters and indicates controlled access in accordance with FCS_CKM.3, 
                and that it includes a description of encrypted export for seed keys that require transfer to claimant devices. 
                <h:p/>
                The evaluator shall confirm the TSS describes how a new TOTP seed is assigned for each claimant and how each claimant is uniquely identified.
                <h:p/>
                The evaluator shall confirm the TSS describes how the TOTP seed is conditioned into a TOTP hash and verify that it matches the selection in FIA_TOTP_EXT.1.4.
                <h:p/>
                The evaluator shall confirm the TSS describes how the TOTP hash is truncated and verify that it matches the selection in FIA_TOTP_EXT.1.5.
                <h:p/>
                The evaluator shall confirm the TSS describes how the TOE handles multiple incoming invalid requests and verify it provides an anti-hammer mechanism that matches the selections in FIA_TOTP_EXT.1.6.
                <h:p/>
                The evaluator shall confirm the TSS describes how the TOE handles resynchronization and how it rejects values outside of the look-ahead window selected in FIA_TOTP_EXT.1.7 for claimant authentication.
                <h:p/>
                </TSS>
              <Guidance>The evaluator shall verify the operational guidance contains all configuration guidance for setting any administrative value that is configurable in the FIA_TOTP_EXT.1 requirements.<h:p/></Guidance>
              <Tests>
                The following tests may be performed in conjunction with those in FCS_EAPTLS_EXT.1.
                The evaluator shall follow any instructions in the operational guidance to establish a TOTP seed key for a registered claimant, 
                initialize a claimant TOTP token, synchronize time between the token and the TSF if necessary, and perform the tests listed below.
                <h:p/>
                Note that the response of the TSF for an invalid TOTP value may be a request for the claimant to submit a new value, 
                or an indication that the claimant’s authentication request is rejected. 
                Any of these responses is acceptable; a response that the authentication request is successful in Test 2 or Test 3 represents a failed test.
                
                <testlist>
                  <test>The evaluator shall attempt to authenticate the claimant using the TOTP token and confirm that the TSF determines the value to be valid.</test>
                  <test>The evaluator shall advance a registered claimant’s TOTP token time beyond the allowed time drift and attempt to validate the claimant using the TOTP token value. 
                    The evaluator shall observe that the TSF does not indicate the claimant is authenticated. </test>
                  <test>The evaluator shall replay a previous TOTP value from a registered claimant (e.g., the value used in Test 1) after a delay equal to one time step and confirm that the TSF does not indicate the claimant is authenticated.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
    
    
      </sec:sel_fia> 

    </sel-sfrs>
    <obj-sfrs>
    </obj-sfrs>
    <impl-dep-sfrs></impl-dep-sfrs>
  </sec:Security_Requirements>
  
  <appendix title="Implicitly Satisfied Requirements" id="satisfiedreqs">
    This PP-Module has no implicitly satisfied requirements. All SFR dependencies are explicitly met either through SFRs defined by the PP-Module or inherited from the Base-PP. 
  </appendix>
  
  <appendix title="Allocation of Requirements in Distributed TOEs" id="allocation">
    
    For a distributed TOE, the SFRs in this PP-Module need to be met by the
    TOE as a whole, but not all SFRs will necessarily be implemented by all components. The
    following categories are defined in order to specify when each SFR must be implemented by a
    component: <h:ul>
      <h:li><h:b>All Components ("All"):</h:b> All components that comprise the distributed TOE must
        independently satisfy the requirement.</h:li>
      <h:li><h:b>At least one Component ("One"):</h:b> This requirement must be fulfilled by at least one
        component within the distributed TOE.</h:li>
      <h:li><h:b>Feature Dependent ("Feature Dependent"):</h:b> These requirements will only be
        fulfilled where the feature is implemented by the distributed TOE component (note
        that the requirement to meet the PP-Module as a whole requires that at least one component
        implements these requirements if they are claimed by the TOE).</h:li></h:ul>
    The table below specifies how each of the SFRs in this PP-Module must be met, using the categories above.
    
    <h:table>
      <h:tr class="header">
        <h:td>Requirement</h:td>
        <h:td>Description</h:td>
        <h:td>Distributed TOE SFR Allocation</h:td>
      </h:tr>
      <h:tr>
        <h:td>FAU_GEN.1/AuthSvr</h:td>
        <h:td>Audit Data Generation (Authentication Server)</h:td>
        <h:td>All</h:td>
      </h:tr>
      <h:tr>
        <h:td>FCO_NRO.1</h:td>
        <h:td>Selective Proof of Origin</h:td>
        <h:td>Feature-dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FCO_NRR.1</h:td>
        <h:td>Selective Proof of Receipt</h:td>
        <h:td>Feature-dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FCS_CKM.3</h:td>
        <h:td>Cryptographic Key Access</h:td>
        <h:td>All</h:td>
      </h:tr>
      <h:tr>
        <h:td>FCS_EAPTLS_EXT.1</h:td>
        <h:td>EAP-TLS Protocol</h:td>
        <h:td>Feature-dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FCS_RADIUS_EXT.1</h:td>
        <h:td>Authentication Protocol</h:td>
        <h:td>Feature-dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FCS_STG_EXT.1</h:td>
        <h:td>Cryptographic Key Storage</h:td>
        <h:td>All</h:td>
      </h:tr>
      <h:tr>
        <h:td>FIA_AFL.1/AuthSvr</h:td>
        <h:td>Authentication Failure Handling (Claimant)</h:td>
        <h:td>Feature-dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FIA_X509_EXT.1/AuthSvr</h:td>
        <h:td>X.509 Certificate Validation (Claimant)</h:td>
        <h:td>Feature-dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FIA_UAU.6</h:td>
        <h:td>Re-Authenticating</h:td>
        <h:td>Feature-dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FMT_SMF.1/AuthSvr</h:td>
        <h:td>Specification of Management Functions (Authentication Server)</h:td>
        <h:td>All</h:td>
      </h:tr>
      <h:tr>
        <h:td>FTA_TSE.1</h:td>
        <h:td>TOE Session Establishment</h:td>
        <h:td>Feature-dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FTP_ITC.1/NAS</h:td>
        <h:td>Inter-TSF Trusted Channel (Relying Party Communications)</h:td>
        <h:td>Feature-dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FCS_RADSEC_EXT.1 (selection-based)</h:td>
        <h:td>RadSec</h:td>
        <h:td>Feature-dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FIA_HOTP_EXT.1 (selection-based)</h:td>
        <h:td>HMAC-Based One-Time Password Pre-Shared Keys</h:td>
        <h:td>Feature-dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FIA_PSK_EXT.1/AuthSvr (selection-based)</h:td>
        <h:td>Pre-Shared Key Usage</h:td>
        <h:td>Feature-dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FIA_PSK_EXT.2 (selection-based)</h:td>
        <h:td>Generated Pre-Shared Keys</h:td>
        <h:td>Feature-dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FIA_PSK_EXT.3 (selection-based)</h:td>
        <h:td>Password-Based Pre-Shared Keys</h:td>
        <h:td>Feature-dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FIA_TOTP_EXT.1 (selection-based)</h:td>
        <h:td>Time-Based One-Time Password Pre-Shared Keys</h:td>
        <h:td>Feature-dependent</h:td>
      </h:tr>
      
    </h:table>
    
  </appendix>
  
  <appendix title="Entropy Documentation and Assessment" id="EAR">
    The TOE does not require any additional supplementary information to describe its entropy sources beyond the requirements outlined in the Base-PP.  
  </appendix>
  
  <bibliography>
    <cc-entry/>
    
    
    <entry id="bibNDcPP">
      <tag>NDcPP</tag>
      <description>
        <h:a href="https://www.niap-ccevs.org/MMO/PP/CPP_ND_V2.2E.pdf">collaborative Protection Profile for Network Devices</h:a>, Version 2.2e, March 23, 2020
      </description>
    </entry>
    
    <entry id="bibNDSD">
      <tag>NDcPP SD</tag>
      <description>
        <h:a href="https://www.niap-ccevs.org/MMO/PP/CPP_ND_V2.2-SD.pdf">Supporting Document - Evaluation Activities for Network Device cPP</h:a>, Version 2.2, December 2019
      </description>
    </entry>

  </bibliography>
</Module>
