<Module xmlns="https://niap-ccevs.org/cc/v1" xmlns:sec="https://niap-ccevs.org/cc/v1/section" xmlns:h="http://www.w3.org/1999/xhtml" boilerplate="yes" target-product="Session Border Controller" name="Session Border Controller">
 
  <PPReference> 
    <ReferenceTable>
      <PPVersion>1.1</PPVersion>
      <PPAuthor>National Information Assurance Partnership</PPAuthor>
      <PPPubDate>2025-04-11</PPPubDate>
      <Keywords>Session Border Controller</Keywords>
    </ReferenceTable>
  </PPReference>
  <RevisionHistory>
    <entry>
      <version>1.0</version>
      <date>2022-12-05</date>
      <subject>Initial Release</subject>
    </entry>
    <entry>
      <version>1.1</version>
      <date>2025-04-11</date>
      <subject>Apply NIAP Technical Decisions, Update to CC:2022</subject>
    </entry>
  </RevisionHistory>
  <release-notes><h:h3>TDs Applied</h:h3></release-notes><include-pkg id="pkgTLS">
    <git>
      <url>https://github.com/commoncriteria/tls</url>
      <branch>release-2.0</branch>
    </git>
    <url>https://www.niap-ccevs.org/protectionprofiles/465</url>
  </include-pkg>

  <include-pkg id="pkgX509">
    <git>
      <url>https://github.com/commoncriteria/X509</url>
      <branch>release-1.0</branch>
    </git>
    <url>https://www.niap-ccevs.org/protectionprofiles/511</url>
  </include-pkg>
  
  <!-- TODO: see Issues for open items -->
  
  <sec:Introduction>
    <sec:Overview>
      The scope of this Protection Profile Module (PP-Module) is to describe the security functionality of a Session Border Controller (SBC) in terms of [CC] and to define functional and assurance requirements for such products. 
      This PP-Module is intended for use with the following Base-PPs:
      <h:ul>
        <h:li>collaborative Protection Profile for
          Network Devices, Version 3.0e (NDcPP)</h:li>
      </h:ul>
      This Base-PP is valid because a device that implements an SBC is a specific type of network device, 
      and there is nothing about the implementation of an SBC that would prevent any of the security capabilities defined by the Base-PP from being satisfied.
      <h:p/>
      Note that the NDcPP defines an optional architecture for a “distributed TOE” that allows for security functionality to be spread across multiple distinct components. 
      This PP-Module does not require or prohibit the TOE from being a distributed system when the TOE conforms to the NDcPP; the TOE may be standalone or distributed in this case.
      
    </sec:Overview>
    <tech-terms>
      <suppress>Functional Package,Extended Package</suppress>
      <term abbr="ACL" full="Access Control List"/>
      <term abbr="B2BUA" full="Back-To-Back User Agent"/>
      <term abbr="CDR" full="Call Detail Record"/>
      <term abbr="DoS" full="Denial of Service"/>
      <term abbr="DPI" full="Deep Packet Inspection"/>
      <term abbr="ESC" full="Enterprise Session Controller">
        A voice/video over IP (VVoIP) infrastructure device that is used to set up and tear down calls between VVoIP endpoints.
      </term>
      <term full="H.323">
        A communications protocol defined by the ITU Telecommunications Standardization Sector (ITU-T) that is used for creating, modifying, and terminating multimedia sessions with multiple participants.
      </term>
      <term abbr="IP-PBX" full="Internet Protocol Public Branch Exchange"/>
      <term abbr="MGCP" full="Media Gateway Control Protocol">
        A means of communication between a media gateway and a media gateway controller.
      </term>
      <term abbr="NAT" full="Network Address Translation"/>
      <term abbr="QoS" full="Quality of Service"/>
      <term abbr="RTCP" full="RTP Control Protocol"/>
      <term abbr="RTP" full="Real-Time Transport Protocol"/>
      
      <term abbr="SDES" full="Security Descriptions for Media Streams"/>
      <term abbr="SDP" full="Session Description Protocol"/>
      <term abbr="SIP" full="Session Initiation Protocol">
        A communications protocol defined by the Internet Engineering Task Force (IETF) that is used for creating, modifying, and terminating multimedia sessions with multiple participants.
      </term>
      <term abbr="SRTP" full="Secure Real-Time Transport Protocol">
        A protocol that is used to provide multimedia (voice/video) streaming services with added security of encryption, message authentication and integrity, and replay protection.
      </term>
      <term abbr="VVoIP" full="Voice/Video Over IP"/>
      
      

    </tech-terms>
    <sec:Compliant_Targets_of_Evaluation>
      This PP-Module specifically addresses SBCs that provide firewalling, interoperability, and security functions for VVoIP networks. 
      The SBC also provides protected communication between trusted components of the network infrastructure.
      <h:p/>
      The physical boundary of the SBC is defined by the operating system components storing or providing security functions and 
      all software supplied by the vendor, including vendor modified components to the operating system. 
      All the security functionality is contained and executed within the physical boundary of the device.
      <h:p/>
      While the functionality that the TOE is obligated to implement in response to the described threat environment is detailed in later sections, 
      a brief description is provided here. A compliant TOE will provide security functionality that addresses threats to itself. 
      It must also protect communications between itself and an Internet Protocol Public Branch Exchange (IP-PBX) 
      or another SBC by using a trusted channel. Some protocols required by this PP-Module make use of certificates; therefore, the SBC must securely store certificates and private keys. 
      <h:p/>
      Since this PP-Module builds on the NDcPP, conformant TOEs must implement the functionality required in the NDcPP along 
      with the additional functionality defined in this PP-Module in response to the threat environment discussed later in this document.
      
    </sec:Compliant_Targets_of_Evaluation>
      <sec:TOE_Boundary>
        An SBC is a security device composed of hardware and software connected to two or more distinct voice networks that provides security and interoperability functions. 
        SBCs are deployed between peering service provider networks, service provider networks and enterprise networks, 
        service provider networks and residential customers, or in some cases as a back-to-back user agent (B2BUA) that allows mobile users the ability to connect to their internal VVoIP network.
        <h:p/>
        The following diagram represents a typical deployment of the TOE and its operational environment (OE). 
        Note that the TOE boundary is limited to the physical boundary of the SBC device itself, and the trusted channels/paths that are established by the SBC.
        <h:p/> 
	     <h:p/>
        <figure entity="images/figure1.png" title="SBC Deployment Model" id="OperEnv"/>
        <h:p/>
      </sec:TOE_Boundary>
    
    
    <sec:Use_Cases>
      This PP-Module defines a single potential use case for the SBC TOE:
      <usecases>
        <usecase id="usecase-dedicated" title="Border Protection">
          <description>The TOE is a specialized network device that provides firewall services for VVoIP networks. 
            The TOE is intended to provide protection against well-known threats that target these networks. 
            The SBC examines headers and data values of packets and compares them to an Access Control List (ACL) to either permit or deny them to or through the SBC. 
            The SBC is typically deployed between service providers for security, interoperability, translation, and transcoding purposes; 
            between service providers and residential customers for security and interoperability purposes; or between service providers and enterprise networks for translation, transcoding, and security purposes. 
            The SBC, as a border element, should also be able to establish a secure communication channel with external devices it communicates with.</description>
        </usecase>

      </usecases> 
    </sec:Use_Cases> 
  </sec:Introduction>
  <sec:Conformance_Claims boilerplate="no">
    <CClaimsInfo cc-approach="direct-rationale" cc-version="cc-2022r1">
      <cc-st-conf>exact</cc-st-conf>
      <cc-pt2-conf>extended</cc-pt2-conf>
      <cc-pt3-conf>conformant</cc-pt3-conf>
      <cc-pp-conf/>
      <cc-pp-config-with/>
      <cc-pkg-claim>
        <FP-cc-ref conf="conformant">Functional Package for TLS, version 2.0</FP-cc-ref>
        <FP-cc-ref conf="conformant">Functional Package for X.509, version 1.0</FP-cc-ref>
      </cc-pkg-claim>
    </CClaimsInfo>
    <!-- <cclaims>
      <cclaim name="Conformance Statement">
        <description>
	  <h:p>
	    This PP-Module inherits exact conformance as required from the specified
            Base-PP and as defined in the CC and CEM addenda for Exact Conformance, Selection-Based
          SFRs, and Optional SFRs (dated May 2017).</h:p>
	  <h:p>
            No PPs or PP-Modules may be specified in a PP-Configuration with this PP-Module other than the Base-PP specified
	    in <xref to="Overview"/>.
	  </h:p>
        </description>
      </cclaim>
      <cclaim name="CC Conformance Claims">
        <description>This PP-Module is conformant to Parts 2 (extended) and 3 (conformant) of Common
          Criteria Version 3.1, Release 5 [CC]. </description>
      </cclaim>
      <cclaim name="Package Claims">
        <description>This PP-Module does not
          claim conformance to any packages.</description>
      </cclaim>
    </cclaims> -->
  </sec:Conformance_Claims>
  <sec:Security_Problem_Definition>
    The security problem is described in terms of the threats that the TOE is expected to address, assumptions about its Operational Environment, and any organizational security policies that the TOE is expected to enforce.
    <sec:Threats>
      The following threats that are defined in this PP-Module extend the threats that are defined by the Base-PP.
      <threats>
        <threat name="T.MALICIOUS_TRAFFIC">
          <description>An attacker may attempt to send malformed packets to the SBC to cause the network stack or services listening on TCP/UDP ports on the SBC or protected network to crash.</description>
          <consistency-rationale>
            The Base-PP does not define a threat for malicious traffic because all of its security-relevant external interfaces define the network device as the endpoint. 
            This PP-Module defines interfaces where the TOE is facilitating a connection between two external entities, 
            such that traffic between them will flow through the TOE as opposed to to and from the TOE. 
            This threat is consistent with the Base-PP because it is only applied to the interfaces defined in this PP-Module where it is relevant; it does not apply to the interfaces defined in the Base-PP.
          </consistency-rationale>
          <addressed-by>FAU_ARP_EXT.1</addressed-by>
          <rationale>
            Mitigates the threat by defining the ability to generate security violations that are transmitted to external entities.
          </rationale>
          <addressed-by>FAU_GEN.1/SBC</addressed-by>
          <rationale>
            Mitigates the threat by iterating a Base-PP requirement to define additional auditable events that are specific to SBC functionality.
          </rationale>
          <addressed-by>FAU_SAA.1</addressed-by>
          <rationale>
            Mitigates the threat by defining a set of rules to monitor auditable events for potential security violations. 
          </rationale>
          <addressed-by>FAU_SEL.1</addressed-by>
          <rationale>
            Mitigates the threat by allowing for some monitoring functions to be selectively enabled and disabled as needed so that the generation of lower-priority 
            audit records can be suppressed when it is not practical to generate those records for performance reasons.
          </rationale>
          <addressed-by>FTP_ITC.1/ARP</addressed-by>
          <rationale>
            Mitigates the threat by defining the trusted channel used to securely communicate potential security violations.
          </rationale>
        </threat>
        
        <threat name="T.NETWORK_ACCESS">
          <description>An attacker may send traffic through the TOE that enables them to access devices in the TOE’s OE without authorization.</description>
          <consistency-rationale>
            The Base-PP does not define a threat for access to network resources because all of its security-relevant external interfaces define the network device as the endpoint. 
            This PP-Module defines interfaces where the TOE is facilitating a connection between two external entities, 
            such that traffic between them will flow through the TOE as opposed to into and out of the TOE. 
            This threat is consistent with the Base-PP because it is only applied to the interfaces defined in this PP-Module where it is relevant; it does not apply to the interfaces defined in the Base-PP.
          </consistency-rationale>
          <addressed-by>FAU_ARP_EXT.1</addressed-by>
          <rationale>
            Mitigates the threat by defining the ability to generate security violations that are transmitted to external entities.
          </rationale>
          <addressed-by>FAU_GEN.1/SBC</addressed-by>
          <rationale>
            Mitigates the threat by iterating a Base-PP requirement to define additional auditable events that are specific to SBC functionality.
          </rationale>
          <addressed-by>FAU_SAA.1</addressed-by>
          <rationale>
            Mitigates the threat by defining a set of rules to monitor auditable events for potential security violations. 
          </rationale>
          <addressed-by>FAU_SEL.1</addressed-by>
          <rationale>
            Mitigates the threat by allowing for some monitoring functions to be selectively enabled and disabled as needed so that the generation of lower-priority 
            audit records can be suppressed when it is not practical to generate those records for performance reasons.
          </rationale>
          <addressed-by>FCS_SRTP_EXT.1</addressed-by>
          <rationale>
            Mitigates the threat by defining the TOE’s implementation of the SRTP protocol that is used to protect VVoIP endpoint communications.
          </rationale>
          <addressed-by>FDP_IFC.1</addressed-by>
          <rationale>
            Mitigates the threat by defining a B2BUA policy so that VVoIP endpoints are only connected to each other through the TOE as an intermediary.
          </rationale>
          <addressed-by>FDP_IFF.1</addressed-by>
          <rationale>
            Mitigates the threat by defining the specific rules that the B2BUA policy enforces.
          </rationale>
          <addressed-by>FFW_ACL_EXT.1</addressed-by>
          <rationale>
            Mitigates the threat by defining capabilities for traffic filtering of network packets.
          </rationale>
          <addressed-by>FFW_ACL_EXT.2</addressed-by>
          <rationale>
            Mitigates the threat by defining specific methods of stateful traffic inspection for specific protocols.
          </rationale>
          <addressed-by>FFW_DPI_EXT.1</addressed-by>
          <rationale>
            Mitigates the threat by defining the capability to perform DPI for certain network traffic.
          </rationale>
          <addressed-by>FFW_NAT_EXT.1</addressed-by>
          <rationale>
            Mitigates the threat by defining the use of NAT to obfuscate IP addresses of endpoint devices on the TOE’s internal network. 
          </rationale>
          <addressed-by>FIA_SIPT_EXT.1</addressed-by>
          <rationale>
            Mitigates the threat by defining secure behavior for SIP trunking.
          </rationale>
          <addressed-by>FIA_X509_EXT.1/Rev (refined from the <xref to="bibX509"/>)</addressed-by>
          <rationale>
            Mitigates the threat by defining requirements for the X.509 validation algorithm used by the TOE’s TLS implementation.
          </rationale>
          <addressed-by>FIA_X509_EXT.2 (refined from the <xref to="bibX509"/>)</addressed-by>
          <rationale>
            Mitigates the threat by defining requirements for the X.509 validation algorithm used by the TOE’s TLS implementation.
          </rationale>
          <addressed-by>FIA_X509_EXT.3 (refined from the <xref to="bibX509"/>)</addressed-by>
          <rationale>
            Mitigates the threat by defining a mechanism by which the TOE obtains the certificates it uses for TLS client and server connections.
          </rationale>
          <addressed-by>FMT_SMF.1/SBC</addressed-by>
          <rationale>
            Mitigates the threat by defining TSF management functions that require authorizations to use.
          </rationale>
          <addressed-by>FTP_ITC.1 (refined from Base-PP)</addressed-by>
          <rationale>
            Mitigates the threat by defining external interfaces that require protected communications as well as the trusted protocols used to protect those communications.
          </rationale>
          <addressed-by>FTP_ITC.1/ARP</addressed-by>
          <rationale>
            Mitigates the threat by defining how communications of potential security violations are protected.
          </rationale>
          <addressed-by>FTP_ITC.1/ESC</addressed-by>
          <rationale>
            Mitigates the threat by defining how communications with an external ESC are protected.
          </rationale>
          <addressed-by>FTP_ITC.1/VVoIP</addressed-by>
          <rationale>
            Mitigates the threat by defining how communications with an external VVoIP endpoint are protected.
          </rationale>
          <addressed-by>FTP_ITC.1/H323 (selection-based)</addressed-by>
          <rationale>
            Mitigates the threat by defining H.323 as a permitted method of protected communications for when a conformant TOE implements this logical interface.
          </rationale>
          
          
        </threat>
        
        
        <threat name="T.RESOURCE_EXHAUSTION">
          <description>An attacker may transmit network traffic to the TOE that causes it to be unable to perform its functions on legitimate network traffic.</description>
          <consistency-rationale>
            The threat of network traffic causing the TOE to be unable to perform its functions is similar to T.SECURITY_FUNCTIONALITY_FAILURE in the Base-PP 
            because the intent of the threat is to cause the TSF to fail. 
            The Base-PP does not define DoS protections because it does not define logical interfaces that are intended to process large volumes of network traffic. 
            This PP-Module extends the threat by defining a specific example of it that applies to an SBC device that has this functionality.
          </consistency-rationale>
          <addressed-by>FAU_ARP_EXT.1</addressed-by>
          <rationale>
            Mitigates the threat by defining the ability to generate security violations that are transmitted to external entities.
          </rationale>
          <addressed-by>FAU_GEN.1/SBC</addressed-by>
          <rationale>
            Mitigates the threat by iterating a Base-PP requirement to define additional auditable events that are specific to SBC functionality.
          </rationale>
          <addressed-by>FAU_SAA.1</addressed-by>
          <rationale>
            Mitigates the threat by defining a set of rules to monitor auditable events for potential security violations. 
          </rationale>
          <addressed-by>FAU_SEL.1</addressed-by>
          <rationale>
            Mitigates the threat by allowing for some monitoring functions to be selectively enabled and disabled as needed so that the generation of lower-priority 
            audit records can be suppressed when it is not practical to generate those records for performance reasons.
          </rationale>
          <addressed-by>FFW_ACL_EXT.1</addressed-by>
          <rationale>
           Mitigates the threat by defining capabilities for traffic filtering of network packets.
          </rationale>
          <addressed-by>FFW_ACL_EXT.2</addressed-by>
          <rationale>
           Mitigates the threat by defining specific methods of stateful traffic inspection for specific protocols.
          </rationale>
          <addressed-by>FFW_DPI_EXT.1</addressed-by>
          <rationale>
           Mitigates the threat by defining the capability to perform DPI for certain network traffic.
          </rationale>
          <addressed-by>FMT_SMF.1/SBC</addressed-by>
          <rationale>
            Mitigates the threat by defining TSF management functions that require authorizations to use.
          </rationale>
          <addressed-by>FRU_PRS_EXT.1</addressed-by>
          <rationale>
           Mitigates the threat by requiring the TSF to implement priority of service to ensure that low-priority traffic cannot cause a DoS.
          </rationale>
          <addressed-by>FRU_RSA.1</addressed-by>
          <rationale>
           Mitigates the threat by enforcing quotas for TSF resources to prevent DoS.
          </rationale>
          <addressed-by>FTP_ITC.1/ARP</addressed-by>
          <rationale>
            Mitigates the threat by defining the trusted channel used to securely communicate potential security violations.
          </rationale>
          
        </threat>
        
        
        <threat name="T.UNTRUSTED_COMMUNICATION_CHANNELS">
          <description>An attacker may acquire sensitive TOE or user data that is transmitted to or from the TOE because an untrusted communication channel causes a disclosure of data in transit.</description>
          <consistency-rationale>
            The threat of disclosure of data in transit is fundamentally the same as the NDcPP threat with the same name. This PP-Module extends the threat to apply to the external interfaces that are defined specifically in support of SBC functions.
          </consistency-rationale>
          <addressed-by>FCS_SRTP_EXT.1</addressed-by>
          <rationale>
            Mitigates the threat by defining the TOE’s implementation of the SRTP protocol that is used to protect VVoIP endpoint communications.
          </rationale>
          <addressed-by>FIA_SIPT_EXT.1</addressed-by>
          <rationale>
            Mitigates the threat by defining secure behavior for SIP trunking.
          </rationale>
          <addressed-by>FIA_X509_EXT.1/Rev (refined from the <xref to="bibX509"/>)</addressed-by>
          <rationale>
            Mitigates the threat by defining requirements for the X.509 validation algorithm used by the TOE’s TLS implementation.
          </rationale>
          <addressed-by>FIA_X509_EXT.2 (refined from the <xref to="bibX509"/>)</addressed-by>
          <rationale>
            Mitigates the threat by defining requirements for the X.509 validation algorithm used by the TOE’s TLS implementation.
          </rationale>
          <addressed-by>FIA_X509_EXT.3 (refined from the <xref to="bibX509"/>)</addressed-by>
          <rationale>
            Mitigates the threat by defining a mechanism by which the TOE obtains the certificates it uses for TLS client and server connections.
          </rationale>
          <addressed-by>FTP_ITC.1 (refined from Base-PP)</addressed-by>
          <rationale>
            Mitigates the threat by defining external interfaces that require protected communications as well as the trusted protocols used to protect those communications.
          </rationale>
          <addressed-by>FTP_ITC.1/ARP</addressed-by>
          <rationale>
            Mitigates the threat by defining how communications of potential security violations are protected.
          </rationale>
          <addressed-by>FTP_ITC.1/ESC</addressed-by>
          <rationale>
            Mitigates the threat by defining how communications with an external ESC are protected.
          </rationale>
          <addressed-by>FTP_ITC.1/VVoIP</addressed-by>
          <rationale>
            Mitigates the threat by defining how communications with an external VVoIP endpoint are protected.
          </rationale>
          <addressed-by>FTP_ITC.1/H323 (selection-based)</addressed-by>
          <rationale>
            Mitigates the threat by defining H.323 as a permitted method of protected communications for when a conformant TOE implements this logical interface.
          </rationale>
        </threat>
        
        
        <threat name="T.USER_DATA_REUSE">
          <description>User data may be inadvertently sent to a destination not intended by the original sender, causing an unauthorized disclosure of the data.</description>
          <consistency-rationale>
            The Base-PP does not define a threat of user data transmitted to the wrong destination because all of its security-relevant external interfaces define the network device as the endpoint. 
            This PP-Module defines interfaces where the TOE is facilitating a connection between two external entities, 
            such that traffic between them will flow through the TOE as opposed to to and from the TOE. 
            This threat is consistent with the Base-PP because it is only applied to the interfaces defined in this PP-Module where it is relevant; it does not apply to the interfaces defined in the Base-PP.
          </consistency-rationale>
          <addressed-by>FDP_IFC.1</addressed-by>
          <rationale>
           Mitigates the threat by defining a B2BUA policy that is used by the TOE to establish connections between VVoIP endpoints.
          </rationale>
          <addressed-by>FDP_IFF.1</addressed-by>
          <rationale>
           Mitigates the threat by defining the rules that the B2BUA policy enforces.
          </rationale>
          <addressed-by>FFW_NAT_EXT.1</addressed-by>
          <rationale>
           Mitigates the threat by requiring the use of NAT to maintain a unique relationship between how external entities identify entities on the TOE’s internal network and how they are actually addressed by that network.
          </rationale>
          <addressed-by>FIA_SIPT_EXT.1</addressed-by>
          <rationale>
           Mitigates the threat by defining the use of SIP trunking, which requires authentication of endpoints to ensure data is only transmitted to the intended endpoint.
          </rationale>
          <addressed-by>FIA_SIPS_EXT.1 (implementation-based)</addressed-by>
          <rationale>
           Mitigates the threat by defining an optional capability to handle SIP registration in cases where the OE does not include an ESC that will provide that functionality.  
          </rationale>
        </threat>
        
      </threats>
    </sec:Threats>
    <sec:Assumptions>
      All assumptions for the OE of the Base-PP also apply to this PP-Module. A.NO_THRU_TRAFFIC_PROTECTION is still operative, but only for the interfaces in the TOE that are defined by the Base-PP and not the PP-Module.
      <assumptions/>
    </sec:Assumptions>
    
    <sec:Organizational_Security_Policies>
      <!-- This PP-Module defines no additional organizational security policies beyond those specified in the NDcPP. -->
      <OSPs/>
    </sec:Organizational_Security_Policies>
  </sec:Security_Problem_Definition>
  <sec:Security_Objectives>    
    <sec:Security_Objectives_for_the_Operational_Environment>
      All objectives for the OE of the Base-PP also apply to this PP-Module. OE.NO_THRU_TRAFFIC_PROTECTION is still operative, but only for the interfaces in the TOE that are defined by the Base-PP and not the PP-Module.
    </sec:Security_Objectives_for_the_Operational_Environment>
    <sec:Security_Objectives_Rationale>
      <!-- NOTE: This section should remain empty and is populated from the rationale tags in the previous sections.  -->
    </sec:Security_Objectives_Rationale>
  </sec:Security_Objectives>
  <sec:Security_Requirements>
    <base-pp id="ND" version="3.0e" name="Network Device" product="Network Device" short="ND" plural="Network Devices">
      <url>https://www.niap-ccevs.org/protectionprofiles/482</url>
  	  <cPP/>
      <modified-sfrs>
        <!-- per open comment, it's unclear whether we need to treat any other NDcPP SFRs as 'modified' (most notably FIA_X509_EXT.1/Rev and FTP_ITC.1, or are those completely separate from what is needed for auth server) -->

        <section title="Cryptographic Support (FCS)" id="nd-mod-fcs">
          <base-sfr-spec cc-id="fcs_tlsc_ext.1" title="TLS Client Protocol without Mutual Authentication" id="nd-mod-fcs-tlsc-ext-1">
          <consistency-rationale>
              This PP-Module mandates the inclusion of this selection-based SFR because it is required to implement the trusted communications required by the PP-Module.
            </consistency-rationale>
            <description>This SFR is selection-based in the TLS Functional Package but is mandated by this PP-Module because Transport Layer Security (TLS) is used for SIP trunking. An SBC implements TLS as both a client and a server. 
            The SFR is unchanged from its original definition.</description>
            <no-change/>
            <set-status status="mandatory"/>
          </base-sfr-spec>
 
          <base-sfr-spec cc-id="fcs_tlsc_ext.2" title="TLS Client Support for Mutual Authentication" id="nd-mod-fcs-tlsc-ext-2">
            <consistency-rationale>
                This PP-Module mandates the inclusion of this optional SFR because it is required to implement the trusted communications required by the PP-Module.
            </consistency-rationale>
            <description>This SFR is selection-based in the TLS Functional Package but is mandated by this PP-Module because SIP trunking requires mutually-authenticated TLS. The SFR is unchanged from its original definition.</description>
            <no-change/>
            <set-status status="mandatory"/>
          </base-sfr-spec>
          <base-sfr-spec cc-id="fcs_tlss_ext.1" title="TLS Server Protocol without Mutual Authentication" id="nd-mod-fcs-tlss-ext-1">
            <consistency-rationale>
              This PP-Module mandates the inclusion of this selection-based SFR because it is required to implement the trusted communications required by the PP-Module.
            </consistency-rationale>
            <description>This SFR is selection-based in the TLS Functional Package but is mandated by this PP-Module because TLS is used for SIP trunking. An SBC implements TLS as both a client and a server. The SFR is unchanged from its original definition.</description>
            <no-change/>
            <set-status status="mandatory"/>
          </base-sfr-spec>
          
          <base-sfr-spec cc-id="fcs_tlss_ext.2" title="TLS Server Support for Mutual Authentication" id="nd-mod-fcs-tlss-ext-2">
            <consistency-rationale>
              This PP-Module mandates the inclusion of this optional SFR because it is required to implement the trusted communications required by the PP-Module.
            </consistency-rationale>
            <description>This SFR is selection-based in the TLS Functional Package but is mandated by this PP-Module because SIP trunking requires mutually-authenticated TLS. The SFR is unchanged from its original definition.</description>
            <no-change/>
            <set-status status="mandatory"/>
          </base-sfr-spec>
      
        </section>

        <section title="Identification and Authentication (FIA)" id="nd-mod-fia">
          <base-sfr-spec cc-id="fia_x509_ext.1" title="X.509 Certificate Validation" id="nd-mod-fia-x509-ext-1">
            <consistency-rationale>
              This PP-Module mandates the inclusion of this selection-based SFR because it is a dependency of the TLS requirements that it also mandates.
            </consistency-rationale>
            <description>This SFR is selection-based in the X.509 Functional Package but mandatory in this PP-Module because the TOE’s TLS implementation requires appropriate X.509 functionality. The SFR is unchanged from its original definition.</description>
            <no-change/>
            <set-status status="mandatory"/>
          </base-sfr-spec>

          <base-sfr-spec cc-id="fia_x509_ext.2" title="X.509 Certificate Authentication" id="nd-mod-fia-x509-ext-2">
            <consistency-rationale>
              This PP-Module mandates the inclusion of this selection-based SFR because it is a dependency of the TLS requirements that it also mandates.
            </consistency-rationale>
            <description>This SFR is selection-based in the X.509 Functional Package but mandatory in this PP-Module because the TOE’s TLS implementation requires appropriate X.509 functionality. The SFR is unchanged from its original definition.</description>
            <no-change/>
            <set-status status="mandatory"/>  
          </base-sfr-spec>
          
          <base-sfr-spec cc-id="fia_x509_ext.3" title="X.509 Certificate Requests" id="nd-mod-fia-x509-ext-3">
            <consistency-rationale>
              This PP-Module mandates the inclusion of this selection-based SFR because it is a dependency of the TLS requirements that it also mandates.
            </consistency-rationale>
            <description>This SFR is selection-based in the X.509 Functional Package but mandatory in this PP-Module because the TOE’s TLS implementation requires appropriate X.509 functionality. The SFR is unchanged from its original definition.</description>
            <no-change/>
            <set-status status="mandatory"/>
          </base-sfr-spec>          
        </section>
        <section title="Trusted Path/Channels (FTP)" id="nd-mod-ftp">
          <base-sfr-spec cc-id="ftp_itc.1" title="Inter-TSF Trusted Channel" id="nd-mod-ftp-itc-1">
            <consistency-rationale>
              This PP-Module refines the Base-PP SFR to mandate the use of one of the trusted protocols defined by the Base-PP.
            </consistency-rationale>
            <description>
            <h:p>This SFR has been modified to mandate the use of TLS for inter-TSF trusted channels in the TOE. Any element not mentioned in this section is unchanged from its original definition.</h:p>
            <h:p>The text of the requirement is replaced with:</h:p>
            <h:p><h:b>FTP_ITC.1.1: </h:b>The TSF shall be capable of using <h:b>TLS and [selection: </h:b><h:i>IPsec, SSH, DTLS, HTTPS, <h:b>no other protocol</h:b></h:i>] to 
            provide a trusted communication channel between itself and authorized IT entities supporting the following capabilities: audit server, 
            [<h:b>selection: </h:b><h:i>authentication server, [<h:b>assignment: </h:b>other capabilities], no other capabilities</h:i>] 
            that is logically distinct from other communication channels and provides assured identification of its end points and protection of 
            the channel data from modification or disclosure.</h:p>
            <h:p><h:b>FTP_ITC.1.2: </h:b>The TSF shall permit [<h:i>the TSF, the authorized IT entities</h:i>] to initiate communication via the trusted channel.</h:p>
            <h:p><h:b>Application Note: </h:b>TLS is mandated for SIP trunking as required by FIA_SIPT_EXT.1.</h:p>
            </description>
            <!-- NDcPP does not exist in XML yet so no change can be modeled -->
            <no-change/>
          </base-sfr-spec>
        </section>
        

      </modified-sfrs>
      <additional-sfrs/>
      <con-toe> 
        When this PP-Module is used to extend the NDcPP, the TOE type for the overall TOE is still a network device. The TOE boundary is simply extended to include SBC functionality that is provided by the network device.
      </con-toe>
      <con-sec-prob/>
      <con-obj/>
      <con-op-en/>

      

    </base-pp>
    <man-sfrs>

      <section title="Auditable Events for Mandatory SFRs">
        <audit-table table="mandatory" id="at-mandatory">
        </audit-table>
      </section>
      
      <sec:man_fau title="Security Audit (FAU)">
        <ext-comp-def title="Security Audit Automatic Response" fam-id="FAU_ARP_EXT">
          <fam-behavior>This family defines requirements for secure external transmission of detected security violations to the OE.  </fam-behavior> 
        </ext-comp-def>
        <f-component cc-id="fau_arp_ext.1" name="Security Audit Automatic Response"> 
          <consistency-rationale>
            This SFR applies to the generation of alerts when a given auditable event is detected, which is beyond the original scope of the Base-PP.
          </consistency-rationale>
          
          <comp-lev> defines the mechanism used by the TOE to securely transmit security alerts to the OE.  
          </comp-lev>
          <management>No specific management functions are identified.
          </management>
          <audit>There are no auditable events foreseen.
          </audit>
          <dependencies>FAU_SAA.1 Potential Violation Analysis<h:p/>
            FTP_ITC.1 Inter-TSF Trusted Channel
          </dependencies>
          
          <f-element>
            <title>
              The TSF shall be capable of using 
              <selectables>
                <selectable>TLS</selectable>
                <selectable>IPsec</selectable>
                <selectable>SSH</selectable>
                <selectable>HTTPS</selectable>
                <selectable>SNMPv3</selectable>
              </selectables> to transmit potential security violations to an external IT entity in the OE upon detection.
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall be capable of using <assignable>trusted channel defined in FTP_ITC.1</assignable> to transmit potential security violations to an external IT entity in the OE upon detection.
              </title>
            </ext-comp-def-title>
            <note role="application">
              The selected protocols must be reflected in FTP_ITC.1.
            </note>
            <aactivity>
              <TSS>The evaluator shall verify that the TSS describes the ability of the TOE to transmit potential security violations to an alert receiver in the operational environment. 
                <h:p/></TSS>
              <Guidance>The evaluator shall verify that the operational guidance provides instructions on how to configure the TOE 
                so that it is able to communicate potential security violations to an alert receiver in the operational environment using the selected protocols. 
                <h:p/></Guidance>
              <Tests>
                The evaluator shall deploy the TOE in an environment that contains an alert receiver in the operational environment. 
                The evaluator shall configure the TOE to communicate with an alert receiver in the manner that is specified by the operational guidance. 
                The evaluator shall deploy a packet capture tool that is capable of sniffing the traffic between the TOE and the alert receiver. 
                For each type of potential security violation that is defined by the ST, the evaluator shall cause that potential security violation to occur on the TOE, 
                including configuring the TOE to detect the behavior as a potential security violation if it is necessary to do so.
                <h:p/>
                Depending on what the TSF considers to be potential security violations, 
                it may be necessary for the evaluator to set up traffic generators, heat guns, or other equipment that is used to simulate potential security violations.
                <h:p/>
                After this is done, the evaluator shall observe via use of the packet capture tool and direct interaction with the alert receiver 
                that the TSF transmitted the potential security violation and that it correctly used the selected protocols.
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        
        
        <f-component cc-id="fau_gen.1" name="Audit Data Generation (Session Border Controller)" iteration="SBC">
          <consistency-rationale>
            This SFR is an iteration of a Base-PP requirement that defines additional auditable events for SBC functionality that the Base-PP could not be expected to cover.
          </consistency-rationale>
          <f-element>
            <title> The TSF shall be able to generate audit data of the following auditable
              events: <h:ol type="a">
                <h:li>Start-up and shutdown of the audit functions;</h:li>
                <h:li>All auditable events for the [<h:i>not specified</h:i>] level of audit;</h:li>
                <h:li>[<h:i>All administrative actions;</h:i></h:li>
                <h:li><h:i>Specifically defined auditable events listed in the Auditable Events for Mandatory SFRs table (<xref to="at-mandatory"/>)</h:i></h:li>
                <h:li><h:i><selectables>
                  <selectable>Auditable events listed in the Auditable Events for Implementation-Dependent SFRs table (<xref to="at-feat-based"/>)</selectable>
                  <selectable>Auditable events listed in the Auditable Events for Selection-Based SFRs table (<xref to="at-sel-based"/>)</selectable>
                  <selectable exclusive="yes">no other events</selectable>
                </selectables></h:i></h:li>
              </h:ol>].
            </title>
            <note role="application">
                The auditable events defined in the Auditable Events table are for the SFRs that are explicitly defined in this PP-Module. 
                For any SFRs that are included as part of the TOE based on the claimed Base-PP, it is expected that any applicable auditable events defined for those SFRs in the Base-PP are also claimed as part of the TSF.
                <h:p/>
                The Base-PP iteration of the SFR also requires “all administrative actions” to be audited. When the TOE includes this PP-Module, 
                it is expected that this will also include the administrative actions that support the PP-Module defined in FMT_SMF.1/SBC.
                <h:p/>
                If the ST includes any implementation-dependent or selection-based SFRs, the selection for "Auditable events listed in the Auditable Events for Implementation-Dependent SFRs table" or 
                "Auditable events listed in the Auditable Events for Selection-Based SFRs table" must be made, respectively. If no implementation-dependent or selection-based SFRs are included, "no other events" should be selected. 
                The auditing of each implementation-dependent or selection-based SFR is only required if that SFR is included in the ST.
                <h:p/>
                A CDR is expected to be generated at the start of a session, at the end of a session, and during a session at an interval or time period specified by the ST author.
            </note>
          </f-element>
          <f-element>
            <title>
              The TSF shall record within the audit data at least the following information: <h:ol type="a">
                <h:li>Date and time of the auditable event, type of event, subject identity (if applicable), and the outcome (success or failure) of the event;</h:li>
                <h:li>For each auditable event type, based on the auditable event definitions of the functional components included in the 
                  PP, PP-Module, functional package or ST, [<h:i>information specified in column three of the Auditable Events table in which the auditable event was defined</h:i>].</h:li>
              </h:ol>
            </title>
            <aactivity>
              <TSS>The evaluator shall examine the TSS to determine that it identifies the TOE’s auditable events. 
                If the TOE is distributed across multiple components, the evaluator shall also ensure that the TSS identifies the component that is responsible for each type of auditable event.
                <h:p/></TSS>
              <Guidance>The evaluator shall check the operational guidance and ensure that it lists all of the auditable events and provides a format for audit records. 
                Each audit record format type must be covered, along with a brief description of each field. 
                The evaluator shall check to make sure that every audit event type mandated by the PP-Module 
                and claimed in the ST is described, and that the description of the fields contains the 
                information required in FAU_GEN.1.2/SBC and the additional information specified in the Auditable Events table of the PP-Module.
                <h:p/>
                If the TOE’s default configuration does not include all required auditable events, 
                the evaluator shall check the operational guidance to ensure that it includes instructions on how to place the TOE into its evaluated configuration by ensuring that all required auditable events are generated.
                <h:p/></Guidance>
              <Tests>
                The evaluator shall test the TOE’s ability to correctly generate audit records by having the TOE generate audit records 
                in accordance with the EAs associated with the functional requirements in the PP-Module. 
                Additionally, the evaluator shall test that each administrative action applicable in the context of the PP-Module is auditable. 
                When verifying the test results, the evaluator shall ensure the audit records generated during testing match the format specified in the operational guidance, 
                and that the fields in each audit record have the proper entries. 
                <h:p/>
                Note that the testing here can be accomplished in conjunction with the testing of the security mechanisms directly. 
                For example, the testing that is performed to ensure that the operational guidance provided is correct will verify that AGD_OPE.1 is satisfied 
                and should address the invocation of the administrative actions that are needed to verify the audit records are generated as expected.
              </Tests>
            </aactivity>
        </f-element>
        <audit-event/> 
      </f-component>
        
        
        <f-component cc-id="fau_saa.1" name="Potential Violation Analysis"> 
          <consistency-rationale>
            This SFR applies to the detection of auditable events as potential security violations requiring the generation of alerts, which is beyond the original scope of the Base-PP.
          </consistency-rationale>
          
          <f-element>
            <title>
              The TSF shall be able to apply a set of rules in monitoring the audited events and based upon these rules indicate a potential violation of the enforcement of the SFRs.
            </title>
          </f-element>
          <f-element>
            <title>
              The TSF shall enforce the following rules for monitoring audited events: <h:ol type="a">
                <h:li>Accumulation or combination of <assignable>subset of defined auditable events</assignable> known to indicate a potential security violation; </h:li>
                <h:li><assignable>any other rules</assignable>.</h:li>
              </h:ol>
            </title>
          
          <note role="application">
            Examples of monitored audited events include authentication failures, self-test failures, or environmental failures (e.g. temperature violation).
            </note>
            <aactivity>
              <TSS>The evaluator shall verify that the TSS describes the conditions that will be flagged by the TSF as a potential security violation and whether these conditions are administratively configurable.
                <h:p/></TSS>
              <Guidance>If the conditions that are flagged by the TSF as a potential security violation are configurable, 
                the evaluator shall review the operational guidance to determine that it describes how an administrator can configure potential security violations.
                <h:p/></Guidance>
              <Tests>
                Testing for this SFR is completed in conjunction with FAU_ARP_EXT.1. This SFR is tested by causing each type of potential security violation defined by the TSF 
                and observing that they are correctly treated as such. 
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        
        
        <f-component cc-id="fau_sel.1" name="Selective Audit"> 
          <consistency-rationale>
            This SFR applies to the behavior of the audit function with respect to the auditable events defined in this PP-Module. It does not affect the audit functions that apply to the Base-PP.
          </consistency-rationale>
          
          <f-element>
            <title>
              The TSF shall be able to select the set of events to be audited from the set of all auditable events based on the following attributes: <h:ol type="a">
              <h:li>[<h:i>event type</h:i>]</h:li>
              <h:li><assignable>list of additional attributes that audit selectivity is based upon</assignable></h:li>
              </h:ol>
            </title>
         
            <note role="application">
              The auditable events associated with traffic filtering rules (see the FFW_ACL_EXT.2 and FFW_DPI_EXT.1 rows in <xref to="at-mandatory"/> above) 
              may generate a significant volume of traffic that make them impractical to generate on a persistent basis. 
              The TOE must have the ability to generate these records when necessary but this SFR exists to allow for the generation of those events to be suppressed when the TOE is in its evaluated configuration.
            </note>
            <aactivity>
              <TSS>The evaluator shall examine the TSS to verify that it identifies the auditable events that can be suppressed and the filters that can be applied to suppress them. 
                For example, if TOE has the ability to suppress the generation of events related to the application of rules, 
                the evaluator shall examine the TSS to determine whether this suppression is done globally, on a per-rule basis, etc.
                <h:p/></TSS>
              <Guidance>The evaluator shall examine the operational guidance to verify that it identifies the auditable events that can be suppressed and instructions for enabling and disabling the generation of these events.
                <h:p/></Guidance>
              <Tests>
                For each auditable event that can be disabled, the evaluator shall configure the TOE to enable all auditable events, 
                perform actions against the TOE that cause these events to be generated, and verify that the corresponding events are generated. 
                The evaluator shall then disable the generation of a specific type of event, repeat the activity, and verify that a corresponding event is not generated. 
                <h:p/>
                For cases where multiple event types can be suppressed in this manner, 
                or multiple mechanisms exist to selectively suppress events, 
                the evaluator shall repeat this test as many times as necessary to ensure that each mechanism is validated. 
                For example, if the suppression of audit records for application of traffic filtering rules can be configured globally, 
                on a per-rule basis, and on a per-subject basis, the evaluator shall ensure that all three mechanisms of suppression are tested individually.
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        
      </sec:man_fau>
     
     
      <sec:man_fcs title="Cryptographic Support (FCS)">
        
        <ext-comp-def title="Secure Real-Time Transport Protocol" fam-id="FCS_SRTP_EXT">
          <fam-behavior>This family defines requirements for the implementation of SRTP.</fam-behavior> 
        </ext-comp-def>
        <f-component cc-id="fcs_srtp_ext.1" name="Secure Real-Time Transport Protocol"> 
          <consistency-rationale>
            This SFR applies to the implementation of SRTP, which is a protocol that is not used for any Base-PP functionality.
          </consistency-rationale>
          
          <comp-lev> requires the TSF to implement SRTP in accordance with specified standards, and for some of this functionality to be configurable.
          </comp-lev>
          <management>The following actions could be considered for the management functions in FMT: <h:ul>
            <h:li>Configuration of ports and cryptography for signaling communications.</h:li>
          </h:ul>
          </management>
          <audit>There are no auditable events foreseen.
          </audit>
          <dependencies>FMT_SMR.1 Security Roles<h:p/>
            FTP_ITC.1 Inter-TSF Trusted Channel
          </dependencies>
          
          <f-element>
            <title>
              The TSF shall implement the Secure Real-Time Transport Protocol (SRTP) that complies with RFC 3711, 
              and use Security Descriptions for Media Streams (SDES) in compliance with RFC 4568 to provide key information for the SRTP connection. 
            </title>
          </f-element>
          <f-element>
            <title>
            The TSF shall implement SDES-SRTP supporting the following ciphersuites: [<h:i>AEAD_AES_256_GCM, in accordance with RFC 7714</h:i>].
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall implement SDES-SRTP supporting the following ciphersuites <assignable>list of supported ciphersuites and the standard in which they are defined</assignable>. 
              </title>
            </ext-comp-def-title>
          
          <note role="application">
            This requirement specifies that the SRTP session that will be used to carry the VVoIP traffic will be keyed according to an SDES dialog using one of the identified ciphersuites. 
            The ST author should select all ciphersuites that are supported.
            </note>
          </f-element>
          <f-element>
            <title>
              The TSF shall ensure the SRTP NULL algorithm <selectables>
                <selectable>is disabled</selectable>
                <selectable>can be disabled by a [<h:i>Security Administrator</h:i>]</selectable></selectables>.
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall ensure the SRTP NULL algorithm <selectables>
                  <selectable>is disabled</selectable>
                  <selectable>can be disabled by a <assignable>administrator role</assignable></selectable></selectables>.
              </title>
            </ext-comp-def-title>
          </f-element>
          <f-element>
            <title>
              The TSF shall allow the SRTP ports to be used for SRTP communications to be specified by a [<h:i>Security Administrator</h:i>].
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall allow the SRTP ports to be used for SRTP communications to be specified by a <assignable>administrator role</assignable>.  
              </title>
            </ext-comp-def-title>
          <aactivity>
            <TSS>The evaluator shall verify that the TSS describes the ability of the TOE to do the following: <h:ul>
              <h:li>Support the use of SRTP and the ciphersuites that are supported by the SRTP implementation.</h:li>
              <h:li>Disable the SRTP NULL algorithm automatically or provide the ability for it to be disabled by a Security Administrator.</h:li>
              <h:li>Provide the ability for a Security Administrator to specify the SRTP ports used for SRTP communications.</h:li>
            </h:ul>
                <h:p/></TSS>
            <Guidance>The evaluator shall verify that the TSS describes the ability of the TOE to do the following: <h:ul>
              <h:li>How to configure the ciphersuites used by SRTP.</h:li>
              <h:li>[conditional, if “can be disabled by a [Security Administrator]” is selected in FCS_SRTP_EXT.1.3] How to disable use of the SRTP NULL algorithm.</h:li>
              <h:li>How to specify the ports used for SRTP communications.</h:li>
            </h:ul>
                <h:p/></Guidance>
              <Tests>
                The evaluator shall perform the following tests:
                <testlist>
                <test> <h:ol>
                <h:li>If necessary, configure the TOE to use SRTP.</h:li> 
                <h:li>Deploy a packet capture tool that is capable of sniffing traffic on the network interface where SRTP traffic will be transmitted.</h:li> 
                <h:li>Establish an SRTP connection with the TOE and verify using packet captures and audit logs that SRTP communications are established and that encrypted traffic is transmitted over the SRTP channel.</h:li> 
                <h:li>Repeat this test for each ciphersuite supported for the SRTP implementation. </h:li>
                </h:ol>
                </test>
                
                <test> <h:ol>
                <h:li>Deploy a packet capture tool that is capable of sniffing traffic on the network interface where SRTP traffic will be transmitted.</h:li> 
                <h:li>[conditional, if “can be disabled by a [Security Administrator]” is selected in FCS_SRTP_EXT.1.3] Configure the TOE to disable use of the SRTP NULL algorithm.</h:li> 
                <h:li>Transmit SRTP NULL message to the TOE and observe that it is rejected.</h:li>
                </h:ol>
                </test>
                
                <test> <h:ol>
                  <h:li>Configure the TOE to use a specified port for SRTP traffic.</h:li> 
                  <h:li>Deploy a packet capture tool that is capable of sniffing traffic on the network interface where SRTP traffic will be transmitted.</h:li> 
                  <h:li>Transmit SRTP traffic to the TOE and observe that the traffic is transmitted over the specified port. </h:li>
                  <h:li>Configure the TOE to use a different port for SRTP traffic. </h:li>
                  <h:li>Transmit SRTP traffic to the TOE and observe that the traffic is transmitted over the newly-specified port.</h:li>
                </h:ol>
                </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        
     
      </sec:man_fcs>
      <sec:man_fdp title="User Data Protection (FDP)">
        
        <f-component cc-id="fdp_ifc.1" name="Subset Information Flow Control"> 
          <consistency-rationale>
            This SFR applies to the TOE’s implementation of a B2BUA policy, which applies to the TOE’s through-traffic interfaces and is therefore beyond the original scope of the Base-PP.
          </consistency-rationale>
          
          <f-element>
            <title>
              The TSF shall enforce the [<h:i>B2BUA policy</h:i>] on [<h:i>caller-callee pairs attempting to communicate through the TOE</h:i>].
            </title>

            <aactivity>
              <no-tests>The evaluation of this SFR is performed as part of FDP_IFF.1.</no-tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        
        <f-component cc-id="fdp_iff.1" name="Simple Security Attributes"> 
          <consistency-rationale>
            This SFR applies to the TOE’s implementation of a B2BUA policy, which applies to the TOE’s through-traffic interfaces and is therefore beyond the original scope of the Base-PP.
          </consistency-rationale>
          
          <f-element>
            <title>
              The TSF shall enforce the [<h:i>B2BUA policy</h:i>] based on the following types of subject and information security attributes: 
              <assignable>method by which the TSF identifies each endpoint for a call</assignable>. 
            </title>
          </f-element>
          <f-element>
            <title>
              The TSF shall permit an information flow between a controlled subject and controlled information via a controlled operation if the following rules hold: 
              [<h:i>when valid communication through the TOE is attempted, the TSF will establish a connection between itself and the caller; 
               the TSF will establish a second connection between itself and the callee; and the TSF will redirect all communications that it receives between the two endpoints out through the proper connection</h:i>]. 
            </title>
          </f-element>
          <f-element>
            <title>
              The TSF shall enforce the [<h:i>following configurable behavioral rules: 
              <selectables linebreak="yes"> 
                <selectable>Default-deny (allowlist) posture: If configured, the TSF will implicitly deny all information flows except for those explicitly authorized by the TSF</selectable> 
                <selectable>Default-allow (denylist) posture: If configured, the TSF will implicitly allow all information flows except for those explicitly denied by the TSF</selectable></selectables></h:i>]. 
            </title>
          </f-element>
          <f-element>
            <title>
              The TSF shall explicitly authorize an information flow based on the following rules: 
              [<h:i>if the TSF is operating in an allowlist posture, any calling parties that are present on the allowlist 
              (identifiable by calling number, source IP address, or communications protocols) are explicitly authorized</h:i>]. 
            </title>
          </f-element>
          <f-element>
            <title>
              The TSF shall explicitly deny an information flow based on the following rules: 
              [<h:i>if the TSF is operating in a denylist posture, 
                any calling parties that are present on the denylist (identifiable by calling number or source IP address, or communications protocols) are explicitly denied</h:i>].
            </title>
            <aactivity>
              <TSS>The evaluator shall review the TSS to verify that it describes the ability of the TOE to function as a B2BUA and that it provides the ability to operate in either an allowlist or a denylist posture.
                <h:p/></TSS>
              <Guidance>The evaluator shall review the operational guidance to verify that it provides instructions for 
                setting the TOE into either an allowlist or a denylist posture and for how to add or remove entries from the allowlist or denylist.
                <h:p/></Guidance>
              <Tests>
                The evaluator shall perform the following tests: 
                <testlist>
                  <test>Configure a custom ACL to deny a call originating from an IP address or subnet. 
                    Make a call from that IP address or subnet and verify the call cannot be completed. Verify calls from any other IP address or subnet will complete a call. 
                  <h:p/></test>
                  <test>Configure a custom ACL to only permit a call originating from an IP address or subnet. 
                    Make a call from that IP address or subnet and verify the call can be completed. Verify calls from another IP address or subnet cannot be completed.
                  <h:p/></test>
                  <test>Configure a custom ACL to deny a call destined for an IP address or subnet. 
                    Make a call to that IP address or subnet and verify the call cannot be completed. Verify calls to any other IP address or subnet will complete a call. 
                  <h:p/></test>
                  <test>Configure a custom ACL to only permit a call destined to an IP address or subnet. 
                    Make a call to that IP address or subnet and verify the call can be completed. Verify calls to any other IP address or subnet will not complete a call. 
                  <h:p/></test>
                  <test>Configure a custom ACL to deny a call using a certain signaling (e.g. SIP) or media (e.g. RTP) protocol. 
                    Make a call using that protocol and verify the call cannot be completed. 
                    If other signaling (e.g. H.323) or media (e.g. SRTP) protocols are supported, verify that they can be used to complete a call while this ACL is in effect. 
                  <h:p/></test>
                  <test>Configure a custom ACL to only permit a call using a certain signaling (e.g., SIP) or media (e.g., RTP) protocol. 
                    Make a call using that protocol and verify the call can be completed. 
                    If other signaling (e.g. H.323) or media (e.g. SRTP) protocols are supported, verify that they cannot be used to complete a call while this ACL is in effect. 
                  <h:p/></test>
                  <test>On the TOE, configure an allowlist of allowed callers by calling number and all other numbers to be blocked. 
                    Verify the configuration through the audit log. Call through the TOE from each one of the allowlisted numbers. 
                    Verify that each number can complete. Attempt a call through the TOE from other non-allowlisted numbers. Verify that the calls cannot complete. 
                  <h:p/></test>
                  <test>On the TOE, configure an allowlist of allowed callers by IP address and all other IP addresses to be blocked. 
                    Verify the configuration through the audit log. Call through the TOE from each one of the allowlisted IP addresses. 
                    Verify that each IP address can complete. Change the IP address of the endpoints; 
                    however, keep the calling number the same. Attempt a call through the TOE from new IP addresses. Verify that the calls cannot complete. 
                  <h:p/></test>
                  <test>On the TOE, configure a denylist of disallowed callers by calling number and all other numbers to be allowed. 
                    Verify the configuration through the audit log. Attempt to call through the TOE from each one of the denylisted numbers. 
                    Verify that each number cannot complete. Call through the TOE from other non-denylisted numbers. 
                    Verify that the calls can complete. 
                  <h:p/></test>
                  <test>On the TOE, configure a denylist of disallowed callers by IP address and all other IP addresses to be allowed. 
                    Verify the configuration through the audit log. Attempt to call through the TOE from each one of the denylisted IP addresses. 
                    Verify that each IP address cannot complete. Change the IP address of the endpoints; however, keep the calling number the same. 
                    Attempt a call through the TOE from new IP addresses. Verify that the calls can complete.
                  <h:p/></test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Any modifications to the B2BUA policy.</audit-event-descr>
            <audit-event-info>No additional information.</audit-event-info>
          </audit-event>
        </f-component>
      </sec:man_fdp>
      <sec:man_ffw title="Firewall (FFW)">
        <class-description>Firewall functionality involves selective processing of network traffic such that the traffic is routed or discarded based on some notion of whether the traffic is valid. 
          Requirements in this class define capabilities for these processing functions.
        </class-description>        
        <ext-comp-class class="Firewall (FFW)">
          <description/>
        </ext-comp-class>
        <ext-comp-def title="Traffic Filtering" fam-id="FFW_ACL_EXT">
          <fam-behavior>
            This family defines requirements for controlling traffic filtering, including the use of stateful traffic filtering on protocols and ports.</fam-behavior> 
        </ext-comp-def>
        <f-component cc-id="ffw_acl_ext.1" name="Real-Time Communications Traffic Filtering"> 
          <consistency-rationale>
            This SFR applies to traffic filtering, which applies to the TOE’s through-traffic interfaces and is therefore beyond the original scope of the Base-PP.
          </consistency-rationale>
          
          <comp-lev> requires the TSF to implement traffic filtering rules based on network protocol attributes.
          </comp-lev>
          <management>The following actions could be considered for the management functions in FMT: <h:ul>
            <h:li>Configuration of traffic filtering rules.</h:li>
          </h:ul>
          </management>
          <audit>The following actions should be auditable if FAU_GEN Security audit data generation is included in the PP/ST: <h:ul>
            <h:li>Application of traffic filtering rules.</h:li>
          </h:ul>
          </audit>
          <dependencies>None
          </dependencies>
          
          <f-element>
            <title>
              The TSF shall perform traffic filtering on network packets processed by the TOE. 
            </title>
            <aactivity level="element">
              <TSS>
                The evaluator shall verify that the TSS provides a description of the TOE’s initialization or startup process, 
                which clearly indicates where processing of network packets begins to take place, and provides a discussion that supports the assertion that packets cannot flow during this process.
                <h:p/>
                The evaluator shall verify that the TSS also includes a narrative that identifies the components 
                (e.g., an active entity such as a process or task) involved in processing the network packets and 
                describes the safeguards that would prevent packets flowing through the TOE without applying the ruleset in the event of a component failure. 
                This could include the failure of a component, such as a process being terminated, or a failure within a component, such as memory buffers being full to the point where they cannot process packets. 
                <h:p/>
              </TSS>
              <Guidance>
                The guidance documentation associated with this element is assessed in the subsequent test EAs.
                <h:p/>
              </Guidance>
              <Tests>
                The evaluator shall perform the following test:
                <h:p/>
                The evaluator shall attempt to get network traffic to flow through the TOE while the TOE is being initialized. 
                A steady flow of network packets that would otherwise be denied by the ruleset should be sourced and directed to a host. 
                The evaluator shall verify, using a packet sniffer, that none of the generated network traffic is permitted through the firewall during initialization.
                <h:p/>
                The evaluator shall attempt to get network traffic to flow through the TOE while the TOE is being initialized. 
                  A steady flow of network packets that would be permitted by the ruleset should be sourced and directed at a host. 
                  The evaluator shall verify, using a packet sniffer, that none of the generated network traffic is permitted through the TOE during initialization and is only permitted once initialization is complete.
                <h:p/>
              </Tests>
            </aactivity>
          </f-element>
          <f-element>
            <title>
              The TSF shall allow the definition of traffic filtering for real-time communications traffic using the following network protocol fields: 
              <h:ul>
                <h:li>IPv4 <h:ul>
                  <h:li>source address</h:li>
                  <h:li>destination address</h:li>
                  <h:li>transport layer protocol</h:li>
                </h:ul></h:li>
                
                <h:li>IPv6<h:ul>
                  <h:li>source address</h:li>
                  <h:li>destination address</h:li>
                  <h:li>transport layer protocol</h:li>
                </h:ul></h:li>
                
                <h:li>TCP <h:b>(for signaling channel)</h:b><h:ul>
                  <h:li>source port</h:li>
                  <h:li>destination port</h:li>
                </h:ul>
                </h:li>
                
                <h:li>UDP <h:b>(for signaling channel)</h:b><h:ul>
                  <h:li>source port</h:li>
                  <h:li>destination port</h:li>
                </h:ul>
                </h:li>
                
                <h:li>Distinct Interface <h:b>(physical versus virtual or trust zone, e.g., trusted versus untrusted)</h:b></h:li>
                
                <h:li>[<h:i>Application (Real-Time Communications Protocol) <h:ul>
                  <h:li>signaling protocols: <selectables><selectable>SIP</selectable><selectable id="filters_H323">H.323</selectable></selectables>]</h:li>
                </h:ul></h:i></h:li>
              </h:ul>
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall allow the definition of traffic filtering for real-time communications traffic using the following network protocol fields: 
                <h:ul>
                  <h:li>IPv4 <h:ul>
                    <h:li>source address</h:li>
                    <h:li>destination address</h:li>
                    <h:li>transport layer protocol</h:li>
                  </h:ul></h:li>
                  
                  <h:li>IPv6<h:ul>
                    <h:li>source address</h:li>
                    <h:li>destination address</h:li>
                    <h:li>transport layer protocol</h:li>
                  </h:ul></h:li>
                  
                  <h:li>TCP<h:ul>
                    <h:li>source port</h:li>
                    <h:li>destination port</h:li>
                  </h:ul>
                  </h:li>
                  
                  <h:li>UDP<h:ul>
                    <h:li>source port</h:li>
                    <h:li>destination port</h:li>
                  </h:ul>
                  </h:li>
                  
                  <h:li>Distinct Interface</h:li>
                  
                  <h:li><assignable>other protocols or protocol types</assignable></h:li>
                </h:ul>
              </title>
            </ext-comp-def-title>
          
          
            <note role="application">
              Real-time communications traffic can use multiple transport protocols and ports. 
              Therefore, traffic filtering rules should be defined using the network protocol fields above, and one type of traffic may require multiple rules to be applied.
              <h:p/>
              If “H.323” is selected in this requirement, the ST must include the selection-based SFR FTP_ITC.1/H323.
            </note>
            <aactivity level="element">
              <TSS>
                The evaluator shall verify that the TSS describes a packet filtering policy and the following attributes are identified as being configurable within traffic filtering rules for the associated protocols: <h:ul>
                <h:li>IPv4/IPv6 <h:ul>
                  <h:li>Source address (e.g., 10.0.0.1/16, 10.0.0.1, any)</h:li> 
                  <h:li>Destination Address (e.g., 10.0.0.1/16, 10.0.0.1, any)</h:li> 
                  <h:li>Transport Layer Protocol (e.g., TCP, UDP, TCP+UDP)</h:li>
                </h:ul></h:li> 
                <h:li>TCP/UDP (for signaling channel) <h:ul> 
                  <h:li>Source Port</h:li> 
                  <h:li>Destination Port</h:li>
                </h:ul>
                </h:li>
                <h:li>Distinct interface (physical or virtual or trust zone, e.g., trusted or untrusted)</h:li> 
                <h:li>Application (Real-Time Communications Protocol) <h:ul> 
                  <h:li>Signaling (whatever is claimed by the TSF; SIP, H.323, or both)</h:li>
                </h:ul>
                </h:li>
                </h:ul>
                The evaluator shall verify that each rule can identify the following actions: permit or drop with the option to log the operation. 
                The evaluator shall verify that the TSS identifies all interface types subject to the packet filtering policy 
                and explains how rules are associated with distinct network interfaces. 
               <h:p/> 
              </TSS>
              <Guidance>
                The evaluator shall verify that the guidance documentation identifies the following attributes as being configurable within traffic filtering rules for the associated protocols:<h:ul>
                  <h:li>IPv4/IPv6 <h:ul>
                    <h:li>Source address (e.g., 10.0.0.1/16, 10.0.0.1, any)</h:li> 
                    <h:li>Destination Address (e.g., 10.0.0.1/16, 10.0.0.1, any)</h:li> 
                    <h:li>Transport Layer Protocol (e.g., TCP, UDP, TCP+UDP)</h:li>
                  </h:ul></h:li> 
                  <h:li>TCP/UDP (for signaling channel) <h:ul> 
                    <h:li>Source Port</h:li> 
                    <h:li>Destination Port</h:li>
                  </h:ul>
                  </h:li>
                  <h:li>Distinct interface (physical/virtual or trust zone, e.g., trusted/untrusted)</h:li> 
                  <h:li>Application (Real-Time Communications Protocol) <h:ul> 
                    <h:li>Signaling (whatever is claimed by the TSF; SIP, H.323, or both)</h:li>
                  </h:ul>
                  </h:li>
                </h:ul>
                The evaluator shall verify that the guidance documentation indicates that each rule can identify the following actions: permit, drop, and log.
                <h:p/>
              </Guidance>
              <Tests>
                The evaluator shall perform the following tests: <testlist>
                <test id="stateful-rules-definition">The evaluator shall use the instructions in the guidance documentation to test 
                  that stateful packet filter firewall rules can be created that permit, drop, and log packets for each of the following attributes: 
                  <h:ul>
                    <h:li>IPv4/IPv6 <h:ul>
                      <h:li>Source address (e.g., 10.0.0.1/16, 10.0.0.1, any)</h:li> 
                      <h:li>Destination Address (e.g., 10.0.0.1/16, 10.0.0.1, any)</h:li> 
                      <h:li>Transport Layer Protocol (e.g., TCP, UDP, TCP+UDP)</h:li>
                    </h:ul></h:li> 
                    <h:li>TCP/UDP (for signaling channel) <h:ul> 
                      <h:li>Source Port</h:li> 
                      <h:li>Destination Port</h:li>
                    </h:ul>
                    </h:li>
                    <h:li>Distinct interface (physical/virtual or trust zone, e.g., trusted/untrusted)</h:li> 
                    <h:li>Application (Real-Time Communications Protocol) <h:ul> 
                      <h:li>Signaling (whatever is claimed by the TSF; SIP, H.323, or both)</h:li>
                    </h:ul>
                    </h:li>
                  </h:ul>
                <h:p/></test>
                <test>Repeat <xref to="stateful-rules-definition"/> above as needed to ensure that traffic filtering rules can be defined for each distinct network interface type supported by the TOE.
                </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <f-element>
            <title>
              The TSF shall allow the following operations to be associated with traffic filtering rules: permit or drop with the capability to log the operation <h:b>for each specific rule defined</h:b>.
            </title>
            <ext-comp-def-title>
              <title>
              The TSF shall allow the following operations to be associated with traffic filtering rules: permit or drop with the capability to log the operation.
            </title>
            </ext-comp-def-title>
            <note role="application">
              Whether or not logging is performed may be applied to individual rules or groups of rules on an independent basis. 
              For example, if there are six rules defined, the TOE should allow for any subset of these rules to be logged, independent of one another.  
            </note>
            <aactivity level="element">
              <no-tests>This element is evaluated through the evaluation activities for FFW_ACL_EXT.1.2.</no-tests>
            </aactivity>
          </f-element>
          <f-element>
            <title>
              The TSF shall allow the traffic filtering rules to be assigned to each distinct network interface.
            </title>
            <aactivity level="element">
              <no-tests>This element is evaluated through the evaluation activities for FFW_ACL_EXT.1.2.</no-tests>
            </aactivity>
          </f-element>
          <f-element>
            <title>
              The TSF shall: <h:ul>
              <h:li>Accept a network packet without further processing of traffic filtering rules if it matches an allowed established session for the following protocols: TCP, UDP, based on the following network packet attributes: <h:ul> 
                <h:li>TCP: source and destination addresses, source and destination ports, sequence number, flags</h:li> 
                <h:li>UDP: source and destination addresses, source and destination ports</h:li>
              </h:ul>
              </h:li>
              <h:li>Remove existing traffic flows from the set of established traffic flows based on the following: <selectables>
                <selectable>session inactivity timeout</selectable>
                <selectable>completion of the expected information flow</selectable></selectables>.</h:li>
              </h:ul>
            </title>
            <aactivity level="element">
              <TSS>
                The evaluator shall verify that the TSS identifies the protocols that support session handling to include both TCP and UDP.
                <h:p/>
                The evaluator shall verify that the TSS describes how sessions are established (including handshake processing) and maintained.
                <h:p/>
                The evaluator shall verify that for TCP, the TSS identifies and describes the use of the following attributes in determining the validity of a session: 
                source and destination addresses, source and destination ports, sequence number, and individual flags. 
                <h:p/>
                The evaluator shall verify that for UDP, the TSS identifies and describes the following attributes in determining the validity of a session: source and destination addresses and source and destination ports.
                <h:p/>
                The evaluator shall verify that the TSS describes how established sessions are removed. 
                The TSS shall describe how connections are removed for each protocol based on normal completion or timeout conditions. 
                The TSS shall also indicate when session removal becomes effective (e.g., before the next packet that might match the session is processed).  
                <h:p/>
              </TSS>
              <Guidance>
                The evaluator shall verify that the guidance documentation describes session behaviors. For example, a TOE might not log packets that are permitted as part of an existing session.
                <h:p/>
              </Guidance>
              <Tests>
                The evaluator shall perform the following tests: 
                <testlist>
                <test id="invalid-tcp-flags">The evaluator shall configure the TOE to permit and log TCP traffic. 
                  The evaluator shall initiate a TCP session. 
                  While the TCP session is being established, the evaluator shall introduce session establishment packets with incorrect flags 
                  to determine that the altered traffic is not accepted as part of the session 
                  (i.e., a log event is generated to show the ruleset was applied). 
                  After a TCP session is successfully established, the evaluator shall alter each of the attributes for determining the validity of a session 
                  (source and destination addresses, source and destination ports, sequence number, flags) 
                  one at a time in order to verify that the altered packets are not accepted as part of the established session.
                <h:p/></test>
                <test>The evaluator shall terminate the TCP session established per <xref to="invalid-tcp-flags"/> as described in the TSS. 
                  The evaluator shall then immediately send a packet matching the former session definition in order to ensure it is not forwarded through the TOE without being subject to the ruleset.
                <h:p/></test>
                  <test>The evaluator shall expire (i.e., reach timeout) the TCP session established per <xref to="invalid-tcp-flags"/> as described in the TSS. 
                  The evaluator shall then send a packet matching the former session in order to ensure it is not forwarded through the TOE without being subject to the ruleset.
                <h:p/></test>
                <test id="invalid-udp-flags">The evaluator shall configure the TOE to permit and log UDP traffic. 
                  The evaluator shall establish a UDP session. Once a UDP session is established, 
                  the evaluator shall alter each of the attributes for determining the validity of a session 
                  (source and destination addresses, source and destination ports) one at a time in order to verify that the altered packets are not accepted as part of the established session. 
                <h:p/></test>
                <test>The evaluator shall expire (i.e., reach timeout) the UDP session established per <xref to="invalid-udp-flags"/> as described in the TSS. 
                  The evaluator shall then send a packet matching the former session in order to ensure it is not forwarded through the TOE without being subject to the ruleset.
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <f-element>
            <title>
              The TSF shall process the applicable traffic filtering rules in an administratively defined order.
            </title>
            <aactivity level="element">
              <TSS>
                The evaluator shall verify that the TSS describes the algorithm applied to incoming packets, 
                including the processing of default rules, determination of whether a packet is part of an established session, 
                and application of administrator-defined and ordered ruleset. 
                <h:p/>
              </TSS>
              <Guidance>
                The evaluator shall verify that the guidance documentation describes how the order of traffic filtering rules is determined 
                and provides the necessary instructions so that an administrator can configure the order of rule processing.
                <h:p/>
              </Guidance>
              <Tests>
                The evaluator shall perform the following tests:
                <testlist>
                <test>The evaluator shall devise two equal stateful traffic filtering rules with alternate operations – permit and drop. The rules should then be deployed in two distinct orders and in each case the evaluator shall ensure that the first rule is enforced in both cases by generating applicable packets and using packet capture and logs for confirmation.
                <h:p/></test>
                <test>The evaluator shall repeat the procedure above, except that the two rules should be devised where one is a subset of the other (e.g., a specific address versus a network segment). Again, the evaluator should test both orders to ensure that the first is enforced regardless of the specificity of the rule.
                </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <f-element>
            <title>
              The TSF shall deny packet flow if a matching rule is not identified.
            </title>
          
            <aactivity level="element">
              <TSS>The evaluator shall verify that the TSS describes the process for applying traffic filtering rules and also that the behavior 
                (either by default, or as configured by the administrator) is to deny packets when there is no rule match 
                unless another required condition allows the network traffic (i.e., FFW_ACL_EXT.1.5). 
                <h:p/></TSS>
              <Guidance>The evaluator shall verify that the guidance documentation describes the behavior 
                if no rules or special conditions apply to the network traffic. 
                If the behavior is configurable, the evaluator shall verify that the guidance documentation provides the appropriate instructions to configure the behavior to deny packets with no matching rules.
                <h:p/></Guidance>
              <Tests>
                For each attribute in FFW_ACL_EXT.1.2, the evaluator shall construct a test to demonstrate that the TOE can correctly compare the attribute from the packet header to the ruleset, 
                and shall demonstrate both the permit and deny for each case. 
                The evaluator shall check the log in each case to confirm that the relevant rule was applied. 
                The evaluator shall record a packet capture for each test to demonstrate the correct TOE behavior.
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Application of traffic filtering rules.</audit-event-descr>
            <audit-event-info>Source and destination of observed traffic.</audit-event-info>
            <audit-event-info>Rule relevant to observed traffic.</audit-event-info>
            <audit-event-info>Result of rule evaluation.</audit-event-info>
          </audit-event>
        </f-component>
        
        
        
        <f-component cc-id="ffw_acl_ext.2" name="Stateful VVoIP Traffic Filtering"> 
          <consistency-rationale>
            This SFR applies to traffic filtering, which applies to the TOE’s through-traffic interfaces and is therefore beyond the original scope of the Base-PP.
          </consistency-rationale>
          
          <comp-lev> requires the TSF to perform stateful traffic filtering on traffic that matches certain unauthorized state conditions.
          </comp-lev>
          <management>No specific management functions are identified.
          </management>
          <audit>The following actions should be auditable if FAU_GEN Security audit data generation is included in the PP/ST: <h:ul>
            <h:li>Application of traffic filtering rules.</h:li>
          </h:ul>
          </audit>
          <dependencies>None
          </dependencies>
          
          <f-element>
            <title>
              The TSF shall perform stateful traffic filtering on the following VVoIP protocols: <selectables>
                <selectable>SIP</selectable>
                <selectable id="stateful_H323">H.323 (H.225, H.245)</selectable>
                <selectable>MGCP</selectable></selectables>.
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall perform stateful traffic filtering on the following VVoIP protocols:  <assignable>VVoIP protocols</assignable>.
              </title>
            </ext-comp-def-title>
            <note role="application">
              If “H.323” is selected in this requirement, the ST must include the selection-based SFR FTP_ITC.1/H323.
            </note>
          </f-element>

          <f-element>
            <title>The TSF shall enforce the following default stateful traffic filtering rules on all network traffic matching protocol types identified in FFW_ACL_EXT.2.1:<selectables linebreak="yes">
              <selectable>SIP traffic where a BYE message precedes an INVITE message</selectable>
              <selectable>H.225 traffic where an RCF reply precedes any other traffic</selectable>
              <selectable>H.245 traffic where a ResponseMessage precedes a RequestMessage</selectable>
              <selectable>MGCP traffic where a DLCX message precedes a CRCX message</selectable></selectables>.
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall enforce the following default stateful traffic filtering rules on all network traffic matching protocol types identified in FFW_ACL_EXT.2.1: <h:ul>
                  <h:li><assignable>default stateful traffic filtering rules</assignable></h:li>
                </h:ul>
              </title>
            </ext-comp-def-title>
            <note role="application">
              The stateful traffic filtering rules selected in FFW_ACL_EXT.2.2 must match the selections made for VVoIP protocols in FFW_ACL_EXT.2.1.
            </note>
          </f-element>
          <f-element>
            <title>
              The TSF shall terminate any connection found to be in violation of the default stateful traffic filtering rules and provide the ability to generate an audit record of the event.
            </title>
            <note role="application">
              Due to the potential for an SBC to receive large amounts of traffic that gets filtered by the default stateful traffic filtering rules, 
              this PP-Module only requires that the TSF have the ability to generate audit records for all events. 
              “Configure traffic filtering rules” in FMT_SMF.1/SBC provides an expectation that the administrator can determine which rules cause 
              audit records to be generated so that the environment is not producing an excessively large volume of audit data.
            </note>
          </f-element>
          <f-element>
            <title>
              The TSF shall dynamically open media ports to VVoIP protocol traffic upon negotiation of a session and close these ports upon termination of a session.
            </title>
          </f-element>
          <f-element>
            <title>The TSF shall not define a static range of ports to remain open indefinitely for the purpose of allowing VVoIP protocol traffic.</title>
          <aactivity>
            <TSS>The evaluator shall verify that the TSS describes the ability of the TOE to perform stateful traffic filtering of all VVoIP protocols specified in FFW_ACL_EXT.2.1. 
              The evaluator shall also verify that the TSS identifies the default stateful traffic filtering rules 
              that are enforced by the TSF and what actions are taken when traffic is found to be in violation of one more of these rules.
             <h:p/> 
              The evaluator shall verify that the TSS describes the ability of the TOE to dynamically open and close ports 
              to handle VVoIP traffic such that the ports used to carry VVoIP traffic are not predictable and ports are not open and listening for VVoIP traffic.
                <h:p/></TSS>
            <Guidance>If the TOE provides the ability to configure its stateful traffic filtering rules, the evaluator shall review the guidance documentation to verify that it provides instructions on how to do so.
                <h:p/></Guidance>
              <Tests>
                The evaluator shall perform the following tests:
                <testlist>
                  <test>[conditional, if “SIP” is selected in FFW_ACL_EXT.2.1 and “SIP traffic where a BYE message precedes an INVITE message” is selected in FFW_ACL_EXT.2.2] 
                    The evaluator shall connect a remote endpoint to the TOE and use it to transmit an out of sequence SIP request where a BYE message is sent before an INVITE request. The evaluator shall use packet captures and audit logs to verify that the out of sequence traffic was sent and that the call attempt was dropped and logged by the TOE.
                <h:p/></test>
                  <test>[conditional, if “H.323 (H.225, H.245)” is selected in FFW_ACL_EXT.2.1 and “H.225 traffic where an RFC reply precedes any other traffic” is selected in FFW_ACL_EXT.2.2]
                    The evaluator shall connect a remote endpoint to the TOE and use it to transmit an out of sequence H.225 request where an 
                    RCF reply is sent before any other traffic. The evaluator shall use packet captures and audit logs to verify that the out of sequence traffic was sent and that the call attempt was dropped and logged by the TOE.
                <h:p/></test>
                  <test>[conditional, if “H.323 (H.225, H.245)” is selected in FFW_ACL_EXT.2.1 and “H.245 traffic where a ResponseMessage precedes a RequestMessage” is selected in FFW_ACL_EXT.2.2]
                     The evaluator shall connect a remote endpoint to the TOE and use it to transmit an out of sequence H.245 request where a ResponseMessage is sent prior to a corresponding RequestMessage. 
                     The evaluator shall use packet captures and audit logs to verify that the out of sequence traffic was sent and that the call attempt was dropped and logged by the TOE.
                <h:p/></test>
                  <test>[conditional, if “MGCP” is selected in FFW_ACL_EXT.2.1 and “MGCP traffic where DLCX message precedes a CRCX message” is selected in FFW_ACL_EXT.2.2] 
                    The evaluator shall connect a remote endpoint to the TOE and use it to transmit an out of sequence MGCP request where a DLCX message is sent 
                    prior to a corresponding CRCX message. The evaluator shall use packet captures and audit logs to verify that the out of sequence traffic was sent and that the call attempt was dropped and logged by the TOE.
                <h:p/></test>
                  <test>The evaluator shall configure a custom ACL to deny a call originating from an IP address or subnet. 
                    The evaluator shall then make a call from that IP address or subnet and verify the call cannot be completed. 
                    The evaluator shall also verify that calls from any other IP address or subnet will complete a call.
                <h:p/></test>
                  <test>The evaluator shall complete a call and capture the packets. 
                    The evaluator shall examine the packet capture and take note of the ports the media channel (RTP, SRTP) is communicating over. 
                    The evaluator shall then terminate the call. Using a packet generator, 
                    the evaluator shall attempt to send traffic over the media ports that were active when the call was active. 
                    Using packet captures, the evaluator shall then verify that the traffic does not traverse the TOE on these ports.
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Application of traffic filtering rules.</audit-event-descr>
            <audit-event-info>Source and destination of observed traffic.</audit-event-info>
            <audit-event-info>Rule relevant to observed traffic.</audit-event-info>
            <audit-event-info>Result of rule evaluation.</audit-event-info>
          </audit-event>
        </f-component>
        
        
        
        <ext-comp-def title="Deep Packet Inspection" fam-id="FFW_DPI_EXT">
          <fam-behavior>This family defines requirements for implementation of DPI functionality.</fam-behavior> 
        </ext-comp-def>
        <f-component cc-id="ffw_dpi_ext.1" name="Deep Packet Inspection"> 
          <consistency-rationale>
            This SFR applies to DPI, which applies to the TOE’s through-traffic interfaces and is therefore beyond the original scope of the Base-PP.
          </consistency-rationale>
          
          <comp-lev> defines traffic that the TSF is expected to be able to perform DPI on, the specific elements of that traffic that is subject to DPI, and the action that is taken when invalid traffic is discovered by the DPI mechanism.
          </comp-lev>
          <management>No specific management functions are identified.
          </management>
          <audit>The following actions should be auditable if FAU_GEN Security audit data generation is included in the PP/ST: <h:ul>
            <h:li>Application of DPI rules.</h:li>
          </h:ul>
          </audit>
          <dependencies>None
          </dependencies>
          
          <f-element>
            <title>
              The TSF shall implement DPI for the following protocols: <selectables>
                <selectable id="dpi_H323">H.323 (H.225, H.245)</selectable>
                <selectable>SIP</selectable>
                <selectable>RTP</selectable>
                <selectable>RTCP</selectable></selectables>. 
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall implement DPI for the following protocols: <assignable>communications protocols</assignable>.
              </title>
            </ext-comp-def-title>
            <note role="application">If “H.323” is selected in this requirement, the ST must include the selection-based SFR FTP_ITC.1/H323.</note>
          </f-element>
          <f-element>
            <title>
              The TSF shall enforce the following rules for DPI: <assignable>for each protocol listed in FFW_DPI_EXT.1.1, 
              list elements of the packet data that are examined for potentially malicious content or compatibility with the protocol definition</assignable>. 
            </title>
          </f-element>
          <f-element>
            <title>
              When traffic is found to be in violation of a DPI rule, the TSF shall take the following action:
              <selectables>
                <selectable>drop the traffic</selectable>
                <selectable>generate an audit record</selectable>
                <selectable>generate an alarm</selectable></selectables>.
            </title>
            <ext-comp-def-title>
              <title>
                When traffic is found to be in violation of a DPI rule, the TSF shall take the following action:
                <assignable>action taken in response to rule violation</assignable>.
              </title>
            </ext-comp-def-title>
            <aactivity>
              <TSS>The evaluator shall examine the TSS to verify that it describes the ability of the TOE to perform deep packet inspection for any or all of 
                H.323, SIP, RTP, and RTP Control Protocol (RTCP) traffic (consistent with the ST’s SFR claim) 
                and the rules that the TSF enforces to determine whether the received traffic is well-formed. 
                The evaluator shall also verify that the TSS describes what actions the TOE performs when malformed traffic is detected.
                <h:p/></TSS>
              <Guidance>If the deep packet inspection function of the TSF is configurable, the evaluator shall verify that the guidance documentation provides instructions on how to configure this function.
                <h:p/></Guidance>
              <Tests>
                The evaluator shall repeat the following test for each protocol that the TOE is capable of performing deep packet inspection for:
                If the deep packet function is configurable, the evaluator shall configure this function to flag, log, or drop malformed traffic, 
                depending on the selections chosen in FFW_DPI_EXT.1.3. 
                The evaluator shall then transmit malformed traffic to the TOE. 
                Using packet captures and audit logs, the evaluator shall verify that the malformed traffic was sent to the TOE, 
                logged, and not transmitted any further. The evaluator shall repeat this test for each type of malformed traffic that can be detected by the TOE as described in FFW_DPI_EXT.1.2.
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Application of deep packet inspection rules.</audit-event-descr>
            <audit-event-info>Source and destination of observed traffic.</audit-event-info>
            <audit-event-info>Rule relevant to observed traffic.</audit-event-info>
            <audit-event-info>Result of rule evaluation.</audit-event-info>
          </audit-event>
        </f-component>
        
        
        <ext-comp-def title="Network Address Translation" fam-id="FFW_NAT_EXT">
          <fam-behavior>This family defines requirements for implementation of NAT.</fam-behavior> 
        </ext-comp-def>
        <f-component cc-id="ffw_nat_ext.1" name="Topology Hiding/NAT Traversal"> 
          <consistency-rationale>
            This SFR applies to NAT, which applies to the TOE’s through-traffic interfaces and is therefore beyond the original scope of the Base-PP.
          </consistency-rationale>
          
          <comp-lev> requires the TSF to implement NAT for defined network protocols.
          </comp-lev>
          <management>The following actions could be considered for the management functions in FMT: <h:ul>
            <h:li>Configuration of NAT.</h:li>
          </h:ul>
          </management>
          <audit>There are no auditable events foreseen.
          </audit>
          <dependencies>FDP_IFC.1 Subset Information Flow Control<h:p/>
            FMT_SMR.1 Security Roles
          </dependencies>
          
          <f-element>
            <title>
              The TSF shall support NAT of signaling and media channel traffic through the TOE that is mediated by the [<h:i>B2BUA policy</h:i>] defined by FDP_IFC.1.
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall support NAT of signaling and media channel traffic through the TOE that is mediated by the <assignable>information flow control policy</assignable> defined by FDP_IFC.1.
              </title>
            </ext-comp-def-title>
          </f-element>
          <f-element>
            <title>
              The TSF shall support NAT for the following protocols: <selectables>
                <selectable>SIP</selectable>
                <selectable>SIP-TLS</selectable>
                <selectable>H.225</selectable>
                <selectable>H.245</selectable></selectables>. 
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall support NAT for the following protocols: <assignable>list of protocols</assignable>.
              </title>
            </ext-comp-def-title>
          </f-element>
          <f-element>
            <title>
              The TSF shall use NAT to replace the IP address header value of traffic originating from the internal network with 
              <selectables>
                <selectable>the IP address of the TOE</selectable>
                <selectable>a [<h:i>Security Administrator</h:i>]-defined value</selectable></selectables>.
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall use NAT to replace the IP address header value of traffic originating from the internal network with 
                <selectables>
                  <selectable>the IP address of the TOE</selectable>
                  <selectable>a <assignable>administrator role</assignable>-defined value</selectable></selectables>.  
              </title>
            </ext-comp-def-title>
          </f-element>
          <f-element>
            <title>
              The TSF shall maintain a NAT table to ensure that traffic bound for the internal network is directed to only the intended recipient.
            </title>
            <aactivity>
              <TSS>The evaluator shall review the TSS to verify that it describes the ability of the TOE to support NAT for the protocols specified in FFW_NAT_EXT.1.2. 
                The evaluator shall also verify that the TSS describes how the TSF uses NAT to replace the IP address header value of outbound traffic 
                and how the TOE keeps track of the original identities of calling parties.
                <h:p/></TSS>
              <Guidance>If the ST author selected “a Security Administrator-defined value” in FFW_NAT_EXT.1.3, the evaluator shall verify that the guidance documentation provides instructions on how to define the IP address header value
                <h:p/></Guidance>
              <Tests>
                The evaluator shall place a call originating from the internal network to the external network. 
                The evaluator shall use packet captures on the external network to verify that the data in the packets do not disclose the internal network’s addressing or naming structure.
                <h:p/>
                If the ST author selected “a Security Administrator-defined value” in FFW_NAT_EXT.1.3, 
                the evaluator shall specify a given IP header value and verify that the traffic replaces the original header value with the administrator-defined value. 
                If the ST author instead selected “the IP address of the TOE,” the evaluator shall verify that this header value is the IP address of the TOE’s interface to the “external” network.
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        
        
        
      </sec:man_ffw>
      
      <sec:man_fia title="Identification and Authentication (FIA)">
        
        <ext-comp-def title="Session Initiation Protocol Trunking" fam-id="FIA_SIPT_EXT">
          <fam-behavior>This family defines requirements for SIP validation, authentication, and traffic encryption. </fam-behavior> 
        </ext-comp-def>
        <f-component cc-id="fia_sipt_ext.1" name="Session Initiation Protocol Trunking"> 
          <consistency-rationale>
            This SFR applies to SIP trunking, which is a logical interface that is beyond the original scope of the Base-PP.
          </consistency-rationale>
          
          <comp-lev> requires the TSF to implement SIP trunking using defined authentication and encryption methods.
          </comp-lev>
          <management>The following actions could be considered for the management functions in FMT: <h:ul>
            <h:li>Configuration of SIP communications.</h:li>
          </h:ul>
          </management>
          <audit>The following actions should be auditable if FAU_GEN Security audit data generation is included in the PP/ST: <h:ul>
            <h:li>All SIP trunk authentication attempts.</h:li>
          </h:ul>
          </audit>
          <dependencies>FCS_TLSC_EXT.1 TLS Client Protocol without Mutual Authentication<h:p/> 
            FCS_TLSC_EXT.2 TLS Client Support for Mutual Authentication<h:p/>
            FCS_TLSS_EXT.1 TLS Server Protocol without Mutual Authentication<h:p/>
            FCS_TLSC_EXT.2 TLS Server Support for Mutual Authentication<h:p/>
            FTP_ITC.1 Inter-TSF Trusted Channel 
          </dependencies>
          
          <f-element>
            <title>
          The TSF shall provide support for SIP trunking.
            </title>
          </f-element>
          <f-element>
            <title>
              The TSF shall require a service provider to provide valid identification in the form of a 
              <selectables>
                <selectable>username and password</selectable>
                <selectable>X.509 certificate</selectable></selectables> and IP address in order to establish a SIP trunk.
            </title>
          </f-element>
          <f-element>
            <title>The TSF shall require a service provider to provide a valid authentication credential in order to establish a SIP trunk.</title>
          </f-element>
          <f-element>
            <title>The TSF shall require a service provider to encrypt traffic using TLS in order to establish a SIP trunk.</title>
          <aactivity>
            <TSS>The evaluator shall verify that the TSS describes the ability of the TOE to support authenticated and encrypted SIP trunking along with the method by which the trunk peer will authenticate to the TOE.
                <h:p/></TSS>
            <Guidance>The evaluator shall verify that the guidance documentation provides instructions on how to configure SIP trunking to require encryption and authentication if this function is configurable.
                <h:p/></Guidance>
              <Tests>
                The evaluator shall perform the following tests:
                <testlist>
                <test id="valid-trunk">Configure the TOE to support an encrypted SIP trunk. Configure a trunk peer to communicate with the TOE using the SIP trunk. 
                  Present a correct username and password combination or valid X.509 certificate on the trunk peer with a SIP trunk request that 
                  originates from an expected IP address. Verify via packet capture and audit log that the session was established.
                  <h:p/></test>
                <test>Repeat <xref to="valid-trunk"/> but provide incorrect username and password information or invalid 
                  X.509 certificate with the trunk peer and verify via packet capture and audit log that the session was not established.
                  <h:p/></test>
                  <test>Repeat <xref to="valid-trunk"/> but change the IP address of the trunk peer and verify via packet capture and audit log that the session was not established.
                </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>All SIP trunk authentication attempts.</audit-event-descr>
            <audit-event-info>Username and IP address of the service provider.</audit-event-info>
          </audit-event>
        </f-component>
          
    
  
      </sec:man_fia>
      
      <sec:man_fmt title="Security Management (FMT)">
        <f-component name="Specification of Management Functions (SBC)" id="fel-managementfun-as" cc-id="fmt_smf.1" iteration="SBC">
          <consistency-rationale>
            This SFR is an iteration of a Base-PP requirement that defines additional management functions for SBC functionality that the Base-PP could not be expected to cover.
          </consistency-rationale>
          <f-element>
            <title>The TSF shall be capable of performing the following management functions <h:b>related to SBC functionality</h:b>: [<h:i>Ability of a Security Administrator to:
              <h:ul>
                <h:li>Change a user's password</h:li>
                <h:li>Require a user's password to be changed upon next login</h:li>
                <h:li>Configure the auditable events that will result in the generation of an alarm</h:li>
                <h:li>Configure the B2BUA policy</h:li>
                <h:li>Configure traffic filtering rules</h:li>
                <h:li>Configure auditable events</h:li>
                <h:li>Configure NAT</h:li>
                <h:li>Configure ports and cryptography for signaling and media communications</h:li>
                <h:li>Configure SIP communications</h:li>
              </h:ul></h:i>].
            </title>
            <note role="Application">
              This SFR defines additional management functions for the TOE beyond what is defined in the Base-PP as FMT_SMF.1. 
              The TOE may have all management functionality implemented in the same logical interface; 
              it is not necessary for “network device management” and “SBC management” to be implemented in separate interfaces.
              <h:p/>
              This PP-Module may rely on management functionality defined in the Base-PP to support the implementation of its functions. 
              For example, the SBC portion of the TOE relies on the reliable time function that must be implemented by the Base-PP portion of the TOE. 
              If the Base-PP implements this using NTP, the “Ability to set the time which is used for time-stamps” or “Ability to configure NTP” 
              management function defined in FMT_SMF.1 in the Base-PP can be used to address this PP-Module’s dependency on reliable system time.
              Note that support for NTP is recommended but not required.
              <h:p/>
              The 'configurable auditable events' function relates to FAU_SEL.1, specifically with respect to allowing a Security Administrator 
              to determine whether a given event is auditable. As this refers to the events for the triggering of various filtering rules, 
              it may be implicitly addressed through the ‘configure traffic filtering rules’ function, 
              for example by explicitly defining a rule with a type that automatically requires it to be logged or a parameter that causes it to be logged if triggered.
            </note>
            <aactivity>
              <TSS>
                The evaluator shall examine the TSS to determine that, for each administrative function listed in the SFR, 
                the ability to execute the function and the logical interfaces used to perform the function is claimed. 
                For each of these functions, the evaluator shall also confirm that the TSS details how the ability to manipulate the TSF data through these interfaces is disallowed for non-administrative users.
                <h:p/>
              </TSS>
              <Guidance> 
                The evaluator shall review the guidance documentation to determine that each of the functions detailed in the TSS are identified, 
                and that configuration information is provided to ensure that only administrators have access to the functions.
                <h:p/>
              </Guidance>
              <Tests>
                For each management function specified in FMT_SMF.1.1/SBC, the evaluator shall access the TOE with appropriate authorizations, 
                perform the required function, and demonstrate that configuration of the function results in the proper expected behavior. 
                For behavior related to SBC functionality (as opposed to manipulation of user accounts), this may be tested in conjunction with other SFRs.
                <h:p/>
                The evaluator shall also ensure that all relevant management functionality from FMT_SMF.1 in the Base-PP that relates to the SBC PP-Module are tested in conjunction with SBC functionality. 
                For example, for SBC functions that rely on time services, 
                the evaluator shall ensure that a Security Administrator can either manually configure the time or specify NTP server connectivity and ensure that the SBC functions will make use of the configured time data.
                <h:p/>
                The evaluator shall also demonstrate that a user who lacks privileges to execute these functions (as described in the operational guidance) are unable to execute them.
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>All management actions.</audit-event-descr>
            <audit-event-info>Identifier of initiator.</audit-event-info>
          </audit-event>
		    </f-component>
        </sec:man_fmt>
      
      <sec:man_fru title="Resource Utilization (FRU)">
        
        <ext-comp-def title="Limited Priority of Service" fam-id="FRU_PRS_EXT">
          <fam-behavior>This family defines requirements for prioritizing communication packets and bandwidth.</fam-behavior> 
        </ext-comp-def>
        <f-component cc-id="fru_prs_ext.1" name="Limited Priority of Service"> 
          <consistency-rationale>
            This SFR applies to enforcement of bandwidth priority of service, which is a mechanism that is beyond the scope of the Base-PP and does not interfere with the ability of the Base-PP to process valid network traffic securely.
          </consistency-rationale>
          
          <comp-lev> requires the TSF to implement mechanisms to limit the amount of network bandwidth that is available to subjects based on certain attributes.
          </comp-lev>
          <management>No specific management functions are identified.
          </management>
          <audit>There are no auditable events foreseen.
          </audit>
          <dependencies>None
          </dependencies>
          
          <f-element>
            <title>
              The TSF shall assign a priority to each type of communications packet that traverses the TSF.
            </title>
          </f-element>
          <f-element>
            <title>
              The TSF shall ensure that each access to network bandwidth shall be mediated on the basis of the subject’s assigned priority.
            </title>
            <aactivity>
              <TSS>The evaluator shall verify that the TSS describes the ability of the TOE to prioritize traffic flows as well as the mechanism by which access to network bandwidth is granted by the TSF.
                <h:p/></TSS>
              <Guidance>The evaluator shall examine the guidance documentation for a description of how to configure Quality of Service (QoS) for the TOE, including how to set tags for given traffic flows.
                <h:p/></Guidance>
              <Tests>
                The evaluator shall perform the following tests:
                <testlist>
                <test>Configure the TOE to support QoS. Set QoS tags for media and signaling traffic flows. Complete a call between calling parties that are connected to the TOE via two different external interfaces.
                Verify, using packet captures, that traffic between the TOE and the callee is tagged with appropriate QoS markings.
                <h:p/></test>
                <test>Configure the TOE to support QoS. Set QoS tags for media and signaling traffic flows. Configure one remote endpoint to act as a calling party that sends a continuous stream of VVoIP traffic 
                  (media and signaling) to another endpoint that is connected to the TOE via a different external interface.  
                  Using a tool of choice, create a data stream of non-VVoIP (no media and no signaling) traffic that ingresses one interface, 
                  passes through the TOE, and egresses on the TOE. These shall be the same interfaces used by the VVoIP traffic. 
                  Verify using packet captures that traffic between the TOE and the callee is tagged with appropriate QoS markings, and that
                  VVoIP and non-VVoIP traffic packets are passed through the TOE.  
                  Change the TOE QoS configuration to rate-limit, or police, non-VVoIP traffic. 
                  Verify either using packet captures that VVoIP traffic passes through the TOE while non-VVoIP traffic is rate-limited 
                  (egress packets are less than ingress traffic) OR that Rating Factor (R-Factor) or Mean Opinion Score (MOS) values signal mediation.
                </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        
        <f-component cc-id="fru_rsa.1" name="Maximum Quotas"> 
          <consistency-rationale>
            This SFR applies to enforcement of resource quotas, which is a mechanism that is beyond the scope of the Base-PP and does not interfere with the ability of the Base-PP to process valid network traffic securely.
          </consistency-rationale>

          <f-element>
            <title>
              The TSF shall enforce maximum quotas of the following resources: [<h:i>CPU, memory, <assignable>other resources</assignable></h:i>], 
              that [<h:i>subjects</h:i>] can use <selectables>
                <selectable>simultaneously</selectable>
                <selectable>over a specified period of time</selectable></selectables>. 
            </title>
            <note role="application">
              The intent of this SFR is for the TOE to be resistant to DoS attacks.
            </note>
            <aactivity>
              <TSS>The evaluator shall verify that the TSS describes the internal resources that the TSF can protect from DoS attacks as well as the types of behavior that would constitute a DoS attack against each of these resources.
                <h:p/></TSS>
              <Guidance>If the ability to protect against DoS attacks is configurable, the evaluator shall verify that the operational guidance provides instructions on how to configure this function.
                <h:p/></Guidance>
              <Tests>
                The evaluator shall perform the following tests:
                <testlist>
                <test>Using a tool of choice, attempt a DoS attack that creates excess CPU cycles. Place a call while this attack occurs. Verify through packet capture and audio file or screenshot that the call was successful.
                  <h:p/></test>
                <test>Using a tool of choice, attempt a DoS attack that attempts to exhaust the TOE’s memory. Place a call while this attack occurs. Verify through packet capture and audio file or screenshot that the call was successful.
                  <h:p/></test>
                <test>Using a tool of choice, perform protocol fuzzing for each communications protocol supported by the TOE. Verify that fuzzing does not cause the TOE to be compromised or to experience degraded functionality.
                For each tool of choice used to perform these tests, the evaluator shall provide justification for the appropriateness of the chosen tool.
                </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        
        
      </sec:man_fru>
 
      
	  <sec:man_ftp title="Trusted Path/Channels (FTP)">
	    
	      <f-component cc-id="ftp_itc.1" name="Inter-TSF Trusted Channel (Automatic Response)" iteration="ARP"> 
	        <consistency-rationale>
	          This SFR is used to specify the trusted channel used for transmission of alerts as specified in FAU_ARP_EXT.1.
	        </consistency-rationale>
	        <f-element>
	          <title>
	            The TSF shall <h:b>be capable of using  
	              <selectables>
	                <selectable>TLS</selectable>
	                <selectable>IPsec</selectable>
	                <selectable>SSH</selectable>
	                <selectable>DTLS</selectable>
	                <selectable>HTTPS</selectable>
	                <selectable>SNMPv3</selectable>
	              </selectables>
	              to</h:b> provide a trusted communication channel between itself and 
	            <h:b>authorized IT entities supporting the following capabilities: security audit automatic response</h:b> 
	            that is logically distinct from other communication channels and provides assured identification of its end points and protection of the channel data from modification or disclosure. 
	          </title>
	        </f-element>
	        <f-element>
	          <title>
	            The TSF shall permit [<h:i>the TSF</h:i>] to initiate communication via the trusted channel.
	          </title>
	        </f-element>
	        <f-element>
	          <title>
	            The TSF shall initiate communication via the trusted channel for [<h:i>transmission of potential security violations</h:i>].
	          </title>
	          <note role="application">
	            This SFR is used to specify any trusted protocols that are implemented in support of FAU_ARP_EXT.1.
	          </note>
	          <aactivity>
	            <no-tests>The evaluator shall evaluate this SFR in the manner specified for FTP_ITC.1 in the NDcPP except that SNMPv3 communications shall be tested (if claimed) in addition to any other selected protocols. 
	              Testing for SNMPv3 is performed through evaluation of FAU_ARP_EXT.1 if claimed there.</no-tests>
	          </aactivity>
	        </f-element>
          <audit-event>
            <audit-event-descr>Initiation of the trusted channel.</audit-event-descr>
            <audit-event-info>Identification of the initiator and target of the trusted channel.</audit-event-info>
          </audit-event>
          <audit-event>
            <audit-event-descr>Termination of the trusted channel.</audit-event-descr>
            <audit-event-info>Identification of the initiator and target of the trusted channel.</audit-event-info>
          </audit-event>
          <audit-event>
            <audit-event-descr>Failure of the trusted channel functions.</audit-event-descr>
            <audit-event-info>Identification of the initiator and target of the trusted channel.</audit-event-info>
          </audit-event>
	      </f-component>
	    
	    
		  <f-component cc-id="ftp_itc.1" name="Inter-TSF Trusted Channel (ESC Communications)" iteration="ESC">
		  <consistency-rationale>
		    This PP-Module iterates an SFR defined in the Base-PP to define a new external interface for communications with an ESC. 
		    This does not interfere with the ability of the Base-PP to enforce its security functionality on the existing logical interfaces.
			  </consistency-rationale>
			  <f-element>
			  <title>
			    The TSF shall provide a <h:b>signaling</h:b> channel between itself and <h:b>an ESC using TLS as specified in FCS_TLSC_EXT.1 and FCS_TLSC_EXT.2 and <selectables>
			      <selectable>DTLS as specified in FCS_DTLSC_EXT.1 and FCS_DTLSC_EXT.2</selectable>
			      <selectable>no other protocol</selectable></selectables></h:b> that is logically distinct from other communication channels 
			    and provides assured identification of its end points and protection of the channel data from modification or disclosure.
				  </title>
			    <note role="Application">
			      FCS_TLSC_EXT.1, FCS_TLSC_EXT.2, FCS_DTLSC_EXT.1, and FCS_DTLSC_EXT.2 are defined in the <xref to="pkgTLS"/>.
			    </note>
				</f-element>
			    <f-element>
		<title>
		  The TSF shall permit [<h:i>the TSF</h:i>] to initiate communication via the trusted channel.
		</title>
	</f-element>
			  <f-element>
			    <title>The TSF shall initiate communication via the trusted channel for [<h:i>all communications with the ESC</h:i>]. 
			    </title>
			      
			    <aactivity>
			      <no-tests>
			        This SFR is an iteration of FTP_ITC.1 as defined in the NDcPP. The evaluator shall repeat the EAs defined for FTP_ITC.1 in the NDcPP for this iteration of the SFR.
			      </no-tests>
			    </aactivity>  
			  </f-element>
        <audit-event>
            <audit-event-descr>Initiation of the trusted channel.</audit-event-descr>
            <audit-event-info>Identification of the initiator and target of the trusted channel.</audit-event-info>
          </audit-event>
          <audit-event>
            <audit-event-descr>Termination of the trusted channel.</audit-event-descr>
            <audit-event-info>Identification of the initiator and target of the trusted channel.</audit-event-info>
          </audit-event>
          <audit-event>
            <audit-event-descr>Failure of the trusted channel functions.</audit-event-descr>
            <audit-event-info>Identification of the initiator and target of the trusted channel.</audit-event-info>
          </audit-event>
		  </f-component>
	    
	    
	    <f-component cc-id="ftp_itc.1" name="Inter-TSF Trusted Channel (VVoIP Communications)" iteration="VVoIP">
	      <consistency-rationale>
	        This PP-Module iterates an SFR defined in the Base-PP to define a new external interface for communications with a VVoIP endpoint. 
	        This does not interfere with the ability of the Base-PP to enforce its security functionality on the existing logical interfaces.
	      </consistency-rationale>
	      <f-element>
	        <title>
	          The TSF shall <h:b>be capable of using SRTP, <selectables>
	            <selectable>SIP-TLS</selectable>
	            <selectable>IPsec</selectable>
	            <selectable>H.235</selectable>
	            <selectable><assignable>other protocols</assignable></selectable></selectables></h:b> 
	          to provide a <h:b>trusted</h:b> communication channel between itself and <h:b>authorized IT 
	          entities supporting the following capabilities: VVoIP signaling and media channels</h:b> that is
	          logically distinct from other communication channels and provides assured identification of its end points and protection of the channel data from modification or disclosure.
	        </title>
	        <note role="Application">
	          FCS_TLSC_EXT.1, FCS_TLSC_EXT.2, FCS_DTLSC_EXT.1, and FCS_DTLSC_EXT.2 are defined in the <xref to="pkgTLS"/>.
	        </note>
	      </f-element>
	      <f-element>
	        <title>
	          The TSF shall permit [<h:i>the TSF, the authorized IT entities</h:i>] to initiate communication via the trusted channel.
	        </title>
	      </f-element>
	      <f-element>
	        <title>The TSF shall initiate communication via the trusted channel for <assignable>list of functions for which a trusted channel is required</assignable>. 
	        </title>
	        
	        <aactivity>
	          <no-tests>
	            This SFR is an iteration of FTP_ITC.1 as defined in the NDcPP. The evaluator shall repeat the EAs defined for FTP_ITC.1 in the NDcPP for this iteration of the SFR.
	          </no-tests>
	        </aactivity>
	      </f-element>
        <audit-event>
            <audit-event-descr>Initiation of the trusted channel.</audit-event-descr>
            <audit-event-info>Identification of the initiator and target of the trusted channel.</audit-event-info>
          </audit-event>
          <audit-event>
            <audit-event-descr>Termination of the trusted channel.</audit-event-descr>
            <audit-event-info>Identification of the initiator and target of the trusted channel.</audit-event-info>
          </audit-event>
          <audit-event>
            <audit-event-descr>Failure of the trusted channel functions.</audit-event-descr>
            <audit-event-info>Identification of the initiator and target of the trusted channel.</audit-event-info>
          </audit-event>
	    </f-component>
	    
      </sec:man_ftp>
        
    </man-sfrs>
   <opt-sfrs>
     
  
     
     
   </opt-sfrs>
    <sel-sfrs>

      <section title="Auditable Events for Selection-Based SFRs">
          <audit-table table="sel-based" id="at-sel-based">
          </audit-table>
      </section>
      
      <sec:sel_ftp title="Trusted Path/Channels (FTP)">
        
        <f-component cc-id="ftp_itc.1" name="Inter-TSF Trusted Channel (H.323 Communications)" iteration="H323">
          <depends on1="filters_H323" on2="stateful_H323" on3="dpi_H323" on4="H323_SDP"/>
          <consistency-rationale>
            This PP-Module iterates an SFR defined in the Base-PP to define a new external interface for communications using H.323. 
            This does not interfere with the ability of the Base-PP to enforce its security functionality on the existing logical interfaces.
          </consistency-rationale>
          <f-element>
            <title>
              The TSF shall provide a<h:b>n H.323</h:b> communication channel <h:b>in accordance with ITU-REC H.235.0</h:b> between itself and 
              <h:b>a gatekeeper using TLS as specified in FCS_TLSC_EXT.1 and FCS_TLSC_EXT.2 and <selectables>
                <selectable>IPsec as specified in FCS_IPSEC_EXT.1</selectable>
                <selectable>no other protocol</selectable>
              </selectables></h:b> that is logically distinct from other communication channels and provides assured identification of its end points and protection of the channel data from modification or disclosure.
            </title>
            <note role="Application">
              FCS_IPSEC_EXT.1 is defined in the Base-PP. FCS_TLSC_EXT.1 and FCS_TLSC_EXT.2 are defined in the <xref to="pkgTLS"/>.
            </note>
          </f-element>
          <f-element>
            <title>
              The TSF shall permit [<h:i>the TSF</h:i>] to initiate communication via the trusted channel.
            </title>
          </f-element>
          <f-element>
            <title>The TSF shall initiate communication via the trusted channel for [<h:i>all communications with the gatekeeper</h:i>]. 
            </title>
            <note role="application">
              This SFR is claimed if H.323 is specified as being supported by the TOE in FFW_ACL_EXT.1, FFW_ACL_EXT.2, FFW_DPI_EXT.1, or FIA_SIPS_EXT.1.
            </note>
            <aactivity>
              <no-tests>
                This SFR is an iteration of FTP_ITC.1 as defined in the NDcPP. The evaluator shall repeat the EAs defined for FTP_ITC.1 in the NDcPP for this iteration of the SFR.
              </no-tests>
            </aactivity>  
          </f-element>
          <audit-event>
            <audit-event-descr>Initiation of the trusted channel.</audit-event-descr>
            <audit-event-info>Identification of the initiator and target of the trusted channel.</audit-event-info>
          </audit-event>
          <audit-event>
            <audit-event-descr>Termination of the trusted channel.</audit-event-descr>
            <audit-event-info>Identification of the initiator and target of the trusted channel.</audit-event-info>
          </audit-event>
          <audit-event>
            <audit-event-descr>Failure of the trusted channel functions.</audit-event-descr>
            <audit-event-info>Identification of the initiator and target of the trusted channel.</audit-event-info>
          </audit-event>
        </f-component>
        
      </sec:sel_ftp> 
      

    </sel-sfrs>
    <obj-sfrs>
    </obj-sfrs>
    <impl-dep-sfrs>
      <section title="Auditable Events for Implementation-Dependent SFRs">
          <audit-table id="at-feat-based" table="feat-based"/>
      </section>
      
      <sec:impl_fia title="Identification and Authentication (FIA)">
        
        <ext-comp-def title="Session Initiation Protocol Registration" fam-id="FIA_SIPS_EXT">
          <fam-behavior>This family defines requirements for SIP registration.</fam-behavior> 
        </ext-comp-def>
        <f-component cc-id="fia_sips_ext.1" name="Session Initiation Protocol Registration"> 
          <consistency-rationale>
            This SFR applies to SIP registration, which is beyond the original scope of the Base-PP.
          </consistency-rationale>
          
          <comp-lev> defines requirements for how the TSF must implement SIP registration, including protocol implementations and constraints on authentication.
          </comp-lev>
          <management>The following actions could be considered for the management functions in FMT: <h:ul>
            <h:li>Configuration of SIP communications.</h:li>
          </h:ul>
          </management>
          <audit>The following actions should be auditable if FAU_GEN Security audit data generation is included in the PP/ST:<h:ul>
            <h:li>Call Detail Record (CDR)</h:li>
          </h:ul>
          </audit>
          <dependencies>None
          </dependencies>
          
          <f-element>
            <title>
              The TSF shall implement the <selectables>
                <selectable>SIP that complies with RFC 3261</selectable>
                <selectable id="H323_SDP">H.323 protocol that complies with ITU-REC H.235.0</selectable></selectables> using the Session Description Protocol (SDP) complying with RFC 4566 to 
              describe the multimedia session that will be used to carry the VVoIP traffic.
            </title>
            <note role="application">
              If “H.323 protocol that complies with ITU-REC H.235.0” is selected in this requirement, the ST must include the selection-based SFR FTP_ITC.1/H323.
            </note>
          </f-element>
          <f-element>
            <title>
              The TSF shall require password authentication for SIP REGISTER function requests as specified in Section 22 of RFC 3261.
            </title>
          </f-element>
          <f-element>
            <title>
              The TSF shall support ESC authentication passwords that contain at least <assignable>positive integer of 8 or more</assignable> 
              characters in the set of [<h:i>upper case characters, lower case characters, numbers, and the following special characters: “!”, “@”, “#”, “$”, “%”, “^”, “&amp;”, “*”, “(“, and “)”, 
                and <assignable>other supported special characters</assignable></h:i>].
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall support ESC authentication passwords that contain at least <assignable>minimum numeric length</assignable> characters in the set of <assignable>supported character set</assignable>.
              </title>
            </ext-comp-def-title>
          </f-element>
          <f-element>
            <title>
              The TSF shall provide the ability to modify SIP header values for SIP traffic received by the TOE prior to retransmitting the traffic.
            </title>
          <note role="application">
            This SFR is optional because this functionality is not standard for SBCs because device registration can generally be handled by an ESC in the TOE’s OE. 
            However, in some cases, SIP registration directly to the SBC is required. 
            If an SBC advertises this service, it is expected that this functionality be included within the TOE boundary. 
            This SFR is therefore implementation-based on whether the SBC has the capability to perform its own SIP registration of devices.
          </note>
            <aactivity>
              <TSS>The evaluator shall verify that the TSS describes the ability of the TOE to support SIP in compliance with RFC 3261, 
                including the ability to require password authentication for SIP REGISTER function requests. 
                The evaluator shall also verify that the TSS describes the allowed composition of SIP authentication passwords.
                <h:p/>
                The evaluator shall verify that the TSS describes the ability of the TSF to modify SIP header values for SIP traffic received by the TOE prior to retransmitting it.
                <h:p/></TSS>
              <Guidance>The evaluator shall verify that the guidance documentation indicates that SIP REGISTER requests must be authenticated by the TOE along with the minimum password strength required for the authentication credential.
                <h:p/>
                The evaluator shall also verify that the guidance documentation provides instructions for how to configure the TOE to manipulate SIP header values.
                <h:p/></Guidance>
              <Tests>
                The evaluator shall perform the following tests:
                <testlist>
                <test>Attempt to have a SIP client issue a SIP REGISTER request without providing authentication credentials. Observe that the request is rejected and logged by the TSF.
                  <h:p/></test>
                <test>Attempt to have a SIP client issue a SIP REGISTER request with authentication credentials using characters not supported by the TSF. Observe that the request is rejected and logged by the TSF.
                  <h:p/></test>
                <test>Attempt to have a SIP client issue a SIP REGISTER request with valid authentication credentials using characters supported by the TSF. Observe that the request is accepted and logged by the TSF. Repeat this test as many times as necessary to ensure that passwords of the minimum and maximum supported lengths are used and that each supported character is used in at least one password.
                  <h:p/></test>
                Configure the TOE to manipulate SIP header values. Place a call through the TOE. Capture traffic both before it is received by the TOE and after it exits the TOE. Verify that the SIP header values have been modified. Repeat for each supported header modification, as necessary.
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Call Detail Record (CDR)</audit-event-descr>
            <audit-event-info>Calling party.</audit-event-info>
            <audit-event-info>Called party.</audit-event-info>
            <audit-event-info>Start time of the call.</audit-event-info>
            <audit-event-info>Call duration.</audit-event-info>
            <audit-event-info>Call type.</audit-event-info>
          </audit-event>
        </f-component>
      </sec:impl_fia>
      
    </impl-dep-sfrs>
  </sec:Security_Requirements>
  
  <appendix title="Implicitly Satisfied Requirements" id="satisfiedreqs">
    <h:b><ctr ctr-type="Table" pre="Table " id="imp-sat-reqs-table">: Implicitly Satisfied Requirements</ctr></h:b>
    <h:table>	
      <h:tr class="header"><h:td>Requirement</h:td><h:td>Rationale for Satisfaction</h:td></h:tr>
      <h:tr>
        <h:td><h:b>FMT_MSA.3 – Static Attribute Initialization</h:b></h:td>
        <h:td>
          FDP_IFF.1 has a dependency on FMT_MSA.3 to define the default security posture of security attributes for the purpose of information flow control enforcement. 
          This SFR has not been defined by this PP-Module because the enforcement of FDP_IFF.1 
          is not dependent on the initial state of security attributes. 
          For example, FDP_IFF.1.2 requires the TSF to determine if a communication attempt is valid before authorizing it. 
          This is true regardless of whether the default value of security attributes associated 
          with the connection attempt are permissive or restrictive; there is no difference in how the TSF determines “validity” in this case. 
          <h:p/>
          The default values of security attributes do not cause the information flow control policy to behave differently for those rules that must always be enforced by the TSF. 
          FDP_IFF.1.4 requires that all allowlisted calling parties be authorized while all denylisted calling parties be rejected. 
          It does not matter for the purpose of enforcing this SFR whether the absence of a calling party from both the allowlist and the denylist means they are authorized or rejected by default. 
        </h:td>
      </h:tr>
    </h:table> 
  </appendix>
  
  <appendix title="Allocation of Requirements in Distributed TOEs" id="allocation">
    
    For a distributed TOE, the SFRs in this PP-Module need to be met by the
    TOE as a whole, but not all SFRs will necessarily be implemented by all components. The
    following categories are defined in order to specify when each SFR must be implemented by a
    component: <h:ul>
      <h:li><h:b>All Components ("All"):</h:b> All components that comprise the distributed TOE must
        independently satisfy the requirement.</h:li>
      <h:li><h:b>At least one Component ("One"):</h:b> This requirement must be fulfilled by at least one
        component within the distributed TOE.</h:li>
      <h:li><h:b>Feature Dependent ("Feature Dependent"):</h:b> These requirements will only be
        fulfilled where the feature is implemented by the distributed TOE component (note
        that the requirement to meet the PP-Module as a whole requires that at least one component
        implements these requirements if they are claimed by the TOE).</h:li></h:ul>
    The table below specifies how each of the SFRs in this PP-Module must be met, using the categories above.
    
    <h:table>
      <h:tr class="header">
        <h:td>Requirement</h:td>
        <h:td>Description</h:td>
        <h:td>Distributed TOE SFR Allocation</h:td>
      </h:tr>
      <h:tr>
        <h:td>FAU_ARP_EXT.1</h:td>
        <h:td>Security Audit Automatic Response</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FAU_GEN.1/SBC</h:td>
        <h:td>Audit Data Generation (Session Border Controller)</h:td>
        <h:td>All</h:td>
      </h:tr>
      <h:tr>
        <h:td>FAU_SAA.1</h:td>
        <h:td>Potential Violation Analysis</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FAU_SEL.1</h:td>
        <h:td>Selective Audit</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FCS_SRTP_EXT.1</h:td>
        <h:td>Secure Real-Time Transport Protocol</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FDP_IFC.1</h:td>
        <h:td>Subset Information Flow Control</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FDP_IFF.1</h:td>
        <h:td>Simple Security Attributes</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FFW_ACL_EXT.1</h:td>
        <h:td>Real-Time Communications Traffic Filtering</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FFW_ACL_EXT.2</h:td>
        <h:td>Stateful VVoIP Traffic Filtering</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FFW_DPI_EXT.1</h:td>
        <h:td>Deep Packet Inspection</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FFW_NAT_EXT.1</h:td>
        <h:td>Topology Hiding/NAT Traversal</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FIA_SIPS_EXT.1 (implementation-based)</h:td>
        <h:td>Session Initiation Protocol Registration</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FIA_SIPT_EXT.1</h:td>
        <h:td>Session Initiation Protocol Trunking</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FMT_SMF.1/SBC</h:td>
        <h:td>Specification of Management Functions (SBC)</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FRU_PRS_EXT.1</h:td>
        <h:td>Limited Priority of Service</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FRU_RSA.1</h:td>
        <h:td>Maximum Quotas</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FTP_ITC.1/ESC</h:td>
        <h:td>Inter-TSF Trusted Channel (ESC Communications)</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FTP_ITC.1/H323 (selection-based)</h:td>
        <h:td>Inter-TSF Trusted Channel (H.323 Communications)</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FTP_ITC.1/VVoIP</h:td>
        <h:td>Inter-TSF Trusted Channel (VVoIP Communications)</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      
      
    </h:table>
    
  </appendix>
  
  <appendix title="Entropy Documentation and Assessment" id="EAR">
    The TOE does not require any additional supplementary information to describe its entropy sources beyond the requirements outlined in the Base-PP.  
  </appendix>
  
  <bibliography>
    <cc-entry/>
    
    
    <entry id="bibNDcPP">
      <tag>NDcPP</tag>
      <description>
        <h:a href="https://www.niap-ccevs.org/MMO/PP/CPP_ND_V3.0E.pdf">collaborative Protection Profile for Network Devices</h:a>, Version 3.0e, 06 December 2023
      </description>
    </entry>
    
    <entry id="bibNDSD">
      <tag>NDcPP SD</tag>
      <description>
        <h:a href="https://www.niap-ccevs.org/MMO/PP/CPP_ND_V3.0E-SD.pdf">Supporting Document - Evaluation Activities for Network Device cPP</h:a>, Version 3.0e, 06 December 2023
      </description>
    </entry>
    <entry id="bibTLS">
      <tag>PKG_TLS</tag>
      <description><xref to="pkgTLS"/></description>
    </entry>
    <entry id="bibX509">
      <tag>PKG_X509</tag>
      <description><xref to="pkgX509"/></description>
    </entry>

  </bibliography>
</Module>
